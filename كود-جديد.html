
<!doctype html>
<html lang="ar" dir="rtl">
 <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>ØªØ¹Ù„Ù… Ù†Ø·Ù‚ Ø§Ù„Ø­Ø±ÙˆÙ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø¨Ø¯Ù‚Ø©</title>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="/_sdk/data_sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&amp;display=swap" rel="stylesheet">
  <style>
body {
  box-sizing: border-box;
  margin: 0;
  font-family: "Cairo", sans-serif;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #f5576c 75%, #4facfe 100%);
  min-height: 100%;
  color: #1a202c;
  position: relative;
  overflow-x: hidden;
}

@keyframes fadeInOut {
  0% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
  20% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
  80% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
  100% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
}

@keyframes pulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.05); }
  100% { transform: scale(1); }
}

@keyframes slideIn {
  0% { transform: translateX(100%); opacity: 0; }
  100% { transform: translateX(0); opacity: 1; }
}

@keyframes bounce {
  0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
  40% { transform: translateY(-10px); }
  60% { transform: translateY(-5px); }
}

.quiz-option:hover {
  animation: pulse 0.3s ease-in-out;
}

.listening-button {
  animation: pulse 2s infinite;
}

.correct-answer {
  animation: pulse 0.5s ease-in-out 3;
}

.draggable-word {
  animation: bounce 0.6s ease-in-out;
}

.drop-zone-active {
  animation: pulse 1s infinite;
}

.connector-btn {
  background: #f0f9ff;
  color: #0e7490;
  border: 2px solid #0891b2;
  padding: 8px 12px;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.3s;
  font-size: 0.9rem;
  font-weight: 600;
}

.connector-btn:hover {
  background: #0891b2;
  color: white;
  transform: translateY(-2px);
}

.criteria-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 8px 0;
  border-bottom: 1px solid #e5e7eb;
}

.criteria-item:last-child {
  border-bottom: none;
}

.criteria-item .score {
  font-weight: 600;
  color: #0891b2;
}

body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="75" cy="75" r="1.5" fill="rgba(255,255,255,0.08)"/><circle cx="50" cy="10" r="0.8" fill="rgba(255,255,255,0.12)"/><circle cx="10" cy="60" r="1.2" fill="rgba(255,255,255,0.09)"/><circle cx="90" cy="30" r="0.9" fill="rgba(255,255,255,0.11)"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>') repeat;
  pointer-events: none;
  z-index: 0;
}

.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 40px 24px;
  position: relative;
  z-index: 1;
}

h1 {
  text-align: center;
  font-size: 2.5rem;
  font-weight: 800;
  background: linear-gradient(135deg, #ffffff 0%, #f7fafc 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 16px;
  text-shadow: 0 4px 20px rgba(0,0,0,0.3);
  letter-spacing: -0.02em;
}

p.lead {
  text-align: center;
  color: rgba(255,255,255,0.9);
  font-size: 1.2rem;
  font-weight: 500;
  margin-bottom: 40px;
  text-shadow: 0 2px 10px rgba(0,0,0,0.2);
  line-height: 1.6;
}

.features {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 24px;
  margin-top: 32px;
}

.card {
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(20px);
  padding: 28px;
  border-radius: 20px;
  text-align: center;
  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1), 0 8px 16px rgba(0, 0, 0, 0.06);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
}

.card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: linear-gradient(90deg, #667eea, #764ba2);
}

.card:hover {
  transform: translateY(-8px) scale(1.02);
  box-shadow: 0 32px 64px rgba(0, 0, 0, 0.15), 0 16px 32px rgba(0, 0, 0, 0.1);
  background: rgba(255, 255, 255, 0.98);
}

.card h3 {
  margin: 0 0 12px;
  font-size: 1.3rem;
  font-weight: 700;
  color: #2d3748;
}

.card p {
  margin: 0 0 20px;
  color: #4a5568;
  font-size: 1rem;
  line-height: 1.6;
}

.btn {
  display: inline-block;
  padding: 14px 28px;
  border: none;
  border-radius: 12px;
  font-size: 1rem;
  font-weight: 600;
  text-decoration: none;
  cursor: pointer;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  margin: 8px;
  position: relative;
  overflow: hidden;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
}

.btn::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
  transition: left 0.5s;
}

.btn:hover::before {
  left: 100%;
}

.btn-primary {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border: 1px solid rgba(255, 255, 255, 0.2);
}

.btn-primary:hover {
  background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);
  transform: translateY(-3px);
  box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
}

.btn-ghost {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  color: white;
  border: 2px solid #6b7280;
  backdrop-filter: blur(10px);
}

.btn-ghost:hover {
  background: linear-gradient(135deg, #4b5563, #374151);
  color: white;
  border-color: #4b5563;
  transform: translateY(-2px);
}

.sounds {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 16px;
  margin: 32px 0;
}

.sounds button {
  background: rgba(255, 255, 255, 0.9);
  backdrop-filter: blur(15px);
  border: 2px solid rgba(8, 145, 178, 0.3);
  padding: 20px;
  border-radius: 16px;
  font-size: 1.1rem;
  font-weight: 600;
  color: #0891b2;
  cursor: pointer;
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
  position: relative;
  overflow: hidden;
}

.sounds button::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 3px;
  background: linear-gradient(90deg, #0891b2, #06b6d4);
}

.sounds button:hover {
  background: linear-gradient(135deg, #0891b2, #06b6d4);
  color: white;
  transform: translateY(-4px) scale(1.02);
  box-shadow: 0 16px 32px rgba(8, 145, 178, 0.3);
  border-color: transparent;
}

.cta {
  text-align: center;
  margin: 50px 0;
  padding: 30px;
  background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(20px);
  border-radius: 20px;
  border: 1px solid rgba(255, 255, 255, 0.2);
}

.drag-drop-container {
  background: #f8fafc;
  border-radius: 15px;
  padding: 25px;
  margin: 20px 0;
}

.word-bank {
  background: #f1f5f9;
  padding: 20px;
  border-radius: 12px;
  margin-bottom: 20px;
  min-height: 80px;
  border: 2px dashed #cbd5e1;
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  align-items: center;
  justify-content: center;
}

.draggable-word {
  background: white;
  padding: 12px 18px;
  border-radius: 8px;
  cursor: move;
  border: 2px solid #e2e8f0;
  font-weight: 600;
  color: #374151;
  user-select: none;
  transition: all 0.3s ease;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.draggable-word:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  border-color: #3b82f6;
}

.draggable-word.dragging {
  opacity: 0.5;
  transform: rotate(5deg);
}

.drop-zone {
  background: #f0f9ff;
  padding: 25px;
  border-radius: 12px;
  min-height: 80px;
  border: 3px dashed #93c5fd;
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  align-items: center;
  justify-content: center;
  transition: all 0.3s ease;
}

.drop-zone.drag-over {
  border-color: #3b82f6;
  background: #dbeafe;
  transform: scale(1.02);
}

.drop-zone .dropped-word {
  background: linear-gradient(135deg, #3b82f6, #2563eb);
  color: white;
  padding: 12px 18px;
  border-radius: 8px;
  font-weight: 600;
  border: 2px solid #1d4ed8;
  animation: slideIn 0.3s ease-out;
}

.sentence-result {
  background: #f0fdf4;
  border: 2px solid #22c55e;
  border-radius: 12px;
  padding: 20px;
  margin: 20px 0;
  text-align: center;
}

.sentence-result.correct {
  background: linear-gradient(135deg, #dcfce7, #bbf7d0);
  border-color: #16a34a;
}

.sentence-result.incorrect {
  background: linear-gradient(135deg, #fef2f2, #fecaca);
  border-color: #dc2626;
}
</style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="container">
   <h1 id="main-title">fly with English - Ø§Ù†Ø·Ù„Ù‚ÙŠ Ø¨Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©</h1>
   <p class="lead" id="subtitle">Ù…Ø±Ø­Ø¨Ø§ Ø¨Ùƒ Ø·Ø§Ù„Ø¨ØªÙ†Ø§ Ø§Ù„Ø¹Ø²ÙŠØ²Ø© Ø­ÙŠØ« Ù†Ø¨Ø¯Ø£ Ø±Ø­Ù„ØªÙ†Ø§ Ù…Ù† Ø£ÙˆÙ„Ù‰ Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªØ£Ø³ÙŠØ³ Ø­ØªÙ‰ ÙƒØªØ§Ø¨Ø© Ù…Ù‚Ø§Ù„Ùƒ Ø§Ù„Ø£ÙˆÙ„ Ø¨ÙƒÙ„ Ø«Ù‚Ø©</p><!-- Navigation buttons at the top -->
   <div class="cta" id="top-navigation" style="margin: 20px 0 40px 0;"><button class="btn btn-primary" onclick="showPath1()" style="background: linear-gradient(135deg, #f59e0b, #d97706); box-shadow: 0 8px 25px rgba(245, 158, 11, 0.4);">Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø£ÙˆÙ„ â­</button> <button class="btn btn-primary" onclick="showPath2()">Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ</button> <button class="btn btn-primary" onclick="showPath3()">Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø«Ø§Ù„Ø«</button>
   </div>
   <div id="path1-section" class="features">
    <div class="card">
     <div style="font-size: 3rem; margin-bottom: 16px;">
      ğŸ§
     </div>
     <h3>Ø§Ø³ØªÙ…Ø¹ÙŠ ÙˆØªØ¯Ø±Ø¨ÙŠ</h3>
     <p>ØªÙ…Ø§Ø±ÙŠÙ† Ø§Ù„Ø£ØµÙˆØ§Øª Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© - Ø§Ø³ØªÙ…Ø¹ÙŠ Ù„ÙƒÙ„ Ø­Ø±Ù ÙˆÙƒØ±Ø±ÙŠ Ø§Ù„Ù†Ø·Ù‚.</p><a href="https://jamilahfreetime.my.canva.site/letterandsound" target="_blank" rel="noopener noreferrer" class="btn btn-primary">Ø§Ø¨Ø¯Ø£ ØªÙ…Ø§Ø±ÙŠÙ† Ø§Ù„Ø£ØµÙˆØ§Øª</a>
    </div>
    <div class="card">
     <div style="font-size: 3rem; margin-bottom: 16px;">
      âœ¨
     </div>
     <h3>ØªØµØ­ÙŠØ­ ÙÙˆØ±ÙŠ</h3>
     <p>Ø§Ø¯Ø®Ù„ÙŠ Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙˆØ§Ø³ØªÙ…Ø¹ÙŠ Ù„Ù„ÙƒÙ„Ù…Ø© Ø«Ù… Ø­Ø§ÙˆÙ„ÙŠ Ù†Ø·Ù‚Ù‡Ø§ Ø§Ø°Ø§ Ø­Ù‚Ù‚ØªÙŠ 90% Ù…Ø¨Ø±ÙˆÙƒ Ø­Ù‚Ù‚ØªÙŠ Ø§ÙˆÙ„ Ø§Ù„Ø®Ø·ÙˆØ§Øª ÙÙŠ Ø§Ù„Ø§ØªÙ‚Ø§Ù†</p><a href="https://app.speechace.co/placement/course/4/quiz/1/1" target="_blank" rel="noopener noreferrer" class="btn btn-primary">Ù…ÙˆÙ‚Ø¹ Ø§Ù„ØªØµØ­ÙŠØ­ Ø§Ù„ÙÙˆØ±ÙŠ</a>
    </div>
    <div class="card">
     <div style="font-size: 3rem; margin-bottom: 16px;">
      ğŸ¬
     </div>
     <h3>Ù…Ø±Ø§Ø¬Ø¹ ØµÙˆØªÙŠØ©</h3>
     <p>Ù…Ù‚Ø§Ø·Ø¹ ØµÙˆØªÙŠØ© Ù…Ø³Ø¬Ù„Ø© ØªØ³Ø§Ø¹Ø¯Ùƒ Ø¹Ù„Ù‰ Ø§Ù„ØªÙ‚Ù„ÙŠØ¯ Ø§Ù„ØµØ­ÙŠØ­.</p><a href="https://mjmgirls-my.sharepoint.com/:v:/g/personal/t9626861_mg_moe_gov_sa/EcjQN0ErWkxMpoSBUJD68csBHEqEpBp7e3whzJszpnSGJg?e=wMQkm6" target="_blank" rel="noopener noreferrer" class="btn btn-primary">Ù…Ù‚Ø·Ø¹ ÙÙŠØ¯ÙŠÙˆ Ù„Ù„Ø§Ø³ØªÙ…Ø§Ø¹ ÙˆØ§Ù„Ù…Ø­Ø§ÙƒØ§Ø©</a>
    </div>
    <div class="card">
     <div style="font-size: 3rem; margin-bottom: 16px;">
      ğŸ‘¥
     </div>
     <h3>Ø§Ù„Ø¶Ù…Ø§Ø¦Ø± - Pronouns</h3>
     <p>ØªØ¹Ù„Ù… Ù†Ø·Ù‚ Ø§Ù„Ø¶Ù…Ø§Ø¦Ø± Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø¨Ø·Ø±ÙŠÙ‚Ø© ØµØ­ÙŠØ­Ø© Ù…Ø¹ Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©.</p><a href="https://jamilahfreetime.my.canva.site/english-pronouns-learning" target="_blank" rel="noopener noreferrer" class="btn btn-primary">ØªØ¹Ù„Ù… Ø§Ù„Ø¶Ù…Ø§Ø¦Ø±</a>
    </div>
    <div class="card" style="background: linear-gradient(135deg, rgba(251, 191, 36, 0.9), rgba(245, 158, 11, 0.9)); backdrop-filter: blur(20px); border: 2px solid rgba(245, 158, 11, 0.5);">
     <div style="font-size: 3rem; margin-bottom: 16px;">
      ğŸ¯
     </div>
     <h3 style="color: #92400e; font-weight: 800;">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø£ÙˆÙ„</h3>
     <p style="color: #92400e; font-weight: 500;">Ø§Ø®ØªØ¨Ø±ÙŠ Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙƒ ÙÙŠ Ø§Ù„Ø­Ø±ÙˆÙ ÙˆØ§Ù„Ø¶Ù…Ø§Ø¦Ø± - ÙŠØ¬Ø¨ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ 80% Ù„Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ</p><button class="btn btn-primary" onclick="showQuizPage()" style="background: linear-gradient(135deg, #f59e0b, #d97706); box-shadow: 0 8px 25px rgba(245, 158, 11, 0.4);">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</button>
    </div>
   </div>
   <footer style="text-align: center; margin-top: 50px; padding: 30px 20px; background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(20px); border-radius: 20px; border: 1px solid rgba(255, 255, 255, 0.2);">
    <div style="color: rgba(255, 255, 255, 0.9); font-size: 1rem; line-height: 1.8; font-weight: 500;">
     <p style="margin: 0 0 10px 0;">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Ù„Ù…Ø¹Ù„Ù…Ø§Øª Ù‚Ø³Ù… Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©</p>
     <p style="margin: 0 0 10px 0; font-weight: 600; color: rgba(255, 255, 255, 0.95);">Ø£Ø´ÙˆØ§Ù‚ Ø§Ù„Ø­Ø±Ø¨ÙŠ - Ø±Ø§Ù†ÙŠØ§ Ø§Ù„Ø­Ø¨ÙŠØ´ÙŠ - ÙØ§Ø·Ù…Ø© Ø§Ù„ØµÙŠØ¯Ù„Ø§Ù†ÙŠ - Ù…Ù†ÙŠØ±Ø© Ø§Ù„Ø´Ù…Ø±Ø§Ù†ÙŠ</p>
     <p style="margin: 0 0 10px 0; font-size: 0.9rem; color: rgba(255, 255, 255, 0.8);">Ù…ØªÙˆØ³Ø·Ø© Ø¬Ù…ÙŠÙ„Ø© Ø¨Ù†Øª Ø¹Ù…Ø± Ø¨Ù† Ø§Ù„Ø®Ø·Ø§Ø¨ ÙÙŠ ÙŠÙ†Ø¨Ø¹ Ø§Ù„Ø¨Ø­Ø±</p>
     <p style="margin: 0 0 15px 0; font-size: 0.9rem; color: rgba(255, 255, 255, 0.85); font-weight: 600;">Ù…Ø¯ÙŠØ±Ø© Ø§Ù„Ù…Ø¯Ø±Ø³Ø©: Ø­Ù†Ø§Ù† Ø§Ù„ØºØ§Ù…Ø¯ÙŠ</p><!-- Visitor Counter -->
     <div style="background: rgba(255, 255, 255, 0.15); padding: 15px; border-radius: 12px; margin: 20px auto; max-width: 300px; border: 1px solid rgba(255, 255, 255, 0.2);">
      <div style="display: flex; align-items: center; justify-content: center; gap: 10px; color: rgba(255, 255, 255, 0.9);"><span style="font-size: 1.2rem;">ğŸ‘¥</span> <span style="font-size: 0.9rem; font-weight: 500;">Ø¹Ø¯Ø¯ Ø§Ù„Ø²ÙˆØ§Ø±:</span> <span id="visitor-count" style="font-size: 1.1rem; font-weight: 700; color: #fbbf24; text-shadow: 0 2px 4px rgba(0,0,0,0.3);">0</span>
      </div>
     </div>
    </div>
   </footer><!-- Path 2 Section -->
   <div id="path2-section" class="features" style="display:none;">
    <div class="card">
     <div style="font-size: 3rem; margin-bottom: 16px;">
      ğŸ“š
     </div>
     <h3>Ù‚ÙˆØ§Ø¹Ø¯ Ø£Ø³Ø§Ø³ÙŠØ©</h3>
     <p>ØªØ¹Ù„Ù… Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø¨Ø·Ø±ÙŠÙ‚Ø© Ù…Ø¨Ø³Ø·Ø©.</p><a href="https://jamilahfreetime.my.canva.site/english-tenses-practice" target="_blank" rel="noopener noreferrer" class="btn btn-primary">Ø§Ø¨Ø¯Ø£ ØªØ¹Ù„Ù… Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯</a>
    </div>
    <div class="card">
     <div style="font-size: 3rem; margin-bottom: 16px;">
      ğŸ”—
     </div>
     <h3>ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø¬Ù…Ù„</h3>
     <p>ØªØ¯Ø±Ø¨ Ø¹Ù„Ù‰ ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø¬Ù…Ù„ Ø§Ù„Ø¨Ø³ÙŠØ·Ø© ÙˆØ§Ù„Ù…ÙÙŠØ¯Ø© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… ØªÙ…Ø§Ø±ÙŠÙ† ØªÙØ§Ø¹Ù„ÙŠØ© Ù…ØªÙ†ÙˆØ¹Ø©.</p><a href="https://jamilahfreetime.my.canva.site/sentence-building-trainer" target="_blank" rel="noopener noreferrer" class="btn btn-primary">Ø§Ø¨Ø¯Ø£ ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø¬Ù…Ù„</a>
    </div>
    <div class="card">
     <div style="font-size: 3rem; margin-bottom: 16px;">
      ğŸ“–
     </div>
     <h3>Ø§Ù„Ù…ÙØ±Ø¯Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</h3>
     <p>Ø§ÙƒØªØ³Ø¨ Ø§Ù„Ù…ÙØ±Ø¯Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙŠÙˆÙ…ÙŠ.</p><a href="https://jamilahfreetime.my.canva.site/bs5qpnrf3p2vrz1q" target="_blank" rel="noopener noreferrer" class="btn btn-primary">ØªØ¹Ù„Ù… Ø§Ù„Ù…ÙØ±Ø¯Ø§Øª</a>
    </div>
    <div class="card" style="background: linear-gradient(135deg, rgba(224, 242, 254, 0.9), rgba(8, 145, 178, 0.9)); backdrop-filter: blur(20px); border: 2px solid rgba(8, 145, 178, 0.5);">
     <div style="font-size: 3rem; margin-bottom: 16px;">
      ğŸ¯
     </div>
     <h3 style="color: #164e63; font-weight: 800;">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ</h3>
     <p style="color: #164e63; font-weight: 500;">Ø§Ø®ØªØ¨Ø±ÙŠ Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙƒ ÙÙŠ Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ ÙˆØ§Ù„Ù…ÙØ±Ø¯Ø§Øª - ÙŠØ¬Ø¨ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ 80% Ù„Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø«Ø§Ù„Ø«</p><button class="btn btn-primary" onclick="showPath2Quiz()" style="background: linear-gradient(135deg, #0891b2, #0e7490); box-shadow: 0 8px 25px rgba(8, 145, 178, 0.4);">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</button>
    </div>
   </div><!-- Path 3 Section -->
   <div id="path3-section" class="features" style="display:none;">
    <div class="card">
     <div style="font-size: 3rem; margin-bottom: 16px;">
      âœï¸
     </div>
     <h3>ÙƒØªØ§Ø¨Ø© Ø§Ù„ÙÙ‚Ø±Ø§Øª</h3>
     <p>ØªØ¹Ù„Ù… ÙƒÙŠÙÙŠØ© ÙƒØªØ§Ø¨Ø© ÙÙ‚Ø±Ø§Øª Ù…ØªÙ…Ø§Ø³ÙƒØ© ÙˆÙ…ØªØ±Ø§Ø¨Ø·Ø©.</p><a href="https://jamilahfreetime.my.canva.site/bs6cz28yz1hpfxw6" target="_blank" rel="noopener noreferrer" class="btn btn-primary">Ø§Ø¨Ø¯Ø£ ØªØ¹Ù„Ù… ÙƒØªØ§Ø¨Ø© Ø§Ù„ÙÙ‚Ø±Ø§Øª</a>
    </div>
    <div class="card" style="background: linear-gradient(135deg, rgba(224, 242, 254, 0.9), rgba(8, 145, 178, 0.9)); backdrop-filter: blur(20px); border: 2px solid rgba(8, 145, 178, 0.5);">
     <div style="font-size: 3rem; margin-bottom: 16px;">
      ğŸ“
     </div>
     <h3 style="color: #164e63; font-weight: 800;">Ø§Ø®ØªØ¨Ø§Ø± ÙƒØªØ§Ø¨Ø© Ø§Ù„ÙÙ‚Ø±Ø©</h3>
     <p style="color: #164e63; font-weight: 500;">Ø§ÙƒØªØ¨ÙŠ ÙÙ‚Ø±Ø© ÙˆØµÙÙŠØ© Ø¹Ù† ØµØ¯ÙŠÙ‚ØªÙƒ ÙˆØ³ÙŠØªÙ… ØªÙ‚ÙŠÙŠÙ…Ù‡Ø§ Ù…Ù† 100% - ÙŠØ¬Ø¨ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ 70% Ù„Ù„Ù†Ø¬Ø§Ø­</p><button class="btn btn-primary" onclick="showPath3Quiz()" style="background: linear-gradient(135deg, #0891b2, #0e7490); box-shadow: 0 8px 25px rgba(8, 145, 178, 0.4);">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</button>
    </div>
   </div><!-- Quiz Section -->
   <div id="quiz-section" style="display:none;">
    <h2 style="text-align:center;font-size:1.7rem;margin:30px 0;color:#f59e0b;">ğŸ¯ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø£ÙˆÙ„</h2>
    <div id="student-info" style="background:white;padding:25px;border-radius:15px;box-shadow:0 6px 18px rgba(16,24,40,0.06);max-width:500px;margin:0 auto 30px;">
     <h3 style="text-align:center;color:#f59e0b;margin-bottom:20px;">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨Ø©</h3>
     <div style="margin-bottom:15px;"><label for="student-name" style="display:block;margin-bottom:5px;font-weight:600;color:#374151;">Ø§Ù„Ø§Ø³Ù…:</label> <input type="text" id="student-name" placeholder="Ø£Ø¯Ø®Ù„ÙŠ Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ§Ù…Ù„" style="width:100%;padding:10px;border:2px solid #e5e7eb;border-radius:8px;font-size:1rem;">
     </div>
     <div style="margin-bottom:20px;"><label for="student-class" style="display:block;margin-bottom:5px;font-weight:600;color:#374151;">Ø§Ù„ÙØµÙ„:</label> <input type="text" id="student-class" placeholder="Ø£Ø¯Ø®Ù„ÙŠ ÙØµÙ„Ùƒ (Ù…Ø«Ø§Ù„: 1Ø£)" style="width:100%;padding:10px;border:2px solid #e5e7eb;border-radius:8px;font-size:1rem;">
     </div><button onclick="startQuiz()" class="btn btn-primary" style="width:100%;background:linear-gradient(90deg,#f59e0b,#d97706);">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</button>
    </div>
    <div style="text-align:center;margin-top:30px;"><button class="btn btn-primary" onclick="goBackToPath1()">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø£ÙˆÙ„</button> <button class="btn btn-ghost" onclick="goBackToMain()">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
    </div>
   </div><!-- Other sections remain the same... -->
   <div id="sentence-builder-section" style="display:none;">
    <h2 style="text-align:center;font-size:1.7rem;margin:30px 0;color:#2ca6f2;">ğŸ”— ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø¬Ù…Ù„ - Sentence Building</h2>
    <div style="background:#f0f9ff;padding:20px;border-radius:12px;margin-bottom:25px;border-right:4px solid #2ca6f2;">
     <h4 style="color:#2ca6f2;margin-bottom:15px;">ğŸ’¡ ÙƒÙŠÙÙŠØ© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:</h4>
     <ul style="color:#374151;line-height:1.8;margin:0;padding-right:20px;">
      <li>Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„ØªÙ…Ø±ÙŠÙ† Ø§Ù„Ø°ÙŠ ØªØ±ÙŠØ¯ Ø§Ù„ØªØ¯Ø±Ø¨ Ø¹Ù„ÙŠÙ‡</li>
      <li>Ø§ØªØ¨Ø¹ Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª Ù„ÙƒÙ„ ØªÙ…Ø±ÙŠÙ†</li>
      <li>Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¥Ø¬Ø§Ø¨Ø§ØªÙƒ</li>
      <li>ØªØ¯Ø±Ø¨ Ø¹Ù„Ù‰ Ø£Ù†ÙˆØ§Ø¹ Ù…Ø®ØªÙ„ÙØ© Ù…Ù† Ø§Ù„Ø¬Ù…Ù„</li>
     </ul>
    </div>
    <div style="display:flex;gap:15px;justify-content:center;margin:30px 0;flex-wrap:wrap;"><button onclick="showExerciseType('drag-drop')" class="btn btn-primary" style="background:linear-gradient(90deg,#3b82f6,#2563eb);padding:15px 25px;font-size:1.1rem;">ğŸ§© Ø³Ø­Ø¨ ÙˆØ¥ÙÙ„Ø§Øª<br><span style="font-size:0.9rem;opacity:0.9;">Ø±ØªØ¨ Ø§Ù„ÙƒÙ„Ù…Ø§Øª</span></button> <button onclick="showExerciseType('fill-blanks')" class="btn btn-primary" style="background:linear-gradient(90deg,#10b981,#059669);padding:15px 25px;font-size:1.1rem;">âœï¸ Ø§Ù…Ù„Ø£ Ø§Ù„ÙØ±Ø§ØºØ§Øª<br><span style="font-size:0.9rem;opacity:0.9;">Ø§Ø®ØªØ± Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©</span></button> <button onclick="showExerciseType('translation')" class="btn btn-primary" style="background:linear-gradient(90deg,#f59e0b,#d97706);padding:15px 25px;font-size:1.1rem;">ğŸ”„ ØªØ±Ø¬Ù…Ø©<br><span style="font-size:0.9rem;opacity:0.9;">ØªØ±Ø¬Ù… Ù…Ù† Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</span></button> <button onclick="showExerciseType('word-order')" class="btn btn-primary" style="background:linear-gradient(90deg,#8b5cf6,#7c3aed);padding:15px 25px;font-size:1.1rem;">ğŸ“ ØªØ±ØªÙŠØ¨ Ø§Ù„ÙƒÙ„Ù…Ø§Øª<br><span style="font-size:0.9rem;opacity:0.9;">Ø±ØªØ¨ Ù„ØªÙƒÙˆÙŠÙ† Ø¬Ù…Ù„Ø©</span></button>
    </div>
    <div id="exercise-content" style="background:white;padding:30px;border-radius:15px;box-shadow:0 6px 18px rgba(16,24,40,0.06);margin:20px 0;display:none;"><!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
    </div>
    <div style="text-align:center;margin-top:30px;"><button class="btn btn-primary" onclick="goBackToPath2()" style="margin-left:10px;">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ</button> <button class="btn btn-ghost" onclick="goBackToMain()">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
    </div>
   </div><!-- Grammar Section -->
   <div id="grammar-section" style="display:none;">
    <h2 style="text-align:center;font-size:1.7rem;margin:30px 0;color:#2ca6f2;">ğŸ“š Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© - Basic Grammar</h2>
    <div style="background:#f0f9ff;padding:20px;border-radius:12px;margin-bottom:25px;border-right:4px solid #2ca6f2;">
     <h4 style="color:#2ca6f2;margin-bottom:15px;">ğŸ’¡ Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø¯Ø±ÙˆØ³ Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯:</h4>
     <ul style="color:#374151;line-height:1.8;margin:0;padding-right:20px;">
      <li>Ø§Ø®ØªØ± Ø§Ù„Ø¯Ø±Ø³ Ø§Ù„Ø°ÙŠ ØªØ±ÙŠØ¯ ØªØ¹Ù„Ù…Ù‡</li>
      <li>Ø§Ù‚Ø±Ø£ Ø§Ù„Ø´Ø±Ø­ Ø¨Ø¹Ù†Ø§ÙŠØ©</li>
      <li>ØªØ¯Ø±Ø¨ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù…Ø«Ù„Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©</li>
      <li>Ø§Ø®ØªØ¨Ø± ÙÙ‡Ù…Ùƒ Ù…Ø¹ Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ†</li>
     </ul>
    </div>
    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:20px;margin:30px 0;"><!-- Lesson 1: Articles -->
     <div class="card" style="background:linear-gradient(135deg,rgba(59,130,246,0.1),rgba(37,99,235,0.1));border:2px solid rgba(59,130,246,0.3);">
      <div style="font-size:2.5rem;margin-bottom:16px;">
       ğŸ“
      </div>
      <h3 style="color:#1e40af;">Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØ¹Ø±ÙŠÙ ÙˆØ§Ù„ØªÙ†ÙƒÙŠØ±</h3>
      <p style="color:#374151;">ØªØ¹Ù„Ù… Ø§Ø³ØªØ®Ø¯Ø§Ù… a, an, the Ø¨Ø·Ø±ÙŠÙ‚Ø© ØµØ­ÙŠØ­Ø©</p><button onclick="showGrammarLesson('articles')" class="btn btn-primary" style="background:linear-gradient(90deg,#3b82f6,#2563eb);">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¯Ø±Ø³</button>
     </div><!-- Lesson 2: Present Simple -->
     <div class="card" style="background:linear-gradient(135deg,rgba(16,185,129,0.1),rgba(5,150,105,0.1));border:2px solid rgba(16,185,129,0.3);">
      <div style="font-size:2.5rem;margin-bottom:16px;">
       â°
      </div>
      <h3 style="color:#065f46;">Ø§Ù„Ù…Ø¶Ø§Ø±Ø¹ Ø§Ù„Ø¨Ø³ÙŠØ·</h3>
      <p style="color:#374151;">ØªØ¹Ù„Ù… ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø¬Ù…Ù„ ÙÙŠ Ø²Ù…Ù† Ø§Ù„Ù…Ø¶Ø§Ø±Ø¹ Ø§Ù„Ø¨Ø³ÙŠØ·</p><button onclick="showGrammarLesson('present-simple')" class="btn btn-primary" style="background:linear-gradient(90deg,#10b981,#059669);">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¯Ø±Ø³</button>
     </div><!-- Lesson 3: Pronouns -->
     <div class="card" style="background:linear-gradient(135deg,rgba(245,158,11,0.1),rgba(217,119,6,0.1));border:2px solid rgba(245,158,11,0.3);">
      <div style="font-size:2.5rem;margin-bottom:16px;">
       ğŸ‘¥
      </div>
      <h3 style="color:#92400e;">Ø§Ù„Ø¶Ù…Ø§Ø¦Ø±</h3>
      <p style="color:#374151;">ØªØ¹Ù„Ù… Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø¶Ù…Ø§Ø¦Ø± ÙˆØ§Ø³ØªØ®Ø¯Ø§Ù…Ø§ØªÙ‡Ø§</p><button onclick="showGrammarLesson('pronouns')" class="btn btn-primary" style="background:linear-gradient(90deg,#f59e0b,#d97706);">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¯Ø±Ø³</button>
     </div><!-- Lesson 4: Adjectives -->
     <div class="card" style="background:linear-gradient(135deg,rgba(139,92,246,0.1),rgba(124,58,237,0.1));border:2px solid rgba(139,92,246,0.3);">
      <div style="font-size:2.5rem;margin-bottom:16px;">
       ğŸ¨
      </div>
      <h3 style="color:#6b21a8;">Ø§Ù„ØµÙØ§Øª</h3>
      <p style="color:#374151;">ØªØ¹Ù„Ù… ÙƒÙŠÙÙŠØ© ÙˆØµÙ Ø§Ù„Ø£Ø´ÙŠØ§Ø¡ ÙˆØ§Ù„Ø£Ø´Ø®Ø§Øµ</p><button onclick="showGrammarLesson('adjectives')" class="btn btn-primary" style="background:linear-gradient(90deg,#8b5cf6,#7c3aed);">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¯Ø±Ø³</button>
     </div><!-- Lesson 5: Question Formation -->
     <div class="card" style="background:linear-gradient(135deg,rgba(236,72,153,0.1),rgba(219,39,119,0.1));border:2px solid rgba(236,72,153,0.3);">
      <div style="font-size:2.5rem;margin-bottom:16px;">
       â“
      </div>
      <h3 style="color:#be185d;">ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</h3>
      <p style="color:#374151;">ØªØ¹Ù„Ù… ÙƒÙŠÙÙŠØ© ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ù…Ø®ØªÙ„ÙØ©</p><button onclick="showGrammarLesson('questions')" class="btn btn-primary" style="background:linear-gradient(90deg,#ec4899,#db2777);">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¯Ø±Ø³</button>
     </div><!-- Lesson 6: Prepositions -->
     <div class="card" style="background:linear-gradient(135deg,rgba(6,182,212,0.1),rgba(8,145,178,0.1));border:2px solid rgba(6,182,212,0.3);">
      <div style="font-size:2.5rem;margin-bottom:16px;">
       ğŸ”—
      </div>
      <h3 style="color:#0e7490;">Ø­Ø±ÙˆÙ Ø§Ù„Ø¬Ø±</h3>
      <p style="color:#374151;">ØªØ¹Ù„Ù… Ø§Ø³ØªØ®Ø¯Ø§Ù… in, on, at ÙˆØºÙŠØ±Ù‡Ø§</p><button onclick="showGrammarLesson('prepositions')" class="btn btn-primary" style="background:linear-gradient(90deg,#06b6d4,#0891b2);">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¯Ø±Ø³</button>
     </div>
    </div><!-- Grammar Lesson Content Area -->
    <div id="grammar-lesson-content" style="display:none;background:white;padding:30px;border-radius:15px;box-shadow:0 6px 18px rgba(16,24,40,0.06);margin:20px 0;"><!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
    </div>
    <div style="text-align:center;margin-top:30px;"><button class="btn btn-primary" onclick="goBackToPath2()">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ</button> <button class="btn btn-ghost" onclick="goBackToMain()">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
    </div>
   </div><!-- Vocabulary Section -->
   <div id="vocabulary-section" style="display:none;">
    <h2 style="text-align:center;font-size:1.7rem;margin:30px 0;color:#2ca6f2;">Ø§Ù„Ù…ÙØ±Ø¯Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ© - Daily Vocabulary</h2>
    <div style="text-align:center;margin-top:30px;"><button class="btn btn-primary" onclick="goBackToPath2()">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ</button> <button class="btn btn-ghost" onclick="goBackToMain()">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
    </div>
   </div><!-- Path 2 Quiz Section -->
   <div id="path2-quiz-section" style="display:none;">
    <h2 style="text-align:center;font-size:1.7rem;margin:30px 0;color:#0891b2;">ğŸ¯ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ</h2>
    <div id="path2-student-info" style="background:white;padding:25px;border-radius:15px;box-shadow:0 6px 18px rgba(16,24,40,0.06);max-width:500px;margin:0 auto 30px;">
     <h3 style="text-align:center;color:#0891b2;margin-bottom:20px;">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨Ø©</h3>
     <div style="margin-bottom:15px;"><label for="path2-student-name" style="display:block;margin-bottom:5px;font-weight:600;color:#374151;">Ø§Ù„Ø§Ø³Ù…:</label> <input type="text" id="path2-student-name" placeholder="Ø£Ø¯Ø®Ù„ÙŠ Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ§Ù…Ù„" style="width:100%;padding:10px;border:2px solid #e5e7eb;border-radius:8px;font-size:1rem;">
     </div>
     <div style="margin-bottom:20px;"><label for="path2-student-class" style="display:block;margin-bottom:5px;font-weight:600;color:#374151;">Ø§Ù„ÙØµÙ„:</label> <input type="text" id="path2-student-class" placeholder="Ø£Ø¯Ø®Ù„ÙŠ ÙØµÙ„Ùƒ (Ù…Ø«Ø§Ù„: 1Ø£)" style="width:100%;padding:10px;border:2px solid #e5e7eb;border-radius:8px;font-size:1rem;">
     </div><button onclick="startPath2Quiz()" class="btn btn-primary" style="width:100%;background:linear-gradient(90deg,#0891b2,#0e7490);">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</button>
    </div>
    <div style="text-align:center;margin-top:30px;"><button class="btn btn-primary" onclick="goBackToPath2()">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ</button> <button class="btn btn-ghost" onclick="goBackToMain()">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
    </div>
   </div><!-- Path 3 Quiz Section -->
   <div id="path3-quiz-section" style="display:none;">
    <h2 style="text-align:center;font-size:1.7rem;margin:30px 0;color:#0891b2;">âœï¸ Ø§Ø®ØªØ¨Ø§Ø± ÙƒØªØ§Ø¨Ø© Ø§Ù„ÙÙ‚Ø±Ø© Ø§Ù„ÙˆØµÙÙŠØ©</h2><!-- Student Info for Path 3 -->
    <div id="path3-student-info" style="background:white;padding:25px;border-radius:15px;box-shadow:0 6px 18px rgba(16,24,40,0.06);max-width:500px;margin:0 auto 30px;">
     <h3 style="text-align:center;color:#0891b2;margin-bottom:20px;">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨Ø©</h3>
     <div style="margin-bottom:15px;"><label for="path3-student-name" style="display:block;margin-bottom:5px;font-weight:600;color:#374151;">Ø§Ù„Ø§Ø³Ù…:</label> <input type="text" id="path3-student-name" placeholder="Ø£Ø¯Ø®Ù„ÙŠ Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ§Ù…Ù„" style="width:100%;padding:10px;border:2px solid #e5e7eb;border-radius:8px;font-size:1rem;">
     </div>
     <div style="margin-bottom:20px;"><label for="path3-student-class" style="display:block;margin-bottom:5px;font-weight:600;color:#374151;">Ø§Ù„ÙØµÙ„:</label> <input type="text" id="path3-student-class" placeholder="Ø£Ø¯Ø®Ù„ÙŠ ÙØµÙ„Ùƒ (Ù…Ø«Ø§Ù„: 1Ø£)" style="width:100%;padding:10px;border:2px solid #e5e7eb;border-radius:8px;font-size:1rem;">
     </div><button onclick="startPath3Quiz()" class="btn btn-primary" style="width:100%;background:linear-gradient(90deg,#0891b2,#0e7490);">Ø§Ø¨Ø¯Ø£ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ÙƒØªØ§Ø¨Ø©</button>
    </div><!-- Writing Test Interface -->
    <div id="path3-writing-test" style="display:none;">
     <div style="background:white;padding:30px;border-radius:15px;box-shadow:0 6px 18px rgba(16,24,40,0.06);max-width:900px;margin:0 auto;"><!-- Instructions -->
      <div style="background:#f0f9ff;padding:20px;border-radius:12px;margin-bottom:25px;border-right:4px solid #0891b2;">
       <h4 style="color:#0e7490;margin-bottom:15px;">ğŸ“ ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±:</h4>
       <ul style="color:#374151;line-height:1.8;margin:0;padding-right:20px;">
        <li style="color: #dc2626; font-weight: bold; font-size: 1.1rem;">Ø§ÙƒØªØ¨ÙŠ ÙÙ‚Ø±Ø© ÙˆØµÙÙŠØ© Ø¹Ù† ØµØ¯ÙŠÙ‚ØªÙƒ Ø§Ù„Ù…ÙØ¶Ù„Ø© (Ù„Ø§ ØªÙ‚Ù„ Ø¹Ù† 50 ÙƒÙ„Ù…Ø©)</li>
        <li>Ø§Ø³ØªØ®Ø¯Ù…ÙŠ ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø±Ø¨Ø· Ù…Ø«Ù„: First, Second, Also, However, Finally</li>
        <li>Ø§Ù‡ØªÙ…ÙŠ Ø¨Ø§Ù„ØªØ±Ù‚ÙŠÙ… ÙˆØ§Ù„Ø£Ø­Ø±Ù Ø§Ù„ÙƒØ¨ÙŠØ±Ø©</li>
        <li>Ø§Ø¨Ø¯Ø¦ÙŠ Ø¨Ø¬Ù…Ù„Ø© ØªØ¹Ø±ÙŠÙÙŠØ© ÙˆØ§Ø®ØªØªÙ…ÙŠ Ø¨Ø¬Ù…Ù„Ø© Ø®ØªØ§Ù…ÙŠØ©</li>
        <li>Ø£Ø¶ÙŠÙÙŠ Ø£Ù…Ø«Ù„Ø© ÙˆØªÙØ§ØµÙŠÙ„ Ù„Ø¥Ø«Ø±Ø§Ø¡ Ø§Ù„Ù…Ø­ØªÙˆÙ‰</li>
       </ul>
      </div><!-- Live Scoring Panel -->
      <div style="display:grid;grid-template-columns:2fr 1fr;gap:20px;margin-bottom:25px;"><!-- Writing Area -->
       <div>
        <h4 style="color:#374151;margin-bottom:10px;">âœï¸ Ù…Ù†Ø·Ù‚Ø© Ø§Ù„ÙƒØªØ§Ø¨Ø©:</h4><textarea id="paragraph-input" placeholder="Ø§Ø¨Ø¯Ø¦ÙŠ ÙƒØªØ§Ø¨Ø© ÙÙ‚Ø±ØªÙƒ Ù‡Ù†Ø§... Ù…Ø«Ø§Ù„: My best friend Sarah is an amazing person who has many wonderful qualities..." style="width:100%;padding:20px;border:2px solid #e5e7eb;border-radius:12px;font-size:1.1rem;min-height:300px;resize:vertical;font-family:'Times New Roman',serif;direction:ltr;text-align:left;line-height:1.6;" oninput="analyzeWriting()"></textarea>
        <div style="display:flex;gap:10px;margin-top:15px;flex-wrap:wrap;"><button onclick="insertConnector('First, ')" class="connector-btn">First,</button> <button onclick="insertConnector('Second, ')" class="connector-btn">Second,</button> <button onclick="insertConnector('Also, ')" class="connector-btn">Also,</button> <button onclick="insertConnector('However, ')" class="connector-btn">However,</button> <button onclick="insertConnector('Finally, ')" class="connector-btn">Finally,</button> <button onclick="insertConnector('In addition, ')" class="connector-btn">In addition,</button>
        </div>
       </div><!-- Live Analysis Panel -->
       <div>
        <h4 style="color:#374151;margin-bottom:10px;">ğŸ“Š Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø±:</h4>
        <div id="live-analysis" style="background:#f8fafc;padding:20px;border-radius:12px;border:2px solid #e2e8f0;">
         <div style="margin-bottom:15px;">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:5px;"><span style="font-size:0.9rem;color:#6b7280;">Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©</span> <span id="total-score" style="font-weight:700;font-size:1.2rem;color:#0891b2;">0/100</span>
          </div>
          <div style="background:#e5e7eb;border-radius:10px;height:8px;overflow:hidden;">
           <div id="score-bar" style="background:linear-gradient(90deg,#0891b2,#06b6d4);height:100%;width:0%;transition:width 0.3s ease;"></div>
          </div>
         </div>
         <div id="criteria-breakdown" style="font-size:0.9rem;">
          <div class="criteria-item" data-criteria="length"><span>ğŸ“ Ø·ÙˆÙ„ Ø§Ù„ÙÙ‚Ø±Ø©:</span> <span class="score">0/15</span>
          </div>
          <div class="criteria-item" data-criteria="sentences"><span>ğŸ“ Ø¹Ø¯Ø¯ Ø§Ù„Ø¬Ù…Ù„:</span> <span class="score">0/15</span>
          </div>
          <div class="criteria-item" data-criteria="connectors"><span>ğŸ”— ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø±Ø¨Ø·:</span> <span class="score">0/20</span>
          </div>
          <div class="criteria-item" data-criteria="punctuation"><span>âœï¸ Ø§Ù„ØªØ±Ù‚ÙŠÙ… ÙˆØ§Ù„Ù‚ÙˆØ§Ø¹Ø¯:</span> <span class="score">0/25</span>
          </div>
          <div class="criteria-item" data-criteria="structure"><span>ğŸ—ï¸ Ø¨Ù†ÙŠØ© Ø§Ù„ÙÙ‚Ø±Ø©:</span> <span class="score">0/15</span>
          </div>
          <div class="criteria-item" data-criteria="examples"><span>ğŸ’¡ Ø§Ù„Ø£Ù…Ø«Ù„Ø© ÙˆØ§Ù„ØªÙØ§ØµÙŠÙ„:</span> <span class="score">0/10</span>
          </div>
         </div>
         <div id="live-feedback" style="margin-top:15px;padding:10px;background:#fffbeb;border-radius:8px;border-left:4px solid #f59e0b;font-size:0.8rem;color:#92400e;">
          ğŸ’¡ Ø§Ø¨Ø¯Ø¦ÙŠ Ø§Ù„ÙƒØªØ§Ø¨Ø© Ù„Ø±Ø¤ÙŠØ© Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø±...
         </div>
        </div>
       </div>
      </div><!-- Submit Button -->
      <div style="text-align:center;margin-top:25px;"><button onclick="submitParagraph()" class="btn btn-primary" style="background:linear-gradient(90deg,#0891b2,#0e7490);font-size:1.1rem;padding:15px 30px;">ğŸ“¤ ØªØ³Ù„ÙŠÙ… Ø§Ù„ÙÙ‚Ø±Ø© Ù„Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</button>
      </div>
     </div>
    </div><!-- Results Section -->
    <div id="path3-results" style="display:none;"><!-- Results will be populated by JavaScript -->
    </div>
    <div style="text-align:center;margin-top:30px;"><button class="btn btn-primary" onclick="goBackToPath3()">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø«Ø§Ù„Ø«</button> <button class="btn btn-ghost" onclick="goBackToMain()">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
    </div>
   </div>
   <script>
// Global variables
let currentQuestionIndex = 0;
let currentScore = 0;
let studentName = '';
let studentClass = '';
let currentRecordCount = 0;
let currentExerciseIndex = 0;
let currentExerciseType = '';

// Path 2 Quiz variables
let path2QuestionIndex = 0;
let path2Score = 0;
let path2StudentName = '';
let path2StudentClass = '';
let path2AllQuestions = [];

// Path 3 Writing Test variables
let path3StudentName = '';
let path3StudentClass = '';
let currentAnalysis = {
  length: 0,
  sentences: 0,
  connectors: 0,
  punctuation: 0,
  structure: 0,
  examples: 0,
  total: 0
};



// Default configuration
const defaultConfig = {
  main_title: "fly with English - Ø§Ù†Ø·Ù„Ù‚ÙŠ Ø¨Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©",
  subtitle: "Ù…Ø±Ø­Ø¨Ø§ Ø¨Ùƒ Ø·Ø§Ù„Ø¨ØªÙ†Ø§ Ø§Ù„Ø¹Ø²ÙŠØ²Ø© Ø­ÙŠØ« Ù†Ø¨Ø¯Ø£ Ø±Ø­Ù„ØªÙ†Ø§ Ù…Ù† Ø£ÙˆÙ„Ù‰ Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªØ£Ø³ÙŠØ³ Ø­ØªÙ‰ ÙƒØªØ§Ø¨Ø© Ù…Ù‚Ø§Ù„Ùƒ Ø§Ù„Ø£ÙˆÙ„ Ø¨ÙƒÙ„ Ø«Ù‚Ø©"
};

// Data handler for SDK
const dataHandler = {
  onDataChanged(data) {
    currentRecordCount = data.length;
  }
};

// Visitor counter functions
function initializeVisitorCounter() {
  // Get current visitor count from localStorage
  let visitorCount = localStorage.getItem('visitorCount');
  
  if (!visitorCount) {
    // First time visitor
    visitorCount = 1;
  } else {
    // Increment visitor count
    visitorCount = parseInt(visitorCount) + 1;
  }
  
  // Save updated count
  localStorage.setItem('visitorCount', visitorCount);
  
  // Display count with animation
  updateVisitorDisplay(visitorCount);
}

function updateVisitorDisplay(count) {
  const visitorElement = document.getElementById('visitor-count');
  if (visitorElement) {
    // Animate the counter
    let currentCount = 0;
    const increment = Math.ceil(count / 50);
    const timer = setInterval(() => {
      currentCount += increment;
      if (currentCount >= count) {
        currentCount = count;
        clearInterval(timer);
      }
      visitorElement.textContent = currentCount.toLocaleString('ar-SA');
    }, 30);
    
    // Add pulse animation
    visitorElement.style.animation = 'pulse 0.5s ease-in-out';
    setTimeout(() => {
      visitorElement.style.animation = '';
    }, 500);
  }
}

// Initialize SDKs
async function initializeApp() {
  // Initialize visitor counter
  initializeVisitorCounter();
  
  if (window.elementSdk) {
    await window.elementSdk.init({
      defaultConfig: defaultConfig,
      onConfigChange: async (config) => {
        const titleElement = document.getElementById('main-title');
        const subtitleElement = document.getElementById('subtitle');
        
        if (titleElement) {
          titleElement.textContent = config.main_title || defaultConfig.main_title;
        }
        if (subtitleElement) {
          subtitleElement.textContent = config.subtitle || defaultConfig.subtitle;
        }
      },
      mapToCapabilities: (config) => ({
        recolorables: [],
        borderables: [],
        fontEditable: undefined,
        fontSizeable: undefined
      }),
      mapToEditPanelValues: (config) => new Map([
        ["main_title", config.main_title || defaultConfig.main_title],
        ["subtitle", config.subtitle || defaultConfig.subtitle]
      ])
    });
  }

  if (window.dataSdk) {
    const initResult = await window.dataSdk.init(dataHandler);
    if (!initResult.isOk) {
      console.error("Failed to initialize data SDK");
    }
  }
}

document.addEventListener('DOMContentLoaded', initializeApp);

// Quiz data
const audioQuestions = [
  { word: 'Apple', correctLetter: 'A', options: ['A', 'E', 'I', 'O'], arabic: 'ØªÙØ§Ø­Ø©' },
  { word: 'Elephant', correctLetter: 'E', options: ['A', 'E', 'I', 'U'], arabic: 'ÙÙŠÙ„' },
  { word: 'Ice', correctLetter: 'I', options: ['A', 'E', 'I', 'O'], arabic: 'Ø«Ù„Ø¬' },
  { word: 'Orange', correctLetter: 'O', options: ['A', 'E', 'I', 'O'], arabic: 'Ø¨Ø±ØªÙ‚Ø§Ù„' },
  { word: 'Umbrella', correctLetter: 'U', options: ['A', 'E', 'I', 'U'], arabic: 'Ù…Ø¸Ù„Ø©' },
  { word: 'Book', correctLetter: 'B', options: ['B', 'P', 'D', 'T'], arabic: 'ÙƒØªØ§Ø¨' },
  { word: 'Cat', correctLetter: 'C', options: ['C', 'K', 'G', 'S'], arabic: 'Ù‚Ø·Ø©' },
  { word: 'Dog', correctLetter: 'D', options: ['D', 'B', 'P', 'T'], arabic: 'ÙƒÙ„Ø¨' }
];

const pronounQuestions = [
  { 
    sentence: '___ am a student', 
    arabic: 'Ø£Ù†Ø§ Ø·Ø§Ù„Ø¨Ø©', 
    correct: 'I', 
    options: ['I', 'You', 'He', 'She'],
    explanation: 'Ù†Ø³ØªØ®Ø¯Ù… I Ù…Ø¹ Ø§Ù„Ù…ØªÙƒÙ„Ù… (Ø£Ù†Ø§)'
  },
  { 
    sentence: '___ is my friend', 
    arabic: 'Ù‡Ùˆ ØµØ¯ÙŠÙ‚ÙŠ', 
    correct: 'He', 
    options: ['I', 'You', 'He', 'She'],
    explanation: 'Ù†Ø³ØªØ®Ø¯Ù… He Ù„Ù„Ù…Ø°ÙƒØ± Ø§Ù„ØºØ§Ø¦Ø¨ (Ù‡Ùˆ)'
  },
  { 
    sentence: '___ are very kind', 
    arabic: 'Ø£Ù†Øª Ù„Ø·ÙŠÙØ© Ø¬Ø¯Ø§Ù‹', 
    correct: 'You', 
    options: ['I', 'You', 'We', 'They'],
    explanation: 'Ù†Ø³ØªØ®Ø¯Ù… You Ù„Ù„Ù…Ø®Ø§Ø·Ø¨ (Ø£Ù†Øª/Ø£Ù†ØªÙ)'
  },
  { 
    sentence: '___ likes to read', 
    arabic: 'Ù‡ÙŠ ØªØ­Ø¨ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©', 
    correct: 'She', 
    options: ['I', 'He', 'She', 'We'],
    explanation: 'Ù†Ø³ØªØ®Ø¯Ù… She Ù„Ù„Ù…Ø¤Ù†Ø« Ø§Ù„ØºØ§Ø¦Ø¨ (Ù‡ÙŠ)'
  },
  { 
    sentence: '___ go to school together', 
    arabic: 'Ù†Ø­Ù† Ù†Ø°Ù‡Ø¨ Ù„Ù„Ù…Ø¯Ø±Ø³Ø© Ù…Ø¹Ø§Ù‹', 
    correct: 'We', 
    options: ['I', 'You', 'We', 'They'],
    explanation: 'Ù†Ø³ØªØ®Ø¯Ù… We Ù„Ù„Ø¬Ù…Ø¹ Ø§Ù„Ù…ØªÙƒÙ„Ù… (Ù†Ø­Ù†)'
  },
  { 
    sentence: '___ are playing outside', 
    arabic: 'Ù‡Ù… ÙŠÙ„Ø¹Ø¨ÙˆÙ† ÙÙŠ Ø§Ù„Ø®Ø§Ø±Ø¬', 
    correct: 'They', 
    options: ['We', 'You', 'They', 'She'],
    explanation: 'Ù†Ø³ØªØ®Ø¯Ù… They Ù„Ù„Ø¬Ù…Ø¹ Ø§Ù„ØºØ§Ø¦Ø¨ (Ù‡Ù…/Ù‡Ù†)'
  },
  { 
    sentence: 'This is ___ book', 
    arabic: 'Ù‡Ø°Ø§ ÙƒØªØ§Ø¨ÙŠ', 
    correct: 'my', 
    options: ['my', 'your', 'his', 'her'],
    explanation: 'Ù†Ø³ØªØ®Ø¯Ù… my Ù„Ù„Ù…Ù„ÙƒÙŠØ© Ù„Ù„Ù…ØªÙƒÙ„Ù… (ÙƒØªØ§Ø¨ÙŠ)'
  },
  { 
    sentence: 'Where is ___ bag?', 
    arabic: 'Ø£ÙŠÙ† Ø­Ù‚ÙŠØ¨ØªÙƒØŸ', 
    correct: 'your', 
    options: ['my', 'your', 'his', 'their'],
    explanation: 'Ù†Ø³ØªØ®Ø¯Ù… your Ù„Ù„Ù…Ù„ÙƒÙŠØ© Ù„Ù„Ù…Ø®Ø§Ø·Ø¨ (Ø­Ù‚ÙŠØ¨ØªÙƒ)'
  }
];

// Path 2 Quiz Questions - Grammar, Sentence Formation, and Vocabulary
const path2GrammarQuestions = [
  {
    type: 'grammar',
    category: 'Ø§Ù„Ù…Ø¶Ø§Ø±Ø¹ Ø§Ù„Ø¨Ø³ÙŠØ·',
    question: 'She ___ to school every day.',
    arabic: 'Ù‡ÙŠ ØªØ°Ù‡Ø¨ Ù„Ù„Ù…Ø¯Ø±Ø³Ø© ÙƒÙ„ ÙŠÙˆÙ…',
    correct: 'goes',
    options: ['go', 'goes', 'going', 'went'],
    explanation: 'Ù†Ø³ØªØ®Ø¯Ù… goes Ù…Ø¹ She ÙÙŠ Ø§Ù„Ù…Ø¶Ø§Ø±Ø¹ Ø§Ù„Ø¨Ø³ÙŠØ· (Ù†Ø¶ÙŠÙ s Ù„Ù„ÙØ¹Ù„)'
  },
  {
    type: 'grammar',
    category: 'Ø§Ù„Ù…Ø¶Ø§Ø±Ø¹ Ø§Ù„Ù…Ø³ØªÙ…Ø±',
    question: 'They ___ playing football now.',
    arabic: 'Ù‡Ù… ÙŠÙ„Ø¹Ø¨ÙˆÙ† ÙƒØ±Ø© Ø§Ù„Ù‚Ø¯Ù… Ø§Ù„Ø¢Ù†',
    correct: 'are',
    options: ['is', 'am', 'are', 'was'],
    explanation: 'Ù†Ø³ØªØ®Ø¯Ù… are Ù…Ø¹ They ÙÙŠ Ø§Ù„Ù…Ø¶Ø§Ø±Ø¹ Ø§Ù„Ù…Ø³ØªÙ…Ø±'
  },
  {
    type: 'grammar',
    category: 'Ø§Ù„Ù…Ø§Ø¶ÙŠ Ø§Ù„Ø¨Ø³ÙŠØ·',
    question: 'I ___ my homework yesterday.',
    arabic: 'Ø£Ù†Ø¬Ø²Øª ÙˆØ§Ø¬Ø¨ÙŠ Ø£Ù…Ø³',
    correct: 'did',
    options: ['do', 'did', 'does', 'doing'],
    explanation: 'Ù†Ø³ØªØ®Ø¯Ù… did ÙÙŠ Ø§Ù„Ù…Ø§Ø¶ÙŠ Ø§Ù„Ø¨Ø³ÙŠØ· Ù…Ø¹ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¶Ù…Ø§Ø¦Ø±'
  },
  {
    type: 'grammar',
    category: 'Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ Ø§Ù„Ø¨Ø³ÙŠØ·',
    question: 'We ___ to the park tomorrow.',
    arabic: 'Ø³Ù†Ø°Ù‡Ø¨ Ù„Ù„Ø­Ø¯ÙŠÙ‚Ø© ØºØ¯Ø§Ù‹',
    correct: 'will go',
    options: ['go', 'went', 'will go', 'going'],
    explanation: 'Ù†Ø³ØªØ®Ø¯Ù… will + Ø§Ù„ÙØ¹Ù„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ Ù„Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ Ø§Ù„Ø¨Ø³ÙŠØ·'
  },
  {
    type: 'grammar',
    category: 'Ø§Ù„Ù…Ø¶Ø§Ø±Ø¹ Ø§Ù„Ù…Ø³ØªÙ…Ø±',
    question: 'She ___ reading a book right now.',
    arabic: 'Ù‡ÙŠ ØªÙ‚Ø±Ø£ ÙƒØªØ§Ø¨Ø§Ù‹ Ø§Ù„Ø¢Ù†',
    correct: 'is',
    options: ['is', 'are', 'am', 'was'],
    explanation: 'Ù†Ø³ØªØ®Ø¯Ù… is Ù…Ø¹ She ÙÙŠ Ø§Ù„Ù…Ø¶Ø§Ø±Ø¹ Ø§Ù„Ù…Ø³ØªÙ…Ø±'
  },
  {
    type: 'grammar',
    category: 'Ø§Ù„Ù…Ø§Ø¶ÙŠ Ø§Ù„Ø¨Ø³ÙŠØ·',
    question: 'The cat ___ on the sofa last night.',
    arabic: 'Ù†Ø§Ù…Øª Ø§Ù„Ù‚Ø·Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø±ÙŠÙƒØ© Ø§Ù„Ù„ÙŠÙ„Ø© Ø§Ù„Ù…Ø§Ø¶ÙŠØ©',
    correct: 'slept',
    options: ['sleep', 'sleeps', 'slept', 'sleeping'],
    explanation: 'slept Ù‡Ùˆ Ø§Ù„Ù…Ø§Ø¶ÙŠ Ø§Ù„Ø¨Ø³ÙŠØ· Ù„Ù„ÙØ¹Ù„ sleep'
  }
];

const path2SentenceQuestions = [
  {
    type: 'sentence',
    category: 'ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø¬Ù…Ù„',
    question: 'Ø§Ø®ØªØ± Ø§Ù„Ø¬Ù…Ù„Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©:',
    arabic: 'Ø£Ù†Ø§ Ø£Ø­Ø¨ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©',
    correct: 'I love reading.',
    options: [
      'I love reading.',
      'I loving read.',
      'I am love reading.'
    ],
    explanation: 'Ø§Ù„Ø¬Ù…Ù„Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© ØªØªØ¨Ø¹ ØªØ±ØªÙŠØ¨: Ø§Ù„ÙØ§Ø¹Ù„ + Ø§Ù„ÙØ¹Ù„ + Ø§Ù„Ù…ÙØ¹ÙˆÙ„'
  },
  {
    type: 'sentence',
    category: 'ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø¬Ù…Ù„',
    question: 'Ø§Ø®ØªØ± Ø§Ù„Ø¬Ù…Ù„Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©:',
    arabic: 'Ù‡ÙŠ ØªØ¯Ø±Ø³ ÙÙŠ Ø§Ù„Ù…ÙƒØªØ¨Ø©',
    correct: 'She studies in the library.',
    options: [
      'She study in the library.',
      'She studies in the library.',
      'She is study in the library.'
    ],
    explanation: 'Ù†Ø¶ÙŠÙ s Ù„Ù„ÙØ¹Ù„ Ù…Ø¹ She ÙÙŠ Ø§Ù„Ù…Ø¶Ø§Ø±Ø¹ Ø§Ù„Ø¨Ø³ÙŠØ·'
  },
  {
    type: 'sentence',
    category: 'ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø¬Ù…Ù„',
    question: 'Ø§Ø®ØªØ± Ø§Ù„Ø¬Ù…Ù„Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©:',
    arabic: 'Ù†Ø­Ù† Ù†Ù„Ø¹Ø¨ ÙÙŠ Ø§Ù„Ø­Ø¯ÙŠÙ‚Ø© Ø§Ù„Ø¢Ù†',
    correct: 'We are playing in the garden now.',
    options: [
      'We play in the garden now.',
      'We are playing in the garden now.',
      'We playing in the garden now.'
    ],
    explanation: 'Ù†Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø¶Ø§Ø±Ø¹ Ø§Ù„Ù…Ø³ØªÙ…Ø± (are + ing) Ù…Ø¹ ÙƒÙ„Ù…Ø© now'
  },
  {
    type: 'sentence',
    category: 'ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø¬Ù…Ù„',
    question: 'Ø§Ø®ØªØ± Ø§Ù„Ø¬Ù…Ù„Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©:',
    arabic: 'Ø³Ø£Ø°Ù‡Ø¨ Ù„Ù„Ù…Ø¯Ø±Ø³Ø© ØºØ¯Ø§Ù‹',
    correct: 'I will go to school tomorrow.',
    options: [
      'I go to school tomorrow.',
      'I will go to school tomorrow.',
      'I am go to school tomorrow.'
    ],
    explanation: 'Ù†Ø³ØªØ®Ø¯Ù… will Ù„Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ Ø§Ù„Ø¨Ø³ÙŠØ·'
  }
];

const path2VocabularyQuestions = [
  {
    type: 'vocabulary',
    category: 'Ø§Ù„Ù…ÙØ±Ø¯Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©',
    question: 'Ù…Ø§ Ù…Ø¹Ù†Ù‰ ÙƒÙ„Ù…Ø© "breakfast"ØŸ',
    correct: 'Ø§Ù„Ø¥ÙØ·Ø§Ø±',
    options: ['Ø§Ù„Ø¥ÙØ·Ø§Ø±', 'Ø§Ù„ØºØ¯Ø§Ø¡', 'Ø§Ù„Ø¹Ø´Ø§Ø¡', 'Ø§Ù„ÙˆØ¬Ø¨Ø© Ø§Ù„Ø®ÙÙŠÙØ©'],
    explanation: 'breakfast ØªØ¹Ù†ÙŠ Ø§Ù„Ø¥ÙØ·Ø§Ø± - Ø§Ù„ÙˆØ¬Ø¨Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ ÙÙŠ Ø§Ù„ÙŠÙˆÙ…'
  },
  {
    type: 'vocabulary',
    category: 'Ø§Ù„Ù…ÙØ±Ø¯Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©',
    question: 'Ù…Ø§ Ù…Ø¹Ù†Ù‰ ÙƒÙ„Ù…Ø© "kitchen"ØŸ',
    correct: 'Ø§Ù„Ù…Ø·Ø¨Ø®',
    options: ['ØºØ±ÙØ© Ø§Ù„Ù†ÙˆÙ…', 'Ø§Ù„Ø­Ù…Ø§Ù…', 'Ø§Ù„Ù…Ø·Ø¨Ø®', 'ØºØ±ÙØ© Ø§Ù„Ù…Ø¹ÙŠØ´Ø©'],
    explanation: 'kitchen ØªØ¹Ù†ÙŠ Ø§Ù„Ù…Ø·Ø¨Ø® - Ø§Ù„Ù…ÙƒØ§Ù† Ø§Ù„Ø°ÙŠ Ù†Ø·Ø¨Ø® ÙÙŠÙ‡'
  },
  {
    type: 'vocabulary',
    category: 'Ø§Ù„Ù…ÙØ±Ø¯Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©',
    question: 'Ù…Ø§ Ù…Ø¹Ù†Ù‰ ÙƒÙ„Ù…Ø© "homework"ØŸ',
    correct: 'Ø§Ù„ÙˆØ§Ø¬Ø¨ Ø§Ù„Ù…Ù†Ø²Ù„ÙŠ',
    options: ['Ø§Ù„Ø¨ÙŠØª', 'Ø§Ù„Ø¹Ù…Ù„', 'Ø§Ù„ÙˆØ§Ø¬Ø¨ Ø§Ù„Ù…Ù†Ø²Ù„ÙŠ', 'Ø§Ù„Ù…Ù†Ø²Ù„'],
    explanation: 'homework ØªØ¹Ù†ÙŠ Ø§Ù„ÙˆØ§Ø¬Ø¨ Ø§Ù„Ù…Ù†Ø²Ù„ÙŠ - Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ© Ø§Ù„ØªÙŠ Ù†Ø¤Ø¯ÙŠÙ‡Ø§ ÙÙŠ Ø§Ù„Ø¨ÙŠØª'
  },
  {
    type: 'vocabulary',
    category: 'Ø§Ù„Ù…ÙØ±Ø¯Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©',
    question: 'Ù…Ø§ Ù…Ø¹Ù†Ù‰ ÙƒÙ„Ù…Ø© "weather"ØŸ',
    correct: 'Ø§Ù„Ø·Ù‚Ø³',
    options: ['Ø§Ù„Ù…Ø§Ø¡', 'Ø§Ù„Ø·Ù‚Ø³', 'Ø§Ù„Ø±ÙŠØ­', 'Ø§Ù„Ù…Ø·Ø±'],
    explanation: 'weather ØªØ¹Ù†ÙŠ Ø§Ù„Ø·Ù‚Ø³ - Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ùˆ (Ù…Ø´Ù…Ø³ØŒ Ù…Ù…Ø·Ø±ØŒ ØºØ§Ø¦Ù…)'
  },
  {
    type: 'vocabulary',
    category: 'Ø§Ù„Ù…ÙØ±Ø¯Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©',
    question: 'Ù…Ø§ Ù…Ø¹Ù†Ù‰ ÙƒÙ„Ù…Ø© "neighbor"ØŸ',
    correct: 'Ø§Ù„Ø¬Ø§Ø±',
    options: ['Ø§Ù„ØµØ¯ÙŠÙ‚', 'Ø§Ù„Ø¬Ø§Ø±', 'Ø§Ù„Ø£Ø®', 'Ø§Ù„Ø²Ù…ÙŠÙ„'],
    explanation: 'neighbor ØªØ¹Ù†ÙŠ Ø§Ù„Ø¬Ø§Ø± - Ø§Ù„Ø´Ø®Øµ Ø§Ù„Ø°ÙŠ ÙŠØ³ÙƒÙ† Ø¨Ø¬Ø§Ù†Ø¨Ùƒ'
  },
  {
    type: 'vocabulary',
    category: 'Ø§Ù„Ù…ÙØ±Ø¯Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©',
    question: 'Ù…Ø§ Ù…Ø¹Ù†Ù‰ ÙƒÙ„Ù…Ø© "shopping"ØŸ',
    correct: 'Ø§Ù„ØªØ³ÙˆÙ‚',
    options: ['Ø§Ù„Ø·Ø¨Ø®', 'Ø§Ù„ØªÙ†Ø¸ÙŠÙ', 'Ø§Ù„ØªØ³ÙˆÙ‚', 'Ø§Ù„ØºØ³ÙŠÙ„'],
    explanation: 'shopping ØªØ¹Ù†ÙŠ Ø§Ù„ØªØ³ÙˆÙ‚ - Ø´Ø±Ø§Ø¡ Ø§Ù„Ø£Ø´ÙŠØ§Ø¡ Ù…Ù† Ø§Ù„Ù…ØªØ§Ø¬Ø±'
  }
];

// Navigation functions
function showPath1() {
  hideAllSections();
  document.getElementById('path1-section').style.display = 'grid';
  document.getElementById('top-navigation').style.display = 'block';
  
  // Update button styles to highlight current path
  updateNavigationButtons('path1');
}

function showPath2() {
  hideAllSections();
  document.getElementById('path2-section').style.display = 'grid';
  document.getElementById('top-navigation').style.display = 'block';
  
  // Update button styles to highlight current path
  updateNavigationButtons('path2');
}

function showPath3() {
  hideAllSections();
  document.getElementById('path3-section').style.display = 'grid';
  document.getElementById('top-navigation').style.display = 'block';
  
  // Update button styles to highlight current path
  updateNavigationButtons('path3');
}

function hideAllSections() {
  const sections = ['path1-section', 'path2-section', 'path3-section', 'quiz-section', 'path3-quiz-section', 'sentence-builder-section', 'vocabulary-section', 'grammar-section'];
  sections.forEach(id => {
    const element = document.getElementById(id);
    if (element) element.style.display = 'none';
  });
  document.getElementById('top-navigation').style.display = 'none';
}

function goBackToMain() {
  hideAllSections();
  document.getElementById('path1-section').style.display = 'grid';
  document.getElementById('top-navigation').style.display = 'block';
  updateNavigationButtons('path1');
}

function goBackToPath1() {
  hideAllSections();
  document.getElementById('path1-section').style.display = 'grid';
  document.getElementById('top-navigation').style.display = 'block';
  updateNavigationButtons('path1');
}

function goBackToPath2() {
  hideAllSections();
  document.getElementById('path2-section').style.display = 'grid';
  document.getElementById('top-navigation').style.display = 'block';
  updateNavigationButtons('path2');
}

function goBackToPath3() {
  hideAllSections();
  document.getElementById('path3-section').style.display = 'grid';
  document.getElementById('top-navigation').style.display = 'block';
  updateNavigationButtons('path3');
}

// Function to update navigation button styles
function updateNavigationButtons(currentPath) {
  const topNav = document.getElementById('top-navigation');
  if (!topNav) return;
  
  const buttons = topNav.querySelectorAll('button');
  buttons.forEach((button, index) => {
    // Reset all buttons to default style
    button.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
    button.style.boxShadow = '0 4px 15px rgba(0, 0, 0, 0.1)';
    button.textContent = button.textContent.replace(' â­', '');
    
    // Highlight current path button
    if ((currentPath === 'path1' && index === 0) ||
        (currentPath === 'path2' && index === 1) ||
        (currentPath === 'path3' && index === 2)) {
      button.style.background = 'linear-gradient(135deg, #f59e0b, #d97706)';
      button.style.boxShadow = '0 8px 25px rgba(245, 158, 11, 0.4)';
      button.textContent += ' â­';
    }
  });
}

// Section display functions
function showQuizPage() {
  hideAllSections();
  document.getElementById('quiz-section').style.display = 'block';
}

function showGrammarPage() {
  hideAllSections();
  document.getElementById('grammar-section').style.display = 'block';
}

function showVocabularyPage() {
  hideAllSections();
  document.getElementById('vocabulary-section').style.display = 'block';
}

function showParagraphWriting() {
  hideAllSections();
  document.getElementById('path3-quiz-section').style.display = 'block';
}

function showPath2Quiz() {
  hideAllSections();
  document.getElementById('path2-quiz-section').style.display = 'block';
}

function showPath3Quiz() {
  hideAllSections();
  document.getElementById('path3-quiz-section').style.display = 'block';
}

function showSentenceBuilder() {
  hideAllSections();
  document.getElementById('sentence-builder-section').style.display = 'block';
}

// Quiz functions
function startQuiz() {
  studentName = document.getElementById('student-name').value.trim();
  studentClass = document.getElementById('student-class').value.trim();
  
  if (!studentName || !studentClass) {
    showInlineMessage('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„ÙØµÙ„', 'error');
    return;
  }
  
  // Initialize quiz
  currentQuestionIndex = 0;
  currentScore = 0;
  
  showQuizQuestion();
}

function showQuizQuestion() {
  const allQuestions = [...audioQuestions, ...pronounQuestions];
  const isAudioQuestion = currentQuestionIndex < 8;
  const question = allQuestions[currentQuestionIndex];
  const progress = ((currentQuestionIndex + 1) / 16) * 100;
  
  const content = document.getElementById('quiz-section');
  content.innerHTML = `
    <h2 style="text-align:center;font-size:1.7rem;margin:30px 0;color:#f59e0b;">ğŸ¯ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø£ÙˆÙ„</h2>
    
    <!-- Progress Bar -->
    <div style="background:#f3f4f6;border-radius:10px;margin:20px auto;max-width:600px;height:20px;overflow:hidden;">
      <div style="background:linear-gradient(90deg,#f59e0b,#d97706);height:100%;width:${progress}%;transition:width 0.5s ease;border-radius:10px;"></div>
    </div>
    <p style="text-align:center;color:#6b7280;margin-bottom:30px;">Ø§Ù„Ø³Ø¤Ø§Ù„ ${currentQuestionIndex + 1} Ù…Ù† 16 (${Math.round(progress)}%)</p>
    
    <div style="background:white;padding:30px;border-radius:15px;box-shadow:0 6px 18px rgba(16,24,40,0.06);max-width:700px;margin:0 auto;">
      ${isAudioQuestion ? `
        <div style="text-align:center;margin-bottom:25px;">
          <h3 style="color:#f59e0b;margin-bottom:20px;">ğŸ§ ØªÙ…Ø±ÙŠÙ† ØµÙˆØªÙŠ - Ø§Ø®ØªØ± Ø§Ù„Ø­Ø±Ù Ø§Ù„ØµØ­ÙŠØ­</h3>
          <div style="background:#fffbeb;padding:20px;border-radius:12px;margin-bottom:20px;">
            <button onclick="playQuizAudio('${question.word}')" class="btn btn-primary" style="background:linear-gradient(90deg,#3b82f6,#2563eb);font-size:1.2rem;padding:15px 30px;">
              ğŸ”Š Ø§Ø³ØªÙ…Ø¹ Ù„Ù„ÙƒÙ„Ù…Ø©
            </button>
            <p style="color:#92400e;margin:15px 0 5px 0;font-size:1.1rem;font-weight:600;">Ø§Ù„ÙƒÙ„Ù…Ø©: ${question.word}</p>
            <p style="color:#6b7280;margin:0;font-size:0.9rem;">(${question.arabic})</p>
          </div>
          <p style="color:#374151;font-size:1.1rem;margin-bottom:20px;">Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø­Ø±Ù Ø§Ù„Ø£ÙˆÙ„ Ù…Ù† Ù‡Ø°Ù‡ Ø§Ù„ÙƒÙ„Ù…Ø©ØŸ</p>
        </div>
      ` : `
        <div style="text-align:center;margin-bottom:25px;">
          <h3 style="color:#f59e0b;margin-bottom:20px;">ğŸ‘¥ ØªÙ…Ø±ÙŠÙ† Ø§Ù„Ø¶Ù…Ø§Ø¦Ø± - Ø§Ø®ØªØ± Ø§Ù„Ø¶Ù…ÙŠØ± Ø§Ù„ØµØ­ÙŠØ­</h3>
          <div style="background:#fffbeb;padding:20px;border-radius:12px;margin-bottom:20px;">
            <p style="font-size:1.3rem;color:#374151;margin:0;font-weight:600;">${question.sentence}</p>
            <p style="color:#6b7280;margin:10px 0 0 0;font-size:1rem;">(${question.arabic})</p>
          </div>
        </div>
      `}
      
      <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:15px;margin-bottom:25px;">
        ${question.options.map((option, index) => `
          <button onclick="selectQuizAnswer('${option}')" class="quiz-option-btn" 
                  style="padding:20px;font-size:1.2rem;font-weight:600;background:#f0f9ff;color:#1e40af;border:3px solid #3b82f6;border-radius:12px;cursor:pointer;transition:all 0.3s;box-shadow:0 2px 8px rgba(0,0,0,0.1);">
            ${option}
          </button>
        `).join('')}
      </div>
      
      <div id="quiz-result" style="display:none;"></div>
    </div>
    
    <div style="text-align:center;margin-top:30px;">
      <button class="btn btn-ghost" onclick="goBackToPath1()">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø£ÙˆÙ„</button>
    </div>
  `;
}

function playQuizAudio(word) {
  if ('speechSynthesis' in window) {
    const utterance = new SpeechSynthesisUtterance(word);
    utterance.lang = 'en-US';
    utterance.rate = 0.7;
    speechSynthesis.speak(utterance);
  }
}

function selectQuizAnswer(selectedAnswer) {
  const allQuestions = [...audioQuestions, ...pronounQuestions];
  const question = allQuestions[currentQuestionIndex];
  const isCorrect = selectedAnswer === question.correct || selectedAnswer === question.correctLetter;
  const buttons = document.querySelectorAll('.quiz-option-btn');
  const resultDiv = document.getElementById('quiz-result');
  
  // Disable all buttons
  buttons.forEach((btn, index) => {
    btn.disabled = true;
    btn.style.cursor = 'not-allowed';
    
    if (btn.textContent.trim() === question.correct || btn.textContent.trim() === question.correctLetter) {
      btn.style.background = 'linear-gradient(90deg, #10b981, #059669)';
      btn.style.color = 'white';
      btn.style.borderColor = '#10b981';
    } else if (btn.textContent.trim() === selectedAnswer && !isCorrect) {
      btn.style.background = 'linear-gradient(90deg, #ef4444, #dc2626)';
      btn.style.color = 'white';
      btn.style.borderColor = '#ef4444';
    } else {
      btn.style.opacity = '0.5';
    }
  });
  
  if (isCorrect) {
    currentScore++;
  }
  
  resultDiv.style.display = 'block';
  
  if (isCorrect) {
    resultDiv.innerHTML = `
      <div style="background:#f0fdf4;border:2px solid #22c55e;border-radius:12px;padding:20px;text-align:center;margin-top:20px;">
        <div style="font-size:2rem;margin-bottom:10px;">ğŸ‰</div>
        <h4 style="color:#16a34a;margin-bottom:10px;">Ù…Ù…ØªØ§Ø²! Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©</h4>
        ${question.explanation ? `<p style="margin:10px 0;color:#374151;font-weight:500;">${question.explanation}</p>` : ''}
        <button onclick="nextQuizQuestion()" class="btn btn-primary" style="background:linear-gradient(90deg,#10b981,#059669);margin-top:15px;">
          ${currentQuestionIndex < 15 ? 'Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ â¡ï¸' : 'Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ğŸ†'}
        </button>
      </div>
    `;
  } else {
    resultDiv.innerHTML = `
      <div style="background:#fef2f2;border:2px solid #ef4444;border-radius:12px;padding:20px;text-align:center;margin-top:20px;">
        <div style="font-size:2rem;margin-bottom:10px;">âŒ</div>
        <h4 style="color:#dc2626;margin-bottom:10px;">Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© ØºÙŠØ± ØµØ­ÙŠØ­Ø©</h4>
        <p style="margin:0;color:#374151;">Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©: <strong>${question.correct || question.correctLetter}</strong></p>
        ${question.explanation ? `<p style="margin:10px 0;color:#374151;font-weight:500;">${question.explanation}</p>` : ''}
        <button onclick="nextQuizQuestion()" class="btn btn-primary" style="background:linear-gradient(90deg,#f59e0b,#d97706);margin-top:15px;">
          ${currentQuestionIndex < 15 ? 'Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ â¡ï¸' : 'Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ğŸ†'}
        </button>
      </div>
    `;
  }
}

function nextQuizQuestion() {
  currentQuestionIndex++;
  
  if (currentQuestionIndex >= 16) {
    showQuizResults();
  } else {
    showQuizQuestion();
  }
}

async function showQuizResults() {
  const percentage = Math.round((currentScore / 16) * 100);
  const passed = percentage >= 80;
  
  // Save results to data SDK
  if (window.dataSdk && currentRecordCount < 999) {
    const resultData = {
      student_name: studentName,
      student_class: studentClass,
      test_type: 'Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø£ÙˆÙ„',
      score: currentScore,
      total_questions: 16,
      percentage: percentage,
      passed: passed,
      timestamp: new Date().toISOString()
    };
    
    const saveResult = await window.dataSdk.create(resultData);
    if (!saveResult.isOk) {
      console.error('Failed to save quiz results');
    }
  }
  
  const content = document.getElementById('quiz-section');
  content.innerHTML = `
    <h2 style="text-align:center;font-size:1.7rem;margin:30px 0;color:#f59e0b;">ğŸ† Ù†ØªØ§Ø¦Ø¬ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø£ÙˆÙ„</h2>
    
    <div style="background:white;padding:40px;border-radius:20px;box-shadow:0 8px 25px rgba(16,24,40,0.1);max-width:600px;margin:0 auto;text-align:center;">
      <div style="font-size:4rem;margin-bottom:20px;">${passed ? 'ğŸ‰' : 'ğŸ“š'}</div>
      
      <h3 style="color:${passed ? '#16a34a' : '#dc2626'};margin-bottom:20px;font-size:1.5rem;">
        ${passed ? 'Ù…Ø¨Ø±ÙˆÙƒ! Ù„Ù‚Ø¯ Ù†Ø¬Ø­Øª' : 'ØªØ­ØªØ§Ø¬ Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„ØªØ¯Ø±ÙŠØ¨'}
      </h3>
      
      <div style="background:${passed ? '#f0fdf4' : '#fef2f2'};padding:25px;border-radius:15px;margin:25px 0;border:2px solid ${passed ? '#22c55e' : '#ef4444'};">
        <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:20px;margin-bottom:20px;">
          <div>
            <p style="color:#6b7280;margin:0;font-size:0.9rem;">Ø§Ù„Ø§Ø³Ù…</p>
            <p style="color:#374151;margin:5px 0 0 0;font-weight:600;font-size:1.1rem;">${studentName}</p>
          </div>
          <div>
            <p style="color:#6b7280;margin:0;font-size:0.9rem;">Ø§Ù„ÙØµÙ„</p>
            <p style="color:#374151;margin:5px 0 0 0;font-weight:600;font-size:1.1rem;">${studentClass}</p>
          </div>
        </div>
        
        <div style="border-top:1px solid #e5e7eb;padding-top:20px;">
          <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:15px;text-align:center;">
            <div>
              <p style="color:#6b7280;margin:0;font-size:0.9rem;">Ø§Ù„Ù†ØªÙŠØ¬Ø©</p>
              <p style="color:#374151;margin:5px 0 0 0;font-weight:700;font-size:1.3rem;">${currentScore}/16</p>
            </div>
            <div>
              <p style="color:#6b7280;margin:0;font-size:0.9rem;">Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ©</p>
              <p style="color:${passed ? '#16a34a' : '#dc2626'};margin:5px 0 0 0;font-weight:700;font-size:1.5rem;">${percentage}%</p>
            </div>
            <div>
              <p style="color:#6b7280;margin:0;font-size:0.9rem;">Ø§Ù„Ø­Ø§Ù„Ø©</p>
              <p style="color:${passed ? '#16a34a' : '#dc2626'};margin:5px 0 0 0;font-weight:700;font-size:1.1rem;">${passed ? 'Ù†Ø¬Ø­ âœ…' : 'Ù„Ù… ÙŠÙ†Ø¬Ø­ âŒ'}</p>
            </div>
          </div>
        </div>
      </div>
      
      <div style="background:#f8fafc;padding:20px;border-radius:12px;margin:25px 0;">
        <h4 style="color:#374151;margin-bottom:15px;">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø£Ø¯Ø§Ø¡:</h4>
        <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:15px;text-align:center;">
          <div>
            <p style="color:#6b7280;margin:0;font-size:0.9rem;">Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ† Ø§Ù„ØµÙˆØªÙŠØ©</p>
            <p style="color:#374151;margin:5px 0 0 0;font-weight:600;">${Math.min(currentScore, 8)}/8</p>
          </div>
          <div>
            <p style="color:#6b7280;margin:0;font-size:0.9rem;">ØªÙ…Ø§Ø±ÙŠÙ† Ø§Ù„Ø¶Ù…Ø§Ø¦Ø±</p>
            <p style="color:#374151;margin:5px 0 0 0;font-weight:600;">${Math.max(0, currentScore - 8)}/8</p>
          </div>
        </div>
      </div>
      
      <div style="margin-top:30px;">
        ${passed ? `
          <p style="color:#16a34a;margin-bottom:20px;font-weight:600;">ğŸ¯ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ!</p>
          <button onclick="goToPath2()" class="btn btn-primary" style="background:linear-gradient(90deg,#10b981,#059669);margin-left:10px;">Ø§Ù†ØªÙ‚Ù„ Ù„Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ ğŸš€</button>
        ` : `
          <p style="color:#dc2626;margin-bottom:20px;font-weight:600;">ğŸ“š ØªØ­ØªØ§Ø¬ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ 80% Ù„Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ</p>
          <button onclick="retakeQuiz()" class="btn btn-primary" style="background:linear-gradient(90deg,#f59e0b,#d97706);margin-left:10px;">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ğŸ”„</button>
        `}
        <button onclick="goBackToPath1()" class="btn btn-ghost">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø£ÙˆÙ„</button>
      </div>
    </div>
  `;
}

function retakeQuiz() {
  currentQuestionIndex = 0;
  currentScore = 0;
  showQuizQuestion();
}

function goToPath2() {
  showPath2();
}

// Path 2 Quiz Functions
function startPath2Quiz() {
  path2StudentName = document.getElementById('path2-student-name').value.trim();
  path2StudentClass = document.getElementById('path2-student-class').value.trim();
  
  if (!path2StudentName || !path2StudentClass) {
    showInlineMessage('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„ÙØµÙ„', 'error');
    return;
  }
  
  // Combine all questions and shuffle them
  path2AllQuestions = [
    ...path2GrammarQuestions,
    ...path2SentenceQuestions,
    ...path2VocabularyQuestions
  ];
  
  // Shuffle questions for variety
  path2AllQuestions = shuffleArray(path2AllQuestions);
  
  // Initialize quiz
  path2QuestionIndex = 0;
  path2Score = 0;
  
  showPath2Question();
}

function shuffleArray(array) {
  const shuffled = [...array];
  for (let i = shuffled.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
  }
  return shuffled;
}

function showPath2Question() {
  const question = path2AllQuestions[path2QuestionIndex];
  const progress = ((path2QuestionIndex + 1) / path2AllQuestions.length) * 100;
  const totalQuestions = path2AllQuestions.length;
  
  const content = document.getElementById('path2-quiz-section');
  content.innerHTML = `
    <h2 style="text-align:center;font-size:1.7rem;margin:30px 0;color:#0891b2;">ğŸ¯ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ</h2>
    
    <!-- Progress Bar -->
    <div style="background:#f3f4f6;border-radius:10px;margin:20px auto;max-width:600px;height:20px;overflow:hidden;">
      <div style="background:linear-gradient(90deg,#0891b2,#0e7490);height:100%;width:${progress}%;transition:width 0.5s ease;border-radius:10px;"></div>
    </div>
    <p style="text-align:center;color:#6b7280;margin-bottom:30px;">Ø§Ù„Ø³Ø¤Ø§Ù„ ${path2QuestionIndex + 1} Ù…Ù† ${totalQuestions} (${Math.round(progress)}%)</p>
    
    <div style="background:white;padding:30px;border-radius:15px;box-shadow:0 6px 18px rgba(16,24,40,0.06);max-width:700px;margin:0 auto;">
      <div style="text-align:center;margin-bottom:25px;">
        <div style="background:${getQuestionTypeColor(question.type)};color:white;padding:8px 16px;border-radius:20px;display:inline-block;font-size:0.9rem;font-weight:600;margin-bottom:15px;">
          ${getQuestionTypeIcon(question.type)} ${question.category}
        </div>
        <h3 style="color:#0891b2;margin-bottom:20px;">${getQuestionTypeTitle(question.type)}</h3>
        
        <div style="background:#f0f9ff;padding:20px;border-radius:12px;margin-bottom:20px;">
          <p style="font-size:1.2rem;color:#374151;margin:0;font-weight:600;">${question.question}</p>
          ${question.arabic ? `<p style="color:#6b7280;margin:10px 0 0 0;font-size:1rem;">(${question.arabic})</p>` : ''}
        </div>
      </div>
      
      <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;margin-bottom:25px;">
        ${question.options.map((option, index) => `
          <button onclick="selectPath2Answer('${option.replace(/'/g, "\\'")}', ${index})" class="path2-quiz-option-btn" 
                  style="padding:20px;font-size:1.1rem;font-weight:600;background:#f0f9ff;color:#0e7490;border:3px solid #0891b2;border-radius:12px;cursor:pointer;transition:all 0.3s;box-shadow:0 2px 8px rgba(0,0,0,0.1);text-align:center;line-height:1.4;">
            ${option}
          </button>
        `).join('')}
      </div>
      
      <div id="path2-quiz-result" style="display:none;"></div>
    </div>
    
    <div style="text-align:center;margin-top:30px;">
      <button class="btn btn-ghost" onclick="goBackToPath2()">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ</button>
    </div>
  `;
}

function getQuestionTypeColor(type) {
  switch(type) {
    case 'grammar': return '#10b981';
    case 'sentence': return '#f59e0b';
    case 'vocabulary': return '#8b5cf6';
    default: return '#6b7280';
  }
}

function getQuestionTypeIcon(type) {
  switch(type) {
    case 'grammar': return 'ğŸ“š';
    case 'sentence': return 'ğŸ”—';
    case 'vocabulary': return 'ğŸ“–';
    default: return 'â“';
  }
}

function getQuestionTypeTitle(type) {
  switch(type) {
    case 'grammar': return 'ØªÙ…Ø±ÙŠÙ† Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯';
    case 'sentence': return 'ØªÙ…Ø±ÙŠÙ† ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø¬Ù…Ù„';
    case 'vocabulary': return 'ØªÙ…Ø±ÙŠÙ† Ø§Ù„Ù…ÙØ±Ø¯Ø§Øª';
    default: return 'ØªÙ…Ø±ÙŠÙ†';
  }
}

function selectPath2Answer(selectedAnswer, selectedIndex) {
  const question = path2AllQuestions[path2QuestionIndex];
  const buttons = document.querySelectorAll('.path2-quiz-option-btn');
  const resultDiv = document.getElementById('path2-quiz-result');
  const isCorrect = selectedAnswer === question.correct;
  
  // Disable all buttons
  buttons.forEach((btn, index) => {
    btn.disabled = true;
    btn.style.cursor = 'not-allowed';
    
    if (btn.textContent.trim() === question.correct) {
      btn.style.background = 'linear-gradient(90deg, #10b981, #059669)';
      btn.style.color = 'white';
      btn.style.borderColor = '#10b981';
    } else if (index === selectedIndex && !isCorrect) {
      btn.style.background = 'linear-gradient(90deg, #ef4444, #dc2626)';
      btn.style.color = 'white';
      btn.style.borderColor = '#ef4444';
    } else {
      btn.style.opacity = '0.5';
    }
  });
  
  if (isCorrect) {
    path2Score++;
  }
  
  resultDiv.style.display = 'block';
  
  if (isCorrect) {
    resultDiv.innerHTML = `
      <div style="background:#f0fdf4;border:2px solid #22c55e;border-radius:12px;padding:20px;text-align:center;margin-top:20px;">
        <div style="font-size:2rem;margin-bottom:10px;">ğŸ‰</div>
        <h4 style="color:#16a34a;margin-bottom:10px;">Ù…Ù…ØªØ§Ø²! Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©</h4>
        <p style="margin:10px 0;color:#374151;font-weight:500;">${question.explanation}</p>
        <button onclick="nextPath2Question()" class="btn btn-primary" style="background:linear-gradient(90deg,#10b981,#059669);margin-top:15px;">
          ${path2QuestionIndex < path2AllQuestions.length - 1 ? 'Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ â¡ï¸' : 'Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ğŸ†'}
        </button>
      </div>
    `;
  } else {
    resultDiv.innerHTML = `
      <div style="background:#fef2f2;border:2px solid #ef4444;border-radius:12px;padding:20px;text-align:center;margin-top:20px;">
        <div style="font-size:2rem;margin-bottom:10px;">âŒ</div>
        <h4 style="color:#dc2626;margin-bottom:10px;">Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© ØºÙŠØ± ØµØ­ÙŠØ­Ø©</h4>
        <p style="margin:0;color:#374151;">Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©: <strong>${question.correct}</strong></p>
        <p style="margin:10px 0;color:#374151;font-weight:500;">${question.explanation}</p>
        <button onclick="nextPath2Question()" class="btn btn-primary" style="background:linear-gradient(90deg,#0891b2,#0e7490);margin-top:15px;">
          ${path2QuestionIndex < path2AllQuestions.length - 1 ? 'Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ â¡ï¸' : 'Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ğŸ†'}
        </button>
      </div>
    `;
  }
}

function nextPath2Question() {
  path2QuestionIndex++;
  
  if (path2QuestionIndex >= path2AllQuestions.length) {
    showPath2Results();
  } else {
    showPath2Question();
  }
}

async function showPath2Results() {
  const totalQuestions = path2AllQuestions.length;
  const percentage = Math.round((path2Score / totalQuestions) * 100);
  const passed = percentage >= 80;
  
  // Count questions by type
  const grammarScore = path2AllQuestions.slice(0, path2QuestionIndex + 1)
    .filter((q, i) => q.type === 'grammar' && i < path2Score)
    .length;
  const sentenceScore = path2AllQuestions.slice(0, path2QuestionIndex + 1)
    .filter((q, i) => q.type === 'sentence' && i < path2Score)
    .length;
  const vocabularyScore = path2AllQuestions.slice(0, path2QuestionIndex + 1)
    .filter((q, i) => q.type === 'vocabulary' && i < path2Score)
    .length;
  
  // Save results to data SDK
  if (window.dataSdk && currentRecordCount < 999) {
    const resultData = {
      student_name: path2StudentName,
      student_class: path2StudentClass,
      test_type: 'Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ',
      score: path2Score,
      total_questions: totalQuestions,
      percentage: percentage,
      passed: passed,
      timestamp: new Date().toISOString()
    };
    
    const saveResult = await window.dataSdk.create(resultData);
    if (!saveResult.isOk) {
      console.error('Failed to save path 2 quiz results');
    }
  }
  
  const content = document.getElementById('path2-quiz-section');
  content.innerHTML = `
    <h2 style="text-align:center;font-size:1.7rem;margin:30px 0;color:#0891b2;">ğŸ† Ù†ØªØ§Ø¦Ø¬ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ</h2>
    
    <div style="background:white;padding:40px;border-radius:20px;box-shadow:0 8px 25px rgba(16,24,40,0.1);max-width:700px;margin:0 auto;text-align:center;">
      <div style="font-size:4rem;margin-bottom:20px;">${passed ? 'ğŸ‰' : 'ğŸ“š'}</div>
      
      <h3 style="color:${passed ? '#16a34a' : '#dc2626'};margin-bottom:20px;font-size:1.5rem;">
        ${passed ? 'Ù…Ø¨Ø±ÙˆÙƒ! Ù„Ù‚Ø¯ Ù†Ø¬Ø­Øª' : 'ØªØ­ØªØ§Ø¬ Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„ØªØ¯Ø±ÙŠØ¨'}
      </h3>
      
      <div style="background:${passed ? '#f0fdf4' : '#fef2f2'};padding:25px;border-radius:15px;margin:25px 0;border:2px solid ${passed ? '#22c55e' : '#ef4444'};">
        <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:20px;margin-bottom:20px;">
          <div>
            <p style="color:#6b7280;margin:0;font-size:0.9rem;">Ø§Ù„Ø§Ø³Ù…</p>
            <p style="color:#374151;margin:5px 0 0 0;font-weight:600;font-size:1.1rem;">${path2StudentName}</p>
          </div>
          <div>
            <p style="color:#6b7280;margin:0;font-size:0.9rem;">Ø§Ù„ÙØµÙ„</p>
            <p style="color:#374151;margin:5px 0 0 0;font-weight:600;font-size:1.1rem;">${path2StudentClass}</p>
          </div>
        </div>
        
        <div style="border-top:1px solid #e5e7eb;padding-top:20px;">
          <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:15px;text-align:center;margin-bottom:20px;">
            <div>
              <p style="color:#6b7280;margin:0;font-size:0.9rem;">Ø§Ù„Ù†ØªÙŠØ¬Ø©</p>
              <p style="color:#374151;margin:5px 0 0 0;font-weight:700;font-size:1.3rem;">${path2Score}/${totalQuestions}</p>
            </div>
            <div>
              <p style="color:#6b7280;margin:0;font-size:0.9rem;">Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ©</p>
              <p style="color:${passed ? '#16a34a' : '#dc2626'};margin:5px 0 0 0;font-weight:700;font-size:1.5rem;">${percentage}%</p>
            </div>
            <div>
              <p style="color:#6b7280;margin:0;font-size:0.9rem;">Ø§Ù„Ø­Ø§Ù„Ø©</p>
              <p style="color:${passed ? '#16a34a' : '#dc2626'};margin:5px 0 0 0;font-weight:700;font-size:1.1rem;">${passed ? 'Ù†Ø¬Ø­ âœ…' : 'Ù„Ù… ÙŠÙ†Ø¬Ø­ âŒ'}</p>
            </div>
          </div>
        </div>
      </div>
      
      <div style="background:#f8fafc;padding:20px;border-radius:12px;margin:25px 0;">
        <h4 style="color:#374151;margin-bottom:15px;">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø­Ø³Ø¨ Ø§Ù„Ù…Ø¬Ø§Ù„:</h4>
        <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:15px;text-align:center;">
          <div style="background:#f0fdf4;padding:15px;border-radius:8px;">
            <div style="font-size:1.5rem;margin-bottom:5px;">ğŸ“š</div>
            <p style="color:#6b7280;margin:0;font-size:0.8rem;">Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯</p>
            <p style="color:#10b981;margin:5px 0 0 0;font-weight:600;">${Math.round((path2AllQuestions.filter(q => q.type === 'grammar').length > 0 ? (grammarScore / path2AllQuestions.filter(q => q.type === 'grammar').length) * 100 : 0))}%</p>
          </div>
          <div style="background:#fffbeb;padding:15px;border-radius:8px;">
            <div style="font-size:1.5rem;margin-bottom:5px;">ğŸ”—</div>
            <p style="color:#6b7280;margin:0;font-size:0.8rem;">ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø¬Ù…Ù„</p>
            <p style="color:#f59e0b;margin:5px 0 0 0;font-weight:600;">${Math.round((path2AllQuestions.filter(q => q.type === 'sentence').length > 0 ? (sentenceScore / path2AllQuestions.filter(q => q.type === 'sentence').length) * 100 : 0))}%</p>
          </div>
          <div style="background:#f5f3ff;padding:15px;border-radius:8px;">
            <div style="font-size:1.5rem;margin-bottom:5px;">ğŸ“–</div>
            <p style="color:#6b7280;margin:0;font-size:0.8rem;">Ø§Ù„Ù…ÙØ±Ø¯Ø§Øª</p>
            <p style="color:#8b5cf6;margin:5px 0 0 0;font-weight:600;">${Math.round((path2AllQuestions.filter(q => q.type === 'vocabulary').length > 0 ? (vocabularyScore / path2AllQuestions.filter(q => q.type === 'vocabulary').length) * 100 : 0))}%</p>
          </div>
        </div>
      </div>
      
      <div style="margin-top:30px;">
        ${passed ? `
          <p style="color:#16a34a;margin-bottom:20px;font-weight:600;">ğŸ¯ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø«Ø§Ù„Ø«!</p>
          <button onclick="goToPath3()" class="btn btn-primary" style="background:linear-gradient(90deg,#10b981,#059669);margin-left:10px;">Ø§Ù†ØªÙ‚Ù„ Ù„Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø«Ø§Ù„Ø« ğŸš€</button>
        ` : `
          <p style="color:#dc2626;margin-bottom:20px;font-weight:600;">ğŸ“š ØªØ­ØªØ§Ø¬ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ 80% Ù„Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø«Ø§Ù„Ø«</p>
          <button onclick="retakePath2Quiz()" class="btn btn-primary" style="background:linear-gradient(90deg,#0891b2,#0e7490);margin-left:10px;">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ğŸ”„</button>
        `}
        <button onclick="goBackToPath2()" class="btn btn-ghost">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ</button>
      </div>
    </div>
  `;
}

function retakePath2Quiz() {
  path2QuestionIndex = 0;
  path2Score = 0;
  
  // Re-shuffle questions for variety
  path2AllQuestions = shuffleArray([
    ...path2GrammarQuestions,
    ...path2SentenceQuestions,
    ...path2VocabularyQuestions
  ]);
  
  showPath2Question();
}

function goToPath3() {
  showPath3();
}

// Path 3 Writing Test Functions
function startPath3Quiz() {
  path3StudentName = document.getElementById('path3-student-name').value.trim();
  path3StudentClass = document.getElementById('path3-student-class').value.trim();
  
  if (!path3StudentName || !path3StudentClass) {
    showInlineMessage('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„ÙØµÙ„', 'error');
    return;
  }
  
  // Hide student info and show writing test
  document.getElementById('path3-student-info').style.display = 'none';
  document.getElementById('path3-writing-test').style.display = 'block';
  
  // Reset analysis
  currentAnalysis = {
    length: 0,
    sentences: 0,
    connectors: 0,
    punctuation: 0,
    structure: 0,
    examples: 0,
    total: 0
  };
  
  updateLiveAnalysis();
}

function insertConnector(connector) {
  const textarea = document.getElementById('paragraph-input');
  const cursorPos = textarea.selectionStart;
  const textBefore = textarea.value.substring(0, cursorPos);
  const textAfter = textarea.value.substring(cursorPos);
  
  textarea.value = textBefore + connector + textAfter;
  textarea.focus();
  textarea.setSelectionRange(cursorPos + connector.length, cursorPos + connector.length);
  
  // Trigger analysis update
  analyzeWriting();
}

function analyzeWriting() {
  const text = document.getElementById('paragraph-input').value;
  
  if (!text.trim()) {
    // Reset analysis if no text
    currentAnalysis = {
      length: 0,
      sentences: 0,
      connectors: 0,
      punctuation: 0,
      structure: 0,
      examples: 0,
      total: 0
    };
    updateLiveAnalysis();
    return;
  }
  
  // Analyze different criteria
  currentAnalysis.length = analyzeParagraphLength(text);
  currentAnalysis.sentences = analyzeSentenceCount(text);
  currentAnalysis.connectors = analyzeConnectors(text);
  currentAnalysis.punctuation = analyzePunctuationAndGrammar(text);
  currentAnalysis.structure = analyzeParagraphStructure(text);
  currentAnalysis.examples = analyzeExamplesAndDetails(text);
  
  // Calculate total
  currentAnalysis.total = currentAnalysis.length + currentAnalysis.sentences + 
                         currentAnalysis.connectors + currentAnalysis.punctuation + 
                         currentAnalysis.structure + currentAnalysis.examples;
  
  updateLiveAnalysis();
}

function analyzeParagraphLength(text) {
  const words = text.trim().split(/\s+/).filter(word => word.length > 0);
  const wordCount = words.length;
  
  if (wordCount >= 100) return 15;
  if (wordCount >= 80) return 12;
  if (wordCount >= 60) return 10;
  if (wordCount >= 50) return 8;
  if (wordCount >= 40) return 6;
  if (wordCount >= 30) return 4;
  if (wordCount >= 20) return 2;
  return 1;
}

function analyzeSentenceCount(text) {
  const sentences = text.split(/[.!?]+/).filter(s => s.trim().length > 0);
  const sentenceCount = sentences.length;
  
  if (sentenceCount >= 8) return 15;
  if (sentenceCount >= 6) return 12;
  if (sentenceCount >= 5) return 10;
  if (sentenceCount >= 4) return 8;
  if (sentenceCount >= 3) return 6;
  if (sentenceCount >= 2) return 4;
  return 2;
}

function analyzeConnectors(text) {
  const connectors = [
    'first', 'second', 'third', 'also', 'however', 'finally', 'moreover',
    'furthermore', 'in addition', 'besides', 'therefore', 'consequently',
    'meanwhile', 'nevertheless', 'on the other hand', 'for example',
    'for instance', 'in conclusion', 'to sum up'
  ];
  
  const lowerText = text.toLowerCase();
  let connectorCount = 0;
  
  connectors.forEach(connector => {
    const regex = new RegExp('\\b' + connector.replace(/\s+/g, '\\s+') + '\\b', 'gi');
    const matches = lowerText.match(regex);
    if (matches) {
      connectorCount += matches.length;
    }
  });
  
  if (connectorCount >= 5) return 20;
  if (connectorCount >= 4) return 16;
  if (connectorCount >= 3) return 12;
  if (connectorCount >= 2) return 8;
  if (connectorCount >= 1) return 4;
  return 0;
}

function analyzePunctuationAndGrammar(text) {
  let score = 0;
  const maxScore = 25;
  
  // Check if paragraph starts with capital letter
  if (text.trim().length > 0 && /^[A-Z]/.test(text.trim())) {
    score += 5;
  }
  
  // Check for proper sentence endings
  const sentences = text.split(/[.!?]+/).filter(s => s.trim().length > 0);
  let properEndings = 0;
  
  sentences.forEach((sentence, index) => {
    const trimmed = sentence.trim();
    if (trimmed.length > 0) {
      // Check if next sentence starts with capital (except for last sentence)
      if (index < sentences.length - 1) {
        const nextSentenceStart = sentences[index + 1].trim();
        if (nextSentenceStart.length > 0 && /^[A-Z]/.test(nextSentenceStart)) {
          properEndings++;
        }
      } else {
        // Last sentence should end with punctuation
        if (/[.!?]$/.test(text.trim())) {
          properEndings++;
        }
      }
    }
  });
  
  if (sentences.length > 0) {
    score += Math.round((properEndings / sentences.length) * 10);
  }
  
  // Check for commas after connectors
  const connectorsWithCommas = text.match(/\b(first|second|third|also|however|finally|moreover|furthermore|therefore|consequently|meanwhile|nevertheless),\s/gi);
  if (connectorsWithCommas) {
    score += Math.min(connectorsWithCommas.length * 2, 10);
  }
  
  return Math.min(score, maxScore);
}

function analyzeParagraphStructure(text) {
  const sentences = text.split(/[.!?]+/).filter(s => s.trim().length > 0);
  
  if (sentences.length < 3) return 3;
  
  let score = 0;
  
  // Check for topic sentence (introduction)
  const firstSentence = sentences[0].trim().toLowerCase();
  if (firstSentence.includes('friend') || firstSentence.includes('person') || 
      firstSentence.includes('amazing') || firstSentence.includes('wonderful') ||
      firstSentence.includes('best') || firstSentence.includes('special')) {
    score += 8;
  } else {
    score += 4;
  }
  
  // Check for concluding sentence
  const lastSentence = sentences[sentences.length - 1].trim().toLowerCase();
  if (lastSentence.includes('conclusion') || lastSentence.includes('finally') ||
      lastSentence.includes('overall') || lastSentence.includes('in summary') ||
      lastSentence.includes('that is why') || lastSentence.includes('lucky') ||
      lastSentence.includes('grateful')) {
    score += 7;
  } else {
    score += 3;
  }
  
  return Math.min(score, 15);
}

function analyzeExamplesAndDetails(text) {
  let score = 0;
  const lowerText = text.toLowerCase();
  
  // Look for descriptive words and examples
  const descriptiveWords = [
    'beautiful', 'kind', 'smart', 'funny', 'helpful', 'caring', 'generous',
    'talented', 'creative', 'patient', 'understanding', 'loyal', 'honest',
    'brave', 'confident', 'cheerful', 'optimistic', 'hardworking'
  ];
  
  const examplePhrases = [
    'for example', 'for instance', 'such as', 'like when', 'always',
    'never', 'often', 'sometimes', 'usually', 'every day', 'last week',
    'yesterday', 'once', 'remember when'
  ];
  
  // Count descriptive words
  let descriptiveCount = 0;
  descriptiveWords.forEach(word => {
    if (lowerText.includes(word)) descriptiveCount++;
  });
  
  // Count example phrases
  let exampleCount = 0;
  examplePhrases.forEach(phrase => {
    if (lowerText.includes(phrase)) exampleCount++;
  });
  
  // Calculate score
  score += Math.min(descriptiveCount * 2, 6);
  score += Math.min(exampleCount * 2, 4);
  
  return Math.min(score, 10);
}

function updateLiveAnalysis() {
  // Update individual scores
  document.querySelector('[data-criteria="length"] .score').textContent = `${currentAnalysis.length}/15`;
  document.querySelector('[data-criteria="sentences"] .score').textContent = `${currentAnalysis.sentences}/15`;
  document.querySelector('[data-criteria="connectors"] .score').textContent = `${currentAnalysis.connectors}/20`;
  document.querySelector('[data-criteria="punctuation"] .score').textContent = `${currentAnalysis.punctuation}/25`;
  document.querySelector('[data-criteria="structure"] .score').textContent = `${currentAnalysis.structure}/15`;
  document.querySelector('[data-criteria="examples"] .score').textContent = `${currentAnalysis.examples}/10`;
  
  // Update total score
  document.getElementById('total-score').textContent = `${currentAnalysis.total}/100`;
  document.getElementById('score-bar').style.width = `${currentAnalysis.total}%`;
  
  // Update live feedback
  updateLiveFeedback();
}

function updateLiveFeedback() {
  const feedbackDiv = document.getElementById('live-feedback');
  const text = document.getElementById('paragraph-input').value;
  
  if (!text.trim()) {
    feedbackDiv.innerHTML = 'ğŸ’¡ Ø§Ø¨Ø¯Ø¦ÙŠ Ø§Ù„ÙƒØªØ§Ø¨Ø© Ù„Ø±Ø¤ÙŠØ© Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø±...';
    return;
  }
  
  let feedback = [];
  
  // Length feedback
  const wordCount = text.trim().split(/\s+/).filter(word => word.length > 0).length;
  if (wordCount < 50) {
    feedback.push(`ğŸ“ Ø£Ø¶ÙŠÙÙŠ ${50 - wordCount} ÙƒÙ„Ù…Ø© Ø£Ø®Ø±Ù‰ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„`);
  }
  
  // Connectors feedback
  if (currentAnalysis.connectors < 8) {
    feedback.push('ğŸ”— Ø§Ø³ØªØ®Ø¯Ù…ÙŠ Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø±Ø¨Ø·');
  }
  
  // Punctuation feedback
  if (currentAnalysis.punctuation < 15) {
    feedback.push('âœï¸ ØªØ­Ù‚Ù‚ÙŠ Ù…Ù† Ø§Ù„ØªØ±Ù‚ÙŠÙ… ÙˆØ§Ù„Ø£Ø­Ø±Ù Ø§Ù„ÙƒØ¨ÙŠØ±Ø©');
  }
  
  // Structure feedback
  if (currentAnalysis.structure < 10) {
    feedback.push('ğŸ—ï¸ Ø£Ø¶ÙŠÙÙŠ Ø¬Ù…Ù„Ø© Ø®ØªØ§Ù…ÙŠØ© Ù‚ÙˆÙŠØ©');
  }
  
  if (feedback.length === 0) {
    feedbackDiv.innerHTML = 'ğŸ‰ Ù…Ù…ØªØ§Ø²! Ø§Ø³ØªÙ…Ø±ÙŠ ÙÙŠ Ø§Ù„ÙƒØªØ§Ø¨Ø© Ø¨Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø±Ø§Ø¦Ø¹!';
    feedbackDiv.style.background = '#f0fdf4';
    feedbackDiv.style.borderLeftColor = '#22c55e';
    feedbackDiv.style.color = '#16a34a';
  } else {
    feedbackDiv.innerHTML = 'ğŸ’¡ ' + feedback.join(' â€¢ ');
    feedbackDiv.style.background = '#fffbeb';
    feedbackDiv.style.borderLeftColor = '#f59e0b';
    feedbackDiv.style.color = '#92400e';
  }
}

async function submitParagraph() {
  const text = document.getElementById('paragraph-input').value.trim();
  
  if (!text) {
    showInlineMessage('ÙŠØ±Ø¬Ù‰ ÙƒØªØ§Ø¨Ø© Ø§Ù„ÙÙ‚Ø±Ø© Ø£ÙˆÙ„Ø§Ù‹', 'error');
    return;
  }
  
  if (text.split(/\s+/).length < 50) {
    showInlineMessage('Ø§Ù„ÙÙ‚Ø±Ø© Ù‚ØµÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹ØŒ ÙŠØ±Ø¬Ù‰ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ù…Ø­ØªÙˆÙ‰', 'error');
    return;
  }
  
  // Final analysis
  analyzeWriting();
  
  const finalScore = currentAnalysis.total;
  const percentage = finalScore;
  const passed = percentage >= 70;
  const excellent = percentage >= 90;
  
  // Save to data SDK - always include paragraph text and analysis
  if (window.dataSdk && currentRecordCount < 999) {
    const resultData = {
      student_name: path3StudentName,
      student_class: path3StudentClass,
      test_type: 'Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø«Ø§Ù„Ø« - ÙƒØªØ§Ø¨Ø© Ø§Ù„ÙÙ‚Ø±Ø©',
      score: finalScore,
      total_questions: 100,
      percentage: percentage,
      passed: passed,
      timestamp: new Date().toISOString(),
      written_paragraph: text,
      paragraph_analysis: JSON.stringify({
        length_score: currentAnalysis.length,
        sentences_score: currentAnalysis.sentences,
        connectors_score: currentAnalysis.connectors,
        punctuation_score: currentAnalysis.punctuation,
        structure_score: currentAnalysis.structure,
        examples_score: currentAnalysis.examples,
        word_count: text.trim().split(/\s+/).filter(word => word.length > 0).length,
        sentence_count: text.split(/[.!?]+/).filter(s => s.trim().length > 0).length
      })
    };
    
    const saveResult = await window.dataSdk.create(resultData);
    if (!saveResult.isOk) {
      console.error('Failed to save writing test results');
    }
  }
  
  // Hide writing test and show results
  document.getElementById('path3-writing-test').style.display = 'none';
  showPath3Results(finalScore, percentage, passed, excellent, text);
}

function showPath3Results(finalScore, percentage, passed, excellent, writtenText) {
  const resultsDiv = document.getElementById('path3-results');
  resultsDiv.style.display = 'block';
  
  // Generate detailed feedback
  const detailedFeedback = generateDetailedFeedback(writtenText, currentAnalysis);
  
  if (excellent) {
    // Special celebration for 90%+
    resultsDiv.innerHTML = `
      <div style="background:linear-gradient(135deg,#f0fdf4,#dcfce7);padding:40px;border-radius:20px;box-shadow:0 8px 25px rgba(16,24,40,0.1);max-width:800px;margin:0 auto;text-align:center;border:3px solid #22c55e;">
        
        <!-- Celebration Animation -->
        <div style="font-size:5rem;margin-bottom:20px;animation:bounce 1s infinite;">ğŸ†</div>
        
        <h2 style="color:#16a34a;margin-bottom:20px;font-size:2rem;">Ù…Ø¨Ø±ÙˆÙƒ! Ø¥Ù†Ø¬Ø§Ø² Ø§Ø³ØªØ«Ù†Ø§Ø¦ÙŠ! ğŸ‰</h2>
        
        <div style="background:white;padding:30px;border-radius:15px;margin:25px 0;box-shadow:0 4px 12px rgba(0,0,0,0.1);">
          <h3 style="color:#16a34a;margin-bottom:20px;">ğŸŒŸ Ø´Ù‡Ø§Ø¯Ø© Ø¥ØªÙ‚Ø§Ù† ÙƒØªØ§Ø¨Ø© Ø§Ù„ÙÙ‚Ø±Ø© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© ğŸŒŸ</h3>
          
          <div style="border:3px solid #22c55e;padding:25px;border-radius:12px;background:linear-gradient(135deg,#f0fdf4,#ecfdf5);">
            <p style="font-size:1.2rem;color:#374151;margin-bottom:15px;font-weight:600;">
              Ù†Ø´Ù‡Ø¯ Ø¨Ø£Ù† Ø§Ù„Ø·Ø§Ù„Ø¨Ø© Ø§Ù„Ù…ØªÙ…ÙŠØ²Ø©
            </p>
            <h4 style="color:#16a34a;font-size:1.8rem;margin:15px 0;text-decoration:underline;">
              ${path3StudentName}
            </h4>
            <p style="color:#374151;margin-bottom:15px;">
              Ù…Ù† Ø§Ù„ÙØµÙ„ <strong>${path3StudentClass}</strong>
            </p>
            <p style="color:#374151;margin-bottom:20px;line-height:1.8;">
              Ù‚Ø¯ Ø£ØªÙ‚Ù†Øª Ù…Ù‡Ø§Ø±Ø§Øª ÙƒØªØ§Ø¨Ø© Ø§Ù„ÙÙ‚Ø±Ø© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø¨Ø§Ù…ØªÙŠØ§Ø²<br>
              ÙˆØ­ØµÙ„Øª Ø¹Ù„Ù‰ Ø¯Ø±Ø¬Ø© <strong style="color:#16a34a;font-size:1.3rem;">${percentage}%</strong><br>
              ÙÙŠ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø«Ø§Ù„Ø«
            </p>
            
            <div style="margin:20px 0;padding:15px;background:rgba(34,197,94,0.1);border-radius:8px;">
              <p style="color:#16a34a;margin:0;font-weight:600;">
                ğŸ¯ ØªÙÙˆÙ‚Øª ÙÙŠ Ø¬Ù…ÙŠØ¹ Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„ØªÙ‚ÙŠÙŠÙ…:<br>
                Ø§Ù„ØªØ±Ù‚ÙŠÙ… ÙˆØ§Ù„Ù‚ÙˆØ§Ø¹Ø¯ â€¢ Ø¨Ù†ÙŠØ© Ø§Ù„ÙÙ‚Ø±Ø© â€¢ ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø±Ø¨Ø· â€¢ Ø§Ù„Ø£Ù…Ø«Ù„Ø© ÙˆØ§Ù„ØªÙØ§ØµÙŠÙ„
              </p>
            </div>
            
            <p style="color:#6b7280;font-size:0.9rem;margin-top:20px;">
              ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²: ${new Date().toLocaleDateString('ar-SA')}
            </p>
          </div>
        </div>
        
        ${detailedFeedback}
        
        <div style="margin-top:30px;">
          <p style="color:#16a34a;font-size:1.1rem;font-weight:600;margin-bottom:20px;">
            ğŸŒŸ Ù„Ù‚Ø¯ Ø£Ø«Ø¨ØªØª ØªÙÙˆÙ‚Ùƒ ÙÙŠ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©! Ø§Ø³ØªÙ…Ø±ÙŠ ÙÙŠ Ø§Ù„ØªÙ…ÙŠØ²! ğŸŒŸ
          </p>
          <button onclick="restartPath3Test()" class="btn btn-primary" style="background:linear-gradient(90deg,#16a34a,#15803d);margin-left:10px;">âœï¸ ÙƒØªØ§Ø¨Ø© ÙÙ‚Ø±Ø© Ø¬Ø¯ÙŠØ¯Ø©</button>
          <button onclick="goBackToPath3()" class="btn btn-ghost">ğŸ  Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø«Ø§Ù„Ø«</button>
        </div>
      </div>
    `;
  } else {
    // Regular results for other scores
    resultsDiv.innerHTML = `
      <div style="background:white;padding:40px;border-radius:20px;box-shadow:0 8px 25px rgba(16,24,40,0.1);max-width:800px;margin:0 auto;text-align:center;">
        <div style="font-size:4rem;margin-bottom:20px;">${passed ? 'ğŸ‰' : 'ğŸ“š'}</div>
        
        <h3 style="color:${passed ? '#16a34a' : '#dc2626'};margin-bottom:20px;font-size:1.5rem;">
          ${passed ? 'Ù…Ø¨Ø±ÙˆÙƒ! Ù„Ù‚Ø¯ Ù†Ø¬Ø­Øª ÙÙŠ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ÙƒØªØ§Ø¨Ø©' : 'ØªØ­ØªØ§Ø¬ Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„ØªØ¯Ø±ÙŠØ¨'}
        </h3>
        
        <div style="background:${passed ? '#f0fdf4' : '#fef2f2'};padding:25px;border-radius:15px;margin:25px 0;border:2px solid ${passed ? '#22c55e' : '#ef4444'};">
          <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:20px;margin-bottom:20px;">
            <div>
              <p style="color:#6b7280;margin:0;font-size:0.9rem;">Ø§Ù„Ø§Ø³Ù…</p>
              <p style="color:#374151;margin:5px 0 0 0;font-weight:600;font-size:1.1rem;">${path3StudentName}</p>
            </div>
            <div>
              <p style="color:#6b7280;margin:0;font-size:0.9rem;">Ø§Ù„ÙØµÙ„</p>
              <p style="color:#374151;margin:5px 0 0 0;font-weight:600;font-size:1.1rem;">${path3StudentClass}</p>
            </div>
          </div>
          
          <div style="border-top:1px solid #e5e7eb;padding-top:20px;">
            <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:15px;text-align:center;">
              <div>
                <p style="color:#6b7280;margin:0;font-size:0.9rem;">Ø§Ù„Ù†ØªÙŠØ¬Ø©</p>
                <p style="color:#374151;margin:5px 0 0 0;font-weight:700;font-size:1.3rem;">${finalScore}/100</p>
              </div>
              <div>
                <p style="color:#6b7280;margin:0;font-size:0.9rem;">Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ©</p>
                <p style="color:${passed ? '#16a34a' : '#dc2626'};margin:5px 0 0 0;font-weight:700;font-size:1.5rem;">${percentage}%</p>
              </div>
              <div>
                <p style="color:#6b7280;margin:0;font-size:0.9rem;">Ø§Ù„Ø­Ø§Ù„Ø©</p>
                <p style="color:${passed ? '#16a34a' : '#dc2626'};margin:5px 0 0 0;font-weight:700;font-size:1.1rem;">${passed ? 'Ù†Ø¬Ø­ âœ…' : 'Ù„Ù… ÙŠÙ†Ø¬Ø­ âŒ'}</p>
              </div>
            </div>
          </div>
        </div>
        
        ${detailedFeedback}
        
        <div style="margin-top:30px;">
          ${passed ? `
            <p style="color:#16a34a;margin-bottom:20px;font-weight:600;">ğŸ¯ Ø£Ø­Ø³Ù†Øª! Ù„Ù‚Ø¯ Ø£ØªÙ‚Ù†Øª Ù…Ù‡Ø§Ø±Ø§Øª ÙƒØªØ§Ø¨Ø© Ø§Ù„ÙÙ‚Ø±Ø© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©!</p>
          ` : `
            <p style="color:#dc2626;margin-bottom:20px;font-weight:600;">ğŸ“š ØªØ­ØªØ§Ø¬ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ 70% Ù„Ù„Ù†Ø¬Ø§Ø­ ÙÙŠ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</p>
          `}
          <button onclick="restartPath3Test()" class="btn btn-primary" style="background:linear-gradient(90deg,#0891b2,#0e7490);margin-left:10px;">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</button>
          <button onclick="goBackToPath3()" class="btn btn-ghost">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø«Ø§Ù„Ø«</button>
        </div>
      </div>
    `;
  }
}

function restartPath3Test() {
  // Reset everything
  document.getElementById('path3-results').style.display = 'none';
  document.getElementById('path3-student-info').style.display = 'block';
  document.getElementById('path3-writing-test').style.display = 'none';
  
  // Clear form
  document.getElementById('path3-student-name').value = '';
  document.getElementById('path3-student-class').value = '';
  document.getElementById('paragraph-input').value = '';
  
  // Reset analysis
  currentAnalysis = {
    length: 0,
    sentences: 0,
    connectors: 0,
    punctuation: 0,
    structure: 0,
    examples: 0,
    total: 0
  };
}

// Sentence Builder Exercise Functions
function showExerciseType(type) {
  currentExerciseType = type;
  currentExerciseIndex = 0;
  const content = document.getElementById('exercise-content');
  content.style.display = 'block';
  
  if (type === 'drag-drop') {
    showDragDropExercise();
  } else if (type === 'fill-blanks') {
    showFillBlanksExercise();
  } else if (type === 'translation') {
    showTranslationExercise();
  } else if (type === 'word-order') {
    showWordOrderExercise();
  }
}

// Drag and Drop Exercise Data
const dragDropExercises = [
  {
    instruction: 'Ø±ØªØ¨ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ù„ØªÙƒÙˆÙŠÙ† Ø¬Ù…Ù„Ø© ØµØ­ÙŠØ­Ø©:',
    words: ['I', 'am', 'a', 'student'],
    correctSentence: 'I am a student',
    arabic: 'Ø£Ù†Ø§ Ø·Ø§Ù„Ø¨Ø©'
  },
  {
    instruction: 'Ø±ØªØ¨ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ù„ØªÙƒÙˆÙŠÙ† Ø¬Ù…Ù„Ø© ØµØ­ÙŠØ­Ø©:',
    words: ['She', 'likes', 'to', 'read'],
    correctSentence: 'She likes to read',
    arabic: 'Ù‡ÙŠ ØªØ­Ø¨ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©'
  },
  {
    instruction: 'Ø±ØªØ¨ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ù„ØªÙƒÙˆÙŠÙ† Ø¬Ù…Ù„Ø© ØµØ­ÙŠØ­Ø©:',
    words: ['We', 'go', 'to', 'school'],
    correctSentence: 'We go to school',
    arabic: 'Ù†Ø­Ù† Ù†Ø°Ù‡Ø¨ Ù„Ù„Ù…Ø¯Ø±Ø³Ø©'
  },
  {
    instruction: 'Ø±ØªØ¨ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ù„ØªÙƒÙˆÙŠÙ† Ø¬Ù…Ù„Ø© ØµØ­ÙŠØ­Ø©:',
    words: ['The', 'cat', 'is', 'sleeping'],
    correctSentence: 'The cat is sleeping',
    arabic: 'Ø§Ù„Ù‚Ø·Ø© Ù†Ø§Ø¦Ù…Ø©'
  },
  {
    instruction: 'Ø±ØªØ¨ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ù„ØªÙƒÙˆÙŠÙ† Ø¬Ù…Ù„Ø© ØµØ­ÙŠØ­Ø©:',
    words: ['My', 'friend', 'plays', 'football'],
    correctSentence: 'My friend plays football',
    arabic: 'ØµØ¯ÙŠÙ‚ÙŠ ÙŠÙ„Ø¹Ø¨ ÙƒØ±Ø© Ø§Ù„Ù‚Ø¯Ù…'
  }
];

function showDragDropExercise() {
  const exercise = dragDropExercises[currentExerciseIndex];
  const content = document.getElementById('exercise-content');
  
  content.innerHTML = `
    <div style="text-align:center;margin-bottom:25px;">
      <h3 style="color:#3b82f6;margin-bottom:15px;">ğŸ§© ØªÙ…Ø±ÙŠÙ† Ø§Ù„Ø³Ø­Ø¨ ÙˆØ§Ù„Ø¥ÙÙ„Ø§Øª</h3>
      <div style="background:#f0f9ff;padding:15px;border-radius:8px;margin-bottom:20px;">
        <p style="font-size:1.1rem;color:#1e40af;margin:0;font-weight:600;">${exercise.instruction}</p>
        <p style="color:#6b7280;margin:5px 0 0 0;font-size:0.9rem;">(${exercise.arabic})</p>
      </div>
    </div>
    
    <div class="drag-drop-container">
      <div style="margin-bottom:20px;">
        <h4 style="color:#374151;margin-bottom:10px;">ğŸ“¦ Ø¨Ù†Ùƒ Ø§Ù„ÙƒÙ„Ù…Ø§Øª:</h4>
        <div class="word-bank" id="word-bank">
          ${exercise.words.map(word => `
            <span class="draggable-word" draggable="true" data-word="${word}">${word}</span>
          `).join('')}
        </div>
      </div>
      
      <div style="margin-bottom:20px;">
        <h4 style="color:#374151;margin-bottom:10px;">ğŸ¯ Ù…Ù†Ø·Ù‚Ø© ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø¬Ù…Ù„Ø©:</h4>
        <div class="drop-zone" id="drop-zone">
          <p style="color:#9ca3af;text-align:center;margin:0;font-style:italic;">Ø§Ø³Ø­Ø¨ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ù‡Ù†Ø§ Ù„ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø¬Ù…Ù„Ø©</p>
        </div>
      </div>
      
      <div id="sentence-result" style="display:none;"></div>
      
      <div style="text-align:center;margin-top:20px;">
        <button onclick="checkDragDropAnswer()" class="btn btn-primary" style="background:linear-gradient(90deg,#3b82f6,#2563eb);margin-left:10px;">âœ… ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©</button>
        <button onclick="resetDragDrop()" class="btn btn-ghost">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†</button>
        <button onclick="nextDragDropExercise()" id="next-drag-btn" class="btn btn-primary" style="background:linear-gradient(90deg,#10b981,#059669);display:none;">Ø§Ù„ØªÙ…Ø±ÙŠÙ† Ø§Ù„ØªØ§Ù„ÙŠ â¡ï¸</button>
      </div>
    </div>
  `;
  
  setupDragAndDrop();
}

function setupDragAndDrop() {
  const draggableWords = document.querySelectorAll('.draggable-word');
  const dropZone = document.getElementById('drop-zone');
  
  draggableWords.forEach(word => {
    word.addEventListener('dragstart', handleDragStart);
    word.addEventListener('dragend', handleDragEnd);
  });
  
  dropZone.addEventListener('dragover', handleDragOver);
  dropZone.addEventListener('drop', handleDrop);
  dropZone.addEventListener('dragenter', handleDragEnter);
  dropZone.addEventListener('dragleave', handleDragLeave);
}

let draggedElement = null;

function handleDragStart(e) {
  draggedElement = e.target;
  e.target.classList.add('dragging');
  e.dataTransfer.effectAllowed = 'move';
  e.dataTransfer.setData('text/html', e.target.outerHTML);
}

function handleDragEnd(e) {
  e.target.classList.remove('dragging');
}

function handleDragOver(e) {
  e.preventDefault();
  e.dataTransfer.dropEffect = 'move';
}

function handleDragEnter(e) {
  e.preventDefault();
  e.target.classList.add('drag-over');
}

function handleDragLeave(e) {
  e.target.classList.remove('drag-over');
}

function handleDrop(e) {
  e.preventDefault();
  e.target.classList.remove('drag-over');
  
  if (draggedElement) {
    const dropZone = document.getElementById('drop-zone');
    const placeholder = dropZone.querySelector('p');
    
    if (placeholder) {
      placeholder.style.display = 'none';
    }
    
    // Create dropped word element
    const droppedWord = document.createElement('span');
    droppedWord.className = 'dropped-word';
    droppedWord.textContent = draggedElement.dataset.word;
    droppedWord.dataset.word = draggedElement.dataset.word;
    
    // Add click to remove functionality
    droppedWord.addEventListener('click', function() {
      this.remove();
      
      // Return word to bank
      const wordBank = document.getElementById('word-bank');
      const newWord = document.createElement('span');
      newWord.className = 'draggable-word';
      newWord.draggable = true;
      newWord.textContent = this.dataset.word;
      newWord.dataset.word = this.dataset.word;
      
      // Re-add event listeners
      newWord.addEventListener('dragstart', handleDragStart);
      newWord.addEventListener('dragend', handleDragEnd);
      
      wordBank.appendChild(newWord);
      
      // Show placeholder if no words left
      if (dropZone.children.length === 0) {
        const placeholder = document.createElement('p');
        placeholder.style.cssText = 'color:#9ca3af;text-align:center;margin:0;font-style:italic;';
        placeholder.textContent = 'Ø§Ø³Ø­Ø¨ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ù‡Ù†Ø§ Ù„ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø¬Ù…Ù„Ø©';
        dropZone.appendChild(placeholder);
      }
    });
    
    dropZone.appendChild(droppedWord);
    
    // Remove from word bank
    draggedElement.remove();
    draggedElement = null;
  }
}

function checkDragDropAnswer() {
  const dropZone = document.getElementById('drop-zone');
  const droppedWords = Array.from(dropZone.querySelectorAll('.dropped-word'));
  const userSentence = droppedWords.map(word => word.textContent).join(' ');
  const exercise = dragDropExercises[currentExerciseIndex];
  
  const resultDiv = document.getElementById('sentence-result');
  resultDiv.style.display = 'block';
  
  if (userSentence === exercise.correctSentence) {
    resultDiv.className = 'sentence-result correct';
    resultDiv.innerHTML = `
      <div style="font-size:2rem;margin-bottom:10px;">ğŸ‰</div>
      <h4 style="color:#16a34a;margin-bottom:10px;">Ù…Ù…ØªØ§Ø²! Ø§Ù„Ø¬Ù…Ù„Ø© ØµØ­ÙŠØ­Ø©</h4>
      <p style="margin:0;color:#374151;font-weight:600;">"${userSentence}"</p>
      <p style="margin:5px 0 0 0;color:#6b7280;">${exercise.arabic}</p>
    `;
    
    // Speak the correct sentence
    if ('speechSynthesis' in window) {
      setTimeout(() => {
        const utterance = new SpeechSynthesisUtterance(userSentence);
        utterance.lang = 'en-US';
        utterance.rate = 0.7;
        speechSynthesis.speak(utterance);
      }, 500);
    }
    
    document.getElementById('next-drag-btn').style.display = 'inline-block';
  } else {
    resultDiv.className = 'sentence-result incorrect';
    resultDiv.innerHTML = `
      <div style="font-size:2rem;margin-bottom:10px;">âŒ</div>
      <h4 style="color:#dc2626;margin-bottom:10px;">Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰</h4>
      <p style="margin:0;color:#374151;">Ø¬Ù…Ù„ØªÙƒ: "${userSentence}"</p>
      <p style="margin:5px 0 0 0;color:#6b7280;">Ø§Ù„Ø¬Ù…Ù„Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©: "${exercise.correctSentence}"</p>
    `;
  }
}

function resetDragDrop() {
  const exercise = dragDropExercises[currentExerciseIndex];
  const wordBank = document.getElementById('word-bank');
  const dropZone = document.getElementById('drop-zone');
  
  // Clear both areas
  wordBank.innerHTML = '';
  dropZone.innerHTML = '<p style="color:#9ca3af;text-align:center;margin:0;font-style:italic;">Ø§Ø³Ø­Ø¨ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ù‡Ù†Ø§ Ù„ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø¬Ù…Ù„Ø©</p>';
  
  // Re-add words to bank
  exercise.words.forEach(word => {
    const wordElement = document.createElement('span');
    wordElement.className = 'draggable-word';
    wordElement.draggable = true;
    wordElement.textContent = word;
    wordElement.dataset.word = word;
    wordBank.appendChild(wordElement);
  });
  
  // Re-setup drag and drop
  setupDragAndDrop();
  
  // Hide result
  document.getElementById('sentence-result').style.display = 'none';
  document.getElementById('next-drag-btn').style.display = 'none';
}

function nextDragDropExercise() {
  currentExerciseIndex++;
  
  if (currentExerciseIndex >= dragDropExercises.length) {
    showExerciseCompletion('drag-drop');
    return;
  }
  
  showDragDropExercise();
}

// Fill in the Blanks Exercise
const fillBlanksExercises = [
  {
    sentence: 'She ___ to school every day.',
    options: ['go', 'goes', 'going', 'went'],
    correct: 1,
    arabic: 'Ù‡ÙŠ ØªØ°Ù‡Ø¨ Ù„Ù„Ù…Ø¯Ø±Ø³Ø© ÙƒÙ„ ÙŠÙˆÙ…'
  },
  {
    sentence: 'I ___ my homework yesterday.',
    options: ['do', 'did', 'does', 'doing'],
    correct: 1,
    arabic: 'Ø£Ù†Ø¬Ø²Øª ÙˆØ§Ø¬Ø¨ÙŠ Ø£Ù…Ø³'
  },
  {
    sentence: 'They ___ playing football now.',
    options: ['is', 'am', 'are', 'was'],
    correct: 2,
    arabic: 'Ù‡Ù… ÙŠÙ„Ø¹Ø¨ÙˆÙ† ÙƒØ±Ø© Ø§Ù„Ù‚Ø¯Ù… Ø§Ù„Ø¢Ù†'
  },
  {
    sentence: 'My sister ___ very beautiful.',
    options: ['is', 'are', 'am', 'be'],
    correct: 0,
    arabic: 'Ø£Ø®ØªÙŠ Ø¬Ù…ÙŠÙ„Ø© Ø¬Ø¯Ø§Ù‹'
  },
  {
    sentence: 'We ___ to the park tomorrow.',
    options: ['go', 'went', 'will go', 'going'],
    correct: 2,
    arabic: 'Ø³Ù†Ø°Ù‡Ø¨ Ù„Ù„Ø­Ø¯ÙŠÙ‚Ø© ØºØ¯Ø§Ù‹'
  }
];

function showFillBlanksExercise() {
  const exercise = fillBlanksExercises[currentExerciseIndex];
  const content = document.getElementById('exercise-content');
  
  content.innerHTML = `
    <div style="text-align:center;margin-bottom:25px;">
      <h3 style="color:#10b981;margin-bottom:15px;">âœï¸ ØªÙ…Ø±ÙŠÙ† Ø§Ù…Ù„Ø£ Ø§Ù„ÙØ±Ø§ØºØ§Øª</h3>
      <div style="background:#f0fdf4;padding:20px;border-radius:12px;margin-bottom:20px;">
        <p style="font-size:1.3rem;color:#374151;margin:0;font-weight:600;">${exercise.sentence}</p>
        <p style="color:#6b7280;margin:10px 0 0 0;font-size:1rem;">(${exercise.arabic})</p>
      </div>
    </div>
    
    <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:15px;margin-bottom:25px;">
      ${exercise.options.map((option, index) => `
        <button onclick="selectFillBlankAnswer(${index})" class="fill-blank-option" 
                style="padding:20px;font-size:1.2rem;font-weight:600;background:#f0fdf4;color:#065f46;border:3px solid #10b981;border-radius:12px;cursor:pointer;transition:all 0.3s;box-shadow:0 2px 8px rgba(0,0,0,0.1);">
          ${option}
        </button>
      `).join('')}
    </div>
    
    <div id="fill-blank-result" style="display:none;"></div>
    
    <div style="text-align:center;margin-top:20px;">
      <button onclick="resetFillBlank()" class="btn btn-ghost">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©</button>
      <button onclick="nextFillBlankExercise()" id="next-fill-btn" class="btn btn-primary" style="background:linear-gradient(90deg,#10b981,#059669);display:none;">Ø§Ù„ØªÙ…Ø±ÙŠÙ† Ø§Ù„ØªØ§Ù„ÙŠ â¡ï¸</button>
    </div>
  `;
}

function selectFillBlankAnswer(selectedIndex) {
  const exercise = fillBlanksExercises[currentExerciseIndex];
  const buttons = document.querySelectorAll('.fill-blank-option');
  const resultDiv = document.getElementById('fill-blank-result');
  const isCorrect = selectedIndex === exercise.correct;
  
  // Disable all buttons
  buttons.forEach((btn, index) => {
    btn.disabled = true;
    btn.style.cursor = 'not-allowed';
    
    if (index === exercise.correct) {
      btn.style.background = 'linear-gradient(90deg, #10b981, #059669)';
      btn.style.color = 'white';
      btn.style.borderColor = '#10b981';
    } else if (index === selectedIndex && !isCorrect) {
      btn.style.background = 'linear-gradient(90deg, #ef4444, #dc2626)';
      btn.style.color = 'white';
      btn.style.borderColor = '#ef4444';
    } else {
      btn.style.opacity = '0.5';
    }
  });
  
  resultDiv.style.display = 'block';
  
  if (isCorrect) {
    resultDiv.innerHTML = `
      <div style="background:#f0fdf4;border:2px solid #22c55e;border-radius:12px;padding:20px;text-align:center;">
        <div style="font-size:2rem;margin-bottom:10px;">ğŸ‰</div>
        <h4 style="color:#16a34a;margin-bottom:10px;">Ù…Ù…ØªØ§Ø²! Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©</h4>
        <p style="margin:0;color:#374151;font-weight:600;">"${exercise.sentence.replace('___', exercise.options[exercise.correct])}"</p>
      </div>
    `;
    
    // Speak the complete sentence
    if ('speechSynthesis' in window) {
      setTimeout(() => {
        const completeSentence = exercise.sentence.replace('___', exercise.options[exercise.correct]);
        const utterance = new SpeechSynthesisUtterance(completeSentence);
        utterance.lang = 'en-US';
        utterance.rate = 0.7;
        speechSynthesis.speak(utterance);
      }, 500);
    }
    
    document.getElementById('next-fill-btn').style.display = 'inline-block';
  } else {
    resultDiv.innerHTML = `
      <div style="background:#fef2f2;border:2px solid #ef4444;border-radius:12px;padding:20px;text-align:center;">
        <div style="font-size:2rem;margin-bottom:10px;">âŒ</div>
        <h4 style="color:#dc2626;margin-bottom:10px;">Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰</h4>
        <p style="margin:0;color:#374151;">Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©: <strong>${exercise.options[exercise.correct]}</strong></p>
      </div>
    `;
  }
}

function resetFillBlank() {
  showFillBlanksExercise();
}

function nextFillBlankExercise() {
  currentExerciseIndex++;
  
  if (currentExerciseIndex >= fillBlanksExercises.length) {
    showExerciseCompletion('fill-blanks');
    return;
  }
  
  showFillBlanksExercise();
}

// Translation Exercise
const translationExercises = [
  {
    arabic: 'Ø£Ù†Ø§ Ø£Ø­Ø¨ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©',
    english: 'I love reading',
    hints: ['I', 'love', 'reading']
  },
  {
    arabic: 'Ù‡ÙŠ ØªØ¯Ø±Ø³ ÙÙŠ Ø§Ù„Ø¬Ø§Ù…Ø¹Ø©',
    english: 'She studies at university',
    hints: ['She', 'studies', 'university']
  },
  {
    arabic: 'Ù†Ø­Ù† Ù†Ù„Ø¹Ø¨ ÙÙŠ Ø§Ù„Ø­Ø¯ÙŠÙ‚Ø©',
    english: 'We play in the garden',
    hints: ['We', 'play', 'garden']
  },
  {
    arabic: 'Ø§Ù„Ù‚Ø·Ø© ØªÙ†Ø§Ù… Ø¹Ù„Ù‰ Ø§Ù„Ø³Ø±ÙŠØ±',
    english: 'The cat sleeps on the bed',
    hints: ['cat', 'sleeps', 'bed']
  },
  {
    arabic: 'Ø£Ù…ÙŠ ØªØ·Ø¨Ø® Ø§Ù„Ø·Ø¹Ø§Ù… Ø§Ù„Ù„Ø°ÙŠØ°',
    english: 'My mother cooks delicious food',
    hints: ['mother', 'cooks', 'delicious']
  }
];

function showTranslationExercise() {
  const exercise = translationExercises[currentExerciseIndex];
  const content = document.getElementById('exercise-content');
  
  content.innerHTML = `
    <div style="text-align:center;margin-bottom:25px;">
      <h3 style="color:#f59e0b;margin-bottom:15px;">ğŸ”„ ØªÙ…Ø±ÙŠÙ† Ø§Ù„ØªØ±Ø¬Ù…Ø©</h3>
      <div style="background:#fffbeb;padding:20px;border-radius:12px;margin-bottom:20px;">
        <p style="font-size:1.3rem;color:#92400e;margin:0;font-weight:600;">${exercise.arabic}</p>
        <p style="color:#6b7280;margin:10px 0 0 0;font-size:0.9rem;">ØªØ±Ø¬Ù… Ù‡Ø°Ù‡ Ø§Ù„Ø¬Ù…Ù„Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©</p>
      </div>
    </div>
    
    <div style="margin-bottom:20px;">
      <h4 style="color:#374151;margin-bottom:10px;">ğŸ’¡ ÙƒÙ„Ù…Ø§Øª Ù…Ø³Ø§Ø¹Ø¯Ø©:</h4>
      <div style="display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin-bottom:20px;">
        ${exercise.hints.map(hint => `
          <span onclick="insertHint('${hint}')" style="background:#fef3c7;color:#92400e;padding:8px 12px;border-radius:6px;cursor:pointer;border:1px solid #fbbf24;transition:all 0.3s;" onmouseover="this.style.background='#fde68a'" onmouseout="this.style.background='#fef3c7'">
            ${hint}
          </span>
        `).join('')}
      </div>
    </div>
    
    <div style="margin-bottom:20px;">
      <textarea id="translation-input" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„ØªØ±Ø¬Ù…Ø© Ù‡Ù†Ø§..." 
                style="width:100%;padding:15px;border:2px solid #e5e7eb;border-radius:8px;font-size:1.1rem;min-height:100px;resize:vertical;font-family:'Times New Roman',serif;direction:ltr;text-align:left;"></textarea>
    </div>
    
    <div id="translation-result" style="display:none;"></div>
    
    <div style="text-align:center;margin-top:20px;">
      <button onclick="checkTranslation()" class="btn btn-primary" style="background:linear-gradient(90deg,#f59e0b,#d97706);margin-left:10px;">âœ… ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªØ±Ø¬Ù…Ø©</button>
      <button onclick="clearTranslation()" class="btn btn-ghost">ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„Ù†Øµ</button>
      <button onclick="speakTranslation()" class="btn btn-ghost">ğŸ”Š Ø§Ø³ØªÙ…Ø¹ Ù„Ù„Ù†Øµ</button>
      <button onclick="nextTranslationExercise()" id="next-translation-btn" class="btn btn-primary" style="background:linear-gradient(90deg,#10b981,#059669);display:none;">Ø§Ù„ØªÙ…Ø±ÙŠÙ† Ø§Ù„ØªØ§Ù„ÙŠ â¡ï¸</button>
    </div>
  `;
}

function insertHint(hint) {
  const textarea = document.getElementById('translation-input');
  const cursorPos = textarea.selectionStart;
  const textBefore = textarea.value.substring(0, cursorPos);
  const textAfter = textarea.value.substring(cursorPos);
  
  textarea.value = textBefore + hint + ' ' + textAfter;
  textarea.focus();
  textarea.setSelectionRange(cursorPos + hint.length + 1, cursorPos + hint.length + 1);
}

function checkTranslation() {
  const exercise = translationExercises[currentExerciseIndex];
  const userInput = document.getElementById('translation-input').value.trim().toLowerCase();
  const correctAnswer = exercise.english.toLowerCase();
  const resultDiv = document.getElementById('translation-result');
  
  // Simple similarity check
  const similarity = calculateSimilarity(userInput, correctAnswer);
  const isCorrect = similarity >= 0.7; // 70% similarity threshold
  
  resultDiv.style.display = 'block';
  
  if (isCorrect) {
    resultDiv.innerHTML = `
      <div style="background:#f0fdf4;border:2px solid #22c55e;border-radius:12px;padding:20px;text-align:center;">
        <div style="font-size:2rem;margin-bottom:10px;">ğŸ‰</div>
        <h4 style="color:#16a34a;margin-bottom:10px;">Ù…Ù…ØªØ§Ø²! ØªØ±Ø¬Ù…Ø© Ø±Ø§Ø¦Ø¹Ø©</h4>
        <p style="margin:0;color:#374151;"><strong>ØªØ±Ø¬Ù…ØªÙƒ:</strong> "${document.getElementById('translation-input').value}"</p>
        <p style="margin:5px 0 0 0;color:#6b7280;"><strong>Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„Ù…Ø«Ø§Ù„ÙŠØ©:</strong> "${exercise.english}"</p>
      </div>
    `;
    
    document.getElementById('next-translation-btn').style.display = 'inline-block';
  } else {
    resultDiv.innerHTML = `
      <div style="background:#fef2f2;border:2px solid #ef4444;border-radius:12px;padding:20px;text-align:center;">
        <div style="font-size:2rem;margin-bottom:10px;">ğŸ“</div>
        <h4 style="color:#dc2626;margin-bottom:10px;">Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰</h4>
        <p style="margin:0;color:#374151;"><strong>Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©:</strong> "${exercise.english}"</p>
        <p style="margin:10px 0 0 0;color:#6b7280;font-size:0.9rem;">ğŸ’¡ Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© ÙˆØ­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰</p>
      </div>
    `;
  }
}

function calculateSimilarity(str1, str2) {
  const words1 = str1.split(' ').filter(word => word.length > 0);
  const words2 = str2.split(' ').filter(word => word.length > 0);
  
  let matches = 0;
  words1.forEach(word => {
    if (words2.includes(word)) {
      matches++;
    }
  });
  
  return matches / Math.max(words1.length, words2.length);
}

function clearTranslation() {
  document.getElementById('translation-input').value = '';
  document.getElementById('translation-result').style.display = 'none';
}

function speakTranslation() {
  const text = document.getElementById('translation-input').value.trim();
  if (text && 'speechSynthesis' in window) {
    const utterance = new SpeechSynthesisUtterance(text);
    utterance.lang = 'en-US';
    utterance.rate = 0.7;
    speechSynthesis.speak(utterance);
  }
}

function nextTranslationExercise() {
  currentExerciseIndex++;
  
  if (currentExerciseIndex >= translationExercises.length) {
    showExerciseCompletion('translation');
    return;
  }
  
  showTranslationExercise();
}

// Word Order Exercise
const wordOrderExercises = [
  {
    instruction: 'Ø±ØªØ¨ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ© Ù„ØªÙƒÙˆÙŠÙ† Ø³Ø¤Ø§Ù„ ØµØ­ÙŠØ­:',
    words: ['What', 'is', 'your', 'name', '?'],
    correctSentence: 'What is your name?',
    arabic: 'Ù…Ø§ Ø§Ø³Ù…ÙƒØŸ'
  },
  {
    instruction: 'Ø±ØªØ¨ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ© Ù„ØªÙƒÙˆÙŠÙ† Ø¬Ù…Ù„Ø© ØµØ­ÙŠØ­Ø©:',
    words: ['The', 'book', 'on', 'is', 'table', 'the'],
    correctSentence: 'The book is on the table',
    arabic: 'Ø§Ù„ÙƒØªØ§Ø¨ Ø¹Ù„Ù‰ Ø§Ù„Ø·Ø§ÙˆÙ„Ø©'
  },
  {
    instruction: 'Ø±ØªØ¨ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ© Ù„ØªÙƒÙˆÙŠÙ† Ø¬Ù…Ù„Ø© ØµØ­ÙŠØ­Ø©:',
    words: ['I', 'every', 'morning', 'coffee', 'drink'],
    correctSentence: 'I drink coffee every morning',
    arabic: 'Ø£Ø´Ø±Ø¨ Ø§Ù„Ù‚Ù‡ÙˆØ© ÙƒÙ„ ØµØ¨Ø§Ø­'
  }
];

function showWordOrderExercise() {
  const exercise = wordOrderExercises[currentExerciseIndex];
  const content = document.getElementById('exercise-content');
  
  content.innerHTML = `
    <div style="text-align:center;margin-bottom:25px;">
      <h3 style="color:#8b5cf6;margin-bottom:15px;">ğŸ“ ØªÙ…Ø±ÙŠÙ† ØªØ±ØªÙŠØ¨ Ø§Ù„ÙƒÙ„Ù…Ø§Øª</h3>
      <div style="background:#f5f3ff;padding:20px;border-radius:12px;margin-bottom:20px;">
        <p style="font-size:1.1rem;color:#6b21a8;margin:0;font-weight:600;">${exercise.instruction}</p>
        <p style="color:#6b7280;margin:10px 0 0 0;font-size:0.9rem;">(${exercise.arabic})</p>
      </div>
    </div>
    
    <div style="margin-bottom:20px;">
      <h4 style="color:#374151;margin-bottom:10px;">ğŸ”¤ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©:</h4>
      <div style="display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin-bottom:20px;" id="available-words">
        ${exercise.words.map((word, index) => `
          <button onclick="addToSentence('${word}', ${index})" class="word-btn" data-index="${index}"
                  style="background:#f5f3ff;color:#6b21a8;padding:10px 15px;border:2px solid #8b5cf6;border-radius:8px;cursor:pointer;transition:all 0.3s;font-weight:600;">
            ${word}
          </button>
        `).join('')}
      </div>
    </div>
    
    <div style="margin-bottom:20px;">
      <h4 style="color:#374151;margin-bottom:10px;">âœï¸ Ø§Ù„Ø¬Ù…Ù„Ø© Ø§Ù„Ù…ÙƒÙˆÙ†Ø©:</h4>
      <div id="sentence-builder" style="background:#f8fafc;border:2px dashed #cbd5e1;border-radius:8px;padding:20px;min-height:60px;display:flex;flex-wrap:wrap;gap:8px;align-items:center;">
        <span style="color:#9ca3af;font-style:italic;">Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ù„Ø¥Ø¶Ø§ÙØªÙ‡Ø§ Ù‡Ù†Ø§</span>
      </div>
    </div>
    
    <div id="word-order-result" style="display:none;"></div>
    
    <div style="text-align:center;margin-top:20px;">
      <button onclick="checkWordOrder()" class="btn btn-primary" style="background:linear-gradient(90deg,#8b5cf6,#7c3aed);margin-left:10px;">âœ… ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªØ±ØªÙŠØ¨</button>
      <button onclick="clearSentence()" class="btn btn-ghost">ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„Ø¬Ù…Ù„Ø©</button>
      <button onclick="nextWordOrderExercise()" id="next-word-order-btn" class="btn btn-primary" style="background:linear-gradient(90deg,#10b981,#059669);display:none;">Ø§Ù„ØªÙ…Ø±ÙŠÙ† Ø§Ù„ØªØ§Ù„ÙŠ â¡ï¸</button>
    </div>
  `;
}

let selectedWords = [];

function addToSentence(word, index) {
  const button = document.querySelector(`[data-index="${index}"]`);
  const sentenceBuilder = document.getElementById('sentence-builder');
  
  if (button.disabled) return;
  
  // Add word to sentence
  selectedWords.push(word);
  
  // Disable button
  button.disabled = true;
  button.style.opacity = '0.5';
  button.style.cursor = 'not-allowed';
  
  // Update sentence display
  updateSentenceDisplay();
}

function updateSentenceDisplay() {
  const sentenceBuilder = document.getElementById('sentence-builder');
  
  if (selectedWords.length === 0) {
    sentenceBuilder.innerHTML = '<span style="color:#9ca3af;font-style:italic;">Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ù„Ø¥Ø¶Ø§ÙØªÙ‡Ø§ Ù‡Ù†Ø§</span>';
  } else {
    sentenceBuilder.innerHTML = selectedWords.map((word, index) => `
      <span onclick="removeFromSentence(${index})" 
            style="background:#8b5cf6;color:white;padding:8px 12px;border-radius:6px;cursor:pointer;transition:all 0.3s;" 
            onmouseover="this.style.background='#7c3aed'" 
            onmouseout="this.style.background='#8b5cf6'">
        ${word}
      </span>
    `).join('');
  }
}

function removeFromSentence(index) {
  const word = selectedWords[index];
  selectedWords.splice(index, 1);
  
  // Re-enable the button
  const exercise = wordOrderExercises[currentExerciseIndex];
  const wordIndex = exercise.words.indexOf(word);
  const button = document.querySelector(`[data-index="${wordIndex}"]`);
  button.disabled = false;
  button.style.opacity = '1';
  button.style.cursor = 'pointer';
  
  updateSentenceDisplay();
}

function clearSentence() {
  selectedWords = [];
  
  // Re-enable all buttons
  const buttons = document.querySelectorAll('.word-btn');
  buttons.forEach(button => {
    button.disabled = false;
    button.style.opacity = '1';
    button.style.cursor = 'pointer';
  });
  
  updateSentenceDisplay();
  document.getElementById('word-order-result').style.display = 'none';
}

function checkWordOrder() {
  const exercise = wordOrderExercises[currentExerciseIndex];
  const userSentence = selectedWords.join(' ');
  const resultDiv = document.getElementById('word-order-result');
  
  resultDiv.style.display = 'block';
  
  if (userSentence === exercise.correctSentence) {
    resultDiv.innerHTML = `
      <div style="background:#f0fdf4;border:2px solid #22c55e;border-radius:12px;padding:20px;text-align:center;">
        <div style="font-size:2rem;margin-bottom:10px;">ğŸ‰</div>
        <h4 style="color:#16a34a;margin-bottom:10px;">Ù…Ù…ØªØ§Ø²! Ø§Ù„ØªØ±ØªÙŠØ¨ ØµØ­ÙŠØ­</h4>
        <p style="margin:0;color:#374151;font-weight:600;">"${userSentence}"</p>
        <p style="margin:5px 0 0 0;color:#6b7280;">${exercise.arabic}</p>
      </div>
    `;
    
    document.getElementById('next-word-order-btn').style.display = 'inline-block';
  } else {
    resultDiv.innerHTML = `
      <div style="background:#fef2f2;border:2px solid #ef4444;border-radius:12px;padding:20px;text-align:center;">
        <div style="font-size:2rem;margin-bottom:10px;">âŒ</div>
        <h4 style="color:#dc2626;margin-bottom:10px;">Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰</h4>
        <p style="margin:0;color:#374151;"><strong>ØªØ±ØªÙŠØ¨Ùƒ:</strong> "${userSentence}"</p>
        <p style="margin:5px 0 0 0;color:#6b7280;"><strong>Ø§Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„ØµØ­ÙŠØ­:</strong> "${exercise.correctSentence}"</p>
      </div>
    `;
  }
}

function nextWordOrderExercise() {
  currentExerciseIndex++;
  
  if (currentExerciseIndex >= wordOrderExercises.length) {
    showExerciseCompletion('word-order');
    return;
  }
  
  selectedWords = [];
  showWordOrderExercise();
}

// Exercise Completion
function showExerciseCompletion(exerciseType) {
  const content = document.getElementById('exercise-content');
  const exerciseNames = {
    'drag-drop': 'Ø§Ù„Ø³Ø­Ø¨ ÙˆØ§Ù„Ø¥ÙÙ„Ø§Øª',
    'fill-blanks': 'Ø§Ù…Ù„Ø£ Ø§Ù„ÙØ±Ø§ØºØ§Øª',
    'translation': 'Ø§Ù„ØªØ±Ø¬Ù…Ø©',
    'word-order': 'ØªØ±ØªÙŠØ¨ Ø§Ù„ÙƒÙ„Ù…Ø§Øª'
  };
  
  content.innerHTML = `
    <div style="text-align:center;padding:40px;">
      <div style="font-size:4rem;margin-bottom:20px;">ğŸ†</div>
      <h3 style="color:#10b981;margin-bottom:15px;">Ø£Ø­Ø³Ù†Øª! Ø£ÙƒÙ…Ù„Øª ØªÙ…Ø§Ø±ÙŠÙ† ${exerciseNames[exerciseType]}</h3>
      <p style="color:#6b7280;margin-bottom:25px;">Ù„Ù‚Ø¯ ØªØ­Ø³Ù†Øª Ù…Ù‡Ø§Ø±Ø§ØªÙƒ ÙÙŠ ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø¬Ù…Ù„ Ø¨Ø´ÙƒÙ„ Ø±Ø§Ø¦Ø¹!</p>
      <div style="display:flex;gap:15px;justify-content:center;flex-wrap:wrap;">
        <button onclick="showExerciseType('${exerciseType}')" class="btn btn-primary" style="background:linear-gradient(90deg,#10b981,#059669);">ğŸ”„ Ø§Ø¨Ø¯Ø£ Ù…Ù† Ø¬Ø¯ÙŠØ¯</button>
        <button onclick="showSentenceBuilder()" class="btn btn-ghost">ğŸ  Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ†</button>
      </div>
    </div>
  `;
}

// Grammar Lessons Data
const grammarLessons = {
  'articles': {
    title: 'Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØ¹Ø±ÙŠÙ ÙˆØ§Ù„ØªÙ†ÙƒÙŠØ±',
    icon: 'ğŸ“',
    color: '#3b82f6',
    content: {
      explanation: `
        <h4 style="color:#1e40af;margin-bottom:15px;">ğŸ“š Ù…Ø§ Ù‡ÙŠ Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØ¹Ø±ÙŠÙ ÙˆØ§Ù„ØªÙ†ÙƒÙŠØ±ØŸ</h4>
        <p style="line-height:1.8;margin-bottom:20px;">Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØ¹Ø±ÙŠÙ ÙˆØ§Ù„ØªÙ†ÙƒÙŠØ± Ù‡ÙŠ ÙƒÙ„Ù…Ø§Øª ØµØºÙŠØ±Ø© Ù†Ø¶Ø¹Ù‡Ø§ Ù‚Ø¨Ù„ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ù„ØªÙˆØ¶ÙŠØ­ Ù…Ø§ Ø¥Ø°Ø§ ÙƒÙ†Ø§ Ù†ØªØ­Ø¯Ø« Ø¹Ù† Ø´ÙŠØ¡ Ù…Ø­Ø¯Ø¯ Ø£Ù… Ø¹Ø§Ù….</p>
        
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:15px;margin:20px 0;">
          <div style="background:#f0f9ff;padding:15px;border-radius:8px;border-right:4px solid #3b82f6;">
            <h5 style="color:#1e40af;margin-bottom:10px;">A / An (Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªÙ†ÙƒÙŠØ±)</h5>
            <p style="margin:0;font-size:0.9rem;line-height:1.6;">Ù†Ø³ØªØ®Ø¯Ù…Ù‡Ø§ Ù…Ø¹ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù…ÙØ±Ø¯Ø© ØºÙŠØ± Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©</p>
          </div>
          <div style="background:#f0f9ff;padding:15px;border-radius:8px;border-right:4px solid #3b82f6;">
            <h5 style="color:#1e40af;margin-bottom:10px;">The (Ø£Ø¯Ø§Ø© Ø§Ù„ØªØ¹Ø±ÙŠÙ)</h5>
            <p style="margin:0;font-size:0.9rem;line-height:1.6;">Ù†Ø³ØªØ®Ø¯Ù…Ù‡Ø§ Ù…Ø¹ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©</p>
          </div>
        </div>
      `,
      rules: [
        {
          title: 'Ù…ØªÙ‰ Ù†Ø³ØªØ®Ø¯Ù… AØŸ',
          rule: 'Ù†Ø³ØªØ®Ø¯Ù… A Ù‚Ø¨Ù„ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„ØªÙŠ ØªØ¨Ø¯Ø£ Ø¨Ø­Ø±Ù Ø³Ø§ÙƒÙ†',
          examples: ['A book (ÙƒØªØ§Ø¨)', 'A car (Ø³ÙŠØ§Ø±Ø©)', 'A house (Ø¨ÙŠØª)'],
          color: '#10b981'
        },
        {
          title: 'Ù…ØªÙ‰ Ù†Ø³ØªØ®Ø¯Ù… AnØŸ',
          rule: 'Ù†Ø³ØªØ®Ø¯Ù… An Ù‚Ø¨Ù„ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„ØªÙŠ ØªØ¨Ø¯Ø£ Ø¨Ø­Ø±Ù Ù…ØªØ­Ø±Ùƒ (a, e, i, o, u)',
          examples: ['An apple (ØªÙØ§Ø­Ø©)', 'An elephant (ÙÙŠÙ„)', 'An orange (Ø¨Ø±ØªÙ‚Ø§Ù„Ø©)'],
          color: '#f59e0b'
        },
        {
          title: 'Ù…ØªÙ‰ Ù†Ø³ØªØ®Ø¯Ù… TheØŸ',
          rule: 'Ù†Ø³ØªØ®Ø¯Ù… The Ø¹Ù†Ø¯Ù…Ø§ Ù†ØªØ­Ø¯Ø« Ø¹Ù† Ø´ÙŠØ¡ Ù…Ø­Ø¯Ø¯ Ø£Ùˆ Ù…Ø¹Ø±ÙˆÙ',
          examples: ['The book on the table (Ø§Ù„ÙƒØªØ§Ø¨ Ø§Ù„Ø°ÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø·Ø§ÙˆÙ„Ø©)', 'The sun (Ø§Ù„Ø´Ù…Ø³)', 'The teacher (Ø§Ù„Ù…Ø¹Ù„Ù…Ø©)'],
          color: '#8b5cf6'
        }
      ],
      exercises: [
        {
          question: 'Ø§Ø®ØªØ± Ø§Ù„Ø£Ø¯Ø§Ø© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©: ___ apple',
          options: ['a', 'an', 'the'],
          correct: 1,
          explanation: 'Ù†Ø³ØªØ®Ø¯Ù… "an" Ù„Ø£Ù† ÙƒÙ„Ù…Ø© apple ØªØ¨Ø¯Ø£ Ø¨Ø­Ø±Ù Ù…ØªØ­Ø±Ùƒ (a)'
        },
        {
          question: 'Ø§Ø®ØªØ± Ø§Ù„Ø£Ø¯Ø§Ø© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©: ___ car',
          options: ['a', 'an', 'the'],
          correct: 0,
          explanation: 'Ù†Ø³ØªØ®Ø¯Ù… "a" Ù„Ø£Ù† ÙƒÙ„Ù…Ø© car ØªØ¨Ø¯Ø£ Ø¨Ø­Ø±Ù Ø³Ø§ÙƒÙ† (c)'
        },
        {
          question: 'Ø§Ø®ØªØ± Ø§Ù„Ø£Ø¯Ø§Ø© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©: ___ sun',
          options: ['a', 'an', 'the'],
          correct: 2,
          explanation: 'Ù†Ø³ØªØ®Ø¯Ù… "the" Ù„Ø£Ù† Ø§Ù„Ø´Ù…Ø³ Ø´ÙŠØ¡ ÙˆØ§Ø­Ø¯ ÙˆÙ…Ø¹Ø±ÙˆÙ Ù„Ù„Ø¬Ù…ÙŠØ¹'
        }
      ]
    }
  },
  'present-simple': {
    title: 'Ø§Ù„Ù…Ø¶Ø§Ø±Ø¹ Ø§Ù„Ø¨Ø³ÙŠØ·',
    icon: 'â°',
    color: '#10b981',
    content: {
      explanation: `
        <h4 style="color:#065f46;margin-bottom:15px;">â° Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ù…Ø¶Ø§Ø±Ø¹ Ø§Ù„Ø¨Ø³ÙŠØ·ØŸ</h4>
        <p style="line-height:1.8;margin-bottom:20px;">Ø§Ù„Ù…Ø¶Ø§Ø±Ø¹ Ø§Ù„Ø¨Ø³ÙŠØ· ÙŠÙØ³ØªØ®Ø¯Ù… Ù„Ù„ØªØ¹Ø¨ÙŠØ± Ø¹Ù† Ø§Ù„Ø£ÙØ¹Ø§Ù„ Ø§Ù„ØªÙŠ ØªØ­Ø¯Ø« Ø¨Ø§Ù†ØªØ¸Ø§Ù… Ø£Ùˆ Ø§Ù„Ø­Ù‚Ø§Ø¦Ù‚ Ø§Ù„Ø¹Ø§Ù…Ø©.</p>
        
        <div style="background:#f0fdf4;padding:20px;border-radius:12px;margin:20px 0;border-right:4px solid #10b981;">
          <h5 style="color:#065f46;margin-bottom:15px;">ğŸ“‹ ØªÙƒÙˆÙŠÙ† Ø§Ù„Ù…Ø¶Ø§Ø±Ø¹ Ø§Ù„Ø¨Ø³ÙŠØ·:</h5>
          <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:10px;">
            <div style="background:white;padding:10px;border-radius:6px;">
              <strong>I/You/We/They:</strong> Ø§Ù„ÙØ¹Ù„ ÙƒÙ…Ø§ Ù‡Ùˆ
            </div>
            <div style="background:white;padding:10px;border-radius:6px;">
              <strong>He/She/It:</strong> Ø§Ù„ÙØ¹Ù„ + s Ø£Ùˆ es
            </div>
          </div>
        </div>
      `,
      rules: [
        {
          title: 'Ù…Ø¹ Ø§Ù„Ø¶Ù…Ø§Ø¦Ø± I, You, We, They',
          rule: 'Ù†Ø³ØªØ®Ø¯Ù… Ø§Ù„ÙØ¹Ù„ ÙƒÙ…Ø§ Ù‡Ùˆ Ø¨Ø¯ÙˆÙ† Ø¥Ø¶Ø§ÙØ§Øª',
          examples: ['I play football (Ø£Ù†Ø§ Ø£Ù„Ø¹Ø¨ ÙƒØ±Ø© Ø§Ù„Ù‚Ø¯Ù…)', 'You study English (Ø£Ù†Øª ØªØ¯Ø±Ø³ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©)', 'We go to school (Ù†Ø­Ù† Ù†Ø°Ù‡Ø¨ Ù„Ù„Ù…Ø¯Ø±Ø³Ø©)'],
          color: '#3b82f6'
        },
        {
          title: 'Ù…Ø¹ Ø§Ù„Ø¶Ù…Ø§Ø¦Ø± He, She, It',
          rule: 'Ù†Ø¶ÙŠÙ s Ø£Ùˆ es ÙÙŠ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„ÙØ¹Ù„',
          examples: ['He plays football (Ù‡Ùˆ ÙŠÙ„Ø¹Ø¨ ÙƒØ±Ø© Ø§Ù„Ù‚Ø¯Ù…)', 'She studies English (Ù‡ÙŠ ØªØ¯Ø±Ø³ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©)', 'It works well (Ø¥Ù†Ù‡ ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ Ø¬ÙŠØ¯)'],
          color: '#f59e0b'
        },
        {
          title: 'Ø§Ù„Ø£ÙØ¹Ø§Ù„ Ø§Ù„Ø´Ø§Ø°Ø©',
          rule: 'Ø¨Ø¹Ø¶ Ø§Ù„Ø£ÙØ¹Ø§Ù„ Ù„Ù‡Ø§ Ù‚ÙˆØ§Ø¹Ø¯ Ø®Ø§ØµØ©',
          examples: ['He goes to work (ÙŠØ°Ù‡Ø¨ Ù„Ù„Ø¹Ù…Ù„)', 'She does homework (ØªØ¤Ø¯ÙŠ Ø§Ù„ÙˆØ§Ø¬Ø¨)', 'It has a problem (Ù„Ø¯ÙŠÙ‡ Ù…Ø´ÙƒÙ„Ø©)'],
          color: '#8b5cf6'
        }
      ],
      exercises: [
        {
          question: 'Ø§Ø®ØªØ± Ø§Ù„Ø´ÙƒÙ„ Ø§Ù„ØµØ­ÙŠØ­: She ___ to school every day.',
          options: ['go', 'goes', 'going'],
          correct: 1,
          explanation: 'Ù†Ø³ØªØ®Ø¯Ù… "goes" Ù…Ø¹ She Ù„Ø£Ù†Ù†Ø§ Ù†Ø¶ÙŠÙ es Ù„Ù„ÙØ¹Ù„ go'
        },
        {
          question: 'Ø§Ø®ØªØ± Ø§Ù„Ø´ÙƒÙ„ Ø§Ù„ØµØ­ÙŠØ­: They ___ football.',
          options: ['play', 'plays', 'playing'],
          correct: 0,
          explanation: 'Ù†Ø³ØªØ®Ø¯Ù… "play" Ù…Ø¹ They Ø¨Ø¯ÙˆÙ† Ø¥Ø¶Ø§ÙØ§Øª'
        },
        {
          question: 'Ø§Ø®ØªØ± Ø§Ù„Ø´ÙƒÙ„ Ø§Ù„ØµØ­ÙŠØ­: He ___ his homework.',
          options: ['do', 'does', 'doing'],
          correct: 1,
          explanation: 'Ù†Ø³ØªØ®Ø¯Ù… "does" Ù…Ø¹ He Ù„Ø£Ù† do ÙØ¹Ù„ Ø´Ø§Ø° ÙŠØµØ¨Ø­ does'
        }
      ]
    }
  },
  'pronouns': {
    title: 'Ø§Ù„Ø¶Ù…Ø§Ø¦Ø±',
    icon: 'ğŸ‘¥',
    color: '#f59e0b',
    content: {
      explanation: `
        <h4 style="color:#92400e;margin-bottom:15px;">ğŸ‘¥ Ù…Ø§ Ù‡ÙŠ Ø§Ù„Ø¶Ù…Ø§Ø¦Ø±ØŸ</h4>
        <p style="line-height:1.8;margin-bottom:20px;">Ø§Ù„Ø¶Ù…Ø§Ø¦Ø± Ù‡ÙŠ ÙƒÙ„Ù…Ø§Øª Ù†Ø³ØªØ®Ø¯Ù…Ù‡Ø§ Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ù„ØªØ¬Ù†Ø¨ Ø§Ù„ØªÙƒØ±Ø§Ø± ÙˆØ¬Ø¹Ù„ Ø§Ù„ÙƒÙ„Ø§Ù… Ø£ÙƒØ«Ø± Ø³Ù„Ø§Ø³Ø©.</p>
        
        <div style="background:#fffbeb;padding:20px;border-radius:12px;margin:20px 0;border-right:4px solid #f59e0b;">
          <h5 style="color:#92400e;margin-bottom:15px;">ğŸ“‹ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø¶Ù…Ø§Ø¦Ø± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©:</h5>
          <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:10px;">
            <div style="background:white;padding:10px;border-radius:6px;text-align:center;">
              <strong>Ø¶Ù…Ø§Ø¦Ø± Ø§Ù„ÙØ§Ø¹Ù„</strong><br>
              <small>Subject Pronouns</small>
            </div>
            <div style="background:white;padding:10px;border-radius:6px;text-align:center;">
              <strong>Ø¶Ù…Ø§Ø¦Ø± Ø§Ù„Ù…Ù„ÙƒÙŠØ©</strong><br>
              <small>Possessive Pronouns</small>
            </div>
          </div>
        </div>
      `,
      rules: [
        {
          title: 'Ø¶Ù…Ø§Ø¦Ø± Ø§Ù„ÙØ§Ø¹Ù„',
          rule: 'ØªØ£ØªÙŠ ÙÙŠ Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø¬Ù…Ù„Ø© ÙƒÙØ§Ø¹Ù„',
          examples: ['I am a student (Ø£Ù†Ø§ Ø·Ø§Ù„Ø¨Ø©)', 'You are kind (Ø£Ù†Øª Ù„Ø·ÙŠÙ)', 'He is tall (Ù‡Ùˆ Ø·ÙˆÙŠÙ„)', 'She is smart (Ù‡ÙŠ Ø°ÙƒÙŠØ©)', 'We are friends (Ù†Ø­Ù† Ø£ØµØ¯Ù‚Ø§Ø¡)', 'They are happy (Ù‡Ù… Ø³Ø¹Ø¯Ø§Ø¡)'],
          color: '#3b82f6'
        },
        {
          title: 'Ø¶Ù…Ø§Ø¦Ø± Ø§Ù„Ù…Ù„ÙƒÙŠØ©',
          rule: 'ØªÙØ¸Ù‡Ø± Ù…Ù† ÙŠÙ…Ù„Ùƒ Ø§Ù„Ø´ÙŠØ¡',
          examples: ['My book (ÙƒØªØ§Ø¨ÙŠ)', 'Your pen (Ù‚Ù„Ù…Ùƒ)', 'His car (Ø³ÙŠØ§Ø±ØªÙ‡)', 'Her bag (Ø­Ù‚ÙŠØ¨ØªÙ‡Ø§)', 'Our house (Ø¨ÙŠØªÙ†Ø§)', 'Their school (Ù…Ø¯Ø±Ø³ØªÙ‡Ù…)'],
          color: '#10b981'
        },
        {
          title: 'Ø¶Ù…Ø§Ø¦Ø± Ø§Ù„Ù…ÙØ¹ÙˆÙ„',
          rule: 'ØªØ£ØªÙŠ Ø¨Ø¹Ø¯ Ø§Ù„ÙØ¹Ù„ Ø£Ùˆ Ø­Ø±Ù Ø§Ù„Ø¬Ø±',
          examples: ['Call me (Ø§ØªØµÙ„ Ø¨ÙŠ)', 'I see him (Ø£Ø±Ø§Ù‡)', 'Give her the book (Ø£Ø¹Ø·Ù‡Ø§ Ø§Ù„ÙƒØªØ§Ø¨)', 'Help us (Ø³Ø§Ø¹Ø¯Ù†Ø§)', 'I know them (Ø£Ø¹Ø±ÙÙ‡Ù…)'],
          color: '#8b5cf6'
        }
      ],
      exercises: [
        {
          question: 'Ø§Ø®ØªØ± Ø§Ù„Ø¶Ù…ÙŠØ± Ø§Ù„Ù…Ù†Ø§Ø³Ø¨: ___ am a teacher.',
          options: ['I', 'You', 'He', 'She'],
          correct: 0,
          explanation: 'Ù†Ø³ØªØ®Ø¯Ù… "I" Ù„Ù„Ù…ØªÙƒÙ„Ù… (Ø£Ù†Ø§)'
        },
        {
          question: 'Ø§Ø®ØªØ± Ø§Ù„Ø¶Ù…ÙŠØ± Ø§Ù„Ù…Ù†Ø§Ø³Ø¨: This is ___ book.',
          options: ['I', 'my', 'me', 'mine'],
          correct: 1,
          explanation: 'Ù†Ø³ØªØ®Ø¯Ù… "my" Ù„Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù…Ù„ÙƒÙŠØ© (ÙƒØªØ§Ø¨ÙŠ)'
        },
        {
          question: 'Ø§Ø®ØªØ± Ø§Ù„Ø¶Ù…ÙŠØ± Ø§Ù„Ù…Ù†Ø§Ø³Ø¨: ___ are students.',
          options: ['We', 'Us', 'Our', 'Ours'],
          correct: 0,
          explanation: 'Ù†Ø³ØªØ®Ø¯Ù… "We" ÙƒÙØ§Ø¹Ù„ Ù„Ù„Ø¬Ù…Ù„Ø© (Ù†Ø­Ù†)'
        }
      ]
    }
  }
};

// Grammar lesson functions
function showGrammarLesson(lessonType) {
  const lesson = grammarLessons[lessonType];
  if (!lesson) return;
  
  const content = document.getElementById('grammar-lesson-content');
  content.style.display = 'block';
  
  content.innerHTML = `
    <div style="text-align:center;margin-bottom:30px;">
      <div style="font-size:3rem;margin-bottom:15px;">${lesson.icon}</div>
      <h3 style="color:${lesson.color};margin-bottom:10px;">${lesson.title}</h3>
    </div>
    
    <!-- Explanation Section -->
    <div style="margin-bottom:30px;">
      ${lesson.content.explanation}
    </div>
    
    <!-- Rules Section -->
    <div style="margin-bottom:30px;">
      <h4 style="color:#374151;margin-bottom:20px;">ğŸ“– Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ ÙˆØ§Ù„Ø£Ù…Ø«Ù„Ø©:</h4>
      ${lesson.content.rules.map(rule => `
        <div style="background:#f8fafc;padding:20px;border-radius:12px;margin-bottom:15px;border-right:4px solid ${rule.color};">
          <h5 style="color:${rule.color};margin-bottom:10px;">${rule.title}</h5>
          <p style="margin-bottom:15px;font-weight:500;">${rule.rule}</p>
          <div style="background:white;padding:15px;border-radius:8px;">
            <strong style="color:#374151;">Ø£Ù…Ø«Ù„Ø©:</strong>
            <ul style="margin:10px 0 0 0;padding-right:20px;line-height:1.8;">
              ${rule.examples.map(example => `<li>${example}</li>`).join('')}
            </ul>
          </div>
        </div>
      `).join('')}
    </div>
    
    <!-- Interactive Exercises -->
    <div style="margin-bottom:30px;">
      <h4 style="color:#374151;margin-bottom:20px;">ğŸ¯ ØªÙ…Ø§Ø±ÙŠÙ† ØªÙØ§Ø¹Ù„ÙŠØ©:</h4>
      <div id="grammar-exercises">
        ${showGrammarExercise(lesson.content.exercises, 0)}
      </div>
    </div>
    
    <div style="text-align:center;margin-top:30px;">
      <button onclick="hideGrammarLesson()" class="btn btn-ghost">ğŸ”™ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯Ø±ÙˆØ³</button>
      <button onclick="speakLesson('${lessonType}')" class="btn btn-primary" style="background:linear-gradient(90deg,${lesson.color},${lesson.color}dd);">ğŸ”Š Ø§Ø³ØªÙ…Ø¹ Ù„Ù„Ø¯Ø±Ø³</button>
    </div>
  `;
  
  // Scroll to lesson content
  content.scrollIntoView({ behavior: 'smooth' });
}

function showGrammarExercise(exercises, currentIndex) {
  if (currentIndex >= exercises.length) {
    return `
      <div style="text-align:center;padding:40px;background:#f0fdf4;border-radius:12px;">
        <div style="font-size:3rem;margin-bottom:15px;">ğŸ†</div>
        <h4 style="color:#16a34a;margin-bottom:10px;">Ø£Ø­Ø³Ù†Øª! Ø£ÙƒÙ…Ù„Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ†</h4>
        <p style="color:#6b7280;">Ù„Ù‚Ø¯ Ø£ØªÙ‚Ù†Øª Ù‡Ø°Ø§ Ø§Ù„Ø¯Ø±Ø³ Ø¨Ù†Ø¬Ø§Ø­!</p>
        <button onclick="restartGrammarExercises()" class="btn btn-primary" style="background:linear-gradient(90deg,#10b981,#059669);margin-top:15px;">ğŸ”„ Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ† Ù…Ù† Ø¬Ø¯ÙŠØ¯</button>
      </div>
    `;
  }
  
  const exercise = exercises[currentIndex];
  return `
    <div style="background:#f8fafc;padding:25px;border-radius:12px;border:2px solid #e2e8f0;">
      <div style="text-align:center;margin-bottom:20px;">
        <span style="background:#3b82f6;color:white;padding:5px 15px;border-radius:20px;font-size:0.9rem;">
          ØªÙ…Ø±ÙŠÙ† ${currentIndex + 1} Ù…Ù† ${exercises.length}
        </span>
      </div>
      
      <h5 style="color:#374151;margin-bottom:20px;text-align:center;font-size:1.2rem;">${exercise.question}</h5>
      
      <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:10px;margin-bottom:20px;">
        ${exercise.options.map((option, index) => `
          <button onclick="selectGrammarAnswer(${currentIndex}, ${index})" class="grammar-option-btn" data-index="${index}"
                  style="padding:15px;font-size:1.1rem;font-weight:600;background:white;color:#374151;border:2px solid #e2e8f0;border-radius:8px;cursor:pointer;transition:all 0.3s;">
            ${option}
          </button>
        `).join('')}
      </div>
      
      <div id="grammar-exercise-result" style="display:none;"></div>
    </div>
  `;
}

let currentGrammarExercises = [];
let currentGrammarIndex = 0;

function selectGrammarAnswer(exerciseIndex, selectedIndex) {
  const exercises = currentGrammarExercises;
  const exercise = exercises[exerciseIndex];
  const buttons = document.querySelectorAll('.grammar-option-btn');
  const resultDiv = document.getElementById('grammar-exercise-result');
  const isCorrect = selectedIndex === exercise.correct;
  
  // Disable all buttons and show results
  buttons.forEach((btn, index) => {
    btn.disabled = true;
    btn.style.cursor = 'not-allowed';
    
    if (index === exercise.correct) {
      btn.style.background = 'linear-gradient(90deg, #10b981, #059669)';
      btn.style.color = 'white';
      btn.style.borderColor = '#10b981';
    } else if (index === selectedIndex && !isCorrect) {
      btn.style.background = 'linear-gradient(90deg, #ef4444, #dc2626)';
      btn.style.color = 'white';
      btn.style.borderColor = '#ef4444';
    } else {
      btn.style.opacity = '0.5';
    }
  });
  
  resultDiv.style.display = 'block';
  
  if (isCorrect) {
    resultDiv.innerHTML = `
      <div style="background:#f0fdf4;border:2px solid #22c55e;border-radius:8px;padding:15px;text-align:center;margin-top:15px;">
        <div style="font-size:1.5rem;margin-bottom:8px;">ğŸ‰</div>
        <h5 style="color:#16a34a;margin-bottom:8px;">Ù…Ù…ØªØ§Ø²! Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©</h5>
        <p style="margin:0;color:#374151;font-size:0.9rem;">${exercise.explanation}</p>
        <button onclick="nextGrammarExercise()" class="btn btn-primary" style="background:linear-gradient(90deg,#10b981,#059669);margin-top:10px;">
          ${exerciseIndex < exercises.length - 1 ? 'Ø§Ù„ØªÙ…Ø±ÙŠÙ† Ø§Ù„ØªØ§Ù„ÙŠ â¡ï¸' : 'Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ† ğŸ†'}
        </button>
      </div>
    `;
  } else {
    resultDiv.innerHTML = `
      <div style="background:#fef2f2;border:2px solid #ef4444;border-radius:8px;padding:15px;text-align:center;margin-top:15px;">
        <div style="font-size:1.5rem;margin-bottom:8px;">âŒ</div>
        <h5 style="color:#dc2626;margin-bottom:8px;">Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰</h5>
        <p style="margin:0;color:#374151;font-size:0.9rem;">${exercise.explanation}</p>
        <button onclick="nextGrammarExercise()" class="btn btn-primary" style="background:linear-gradient(90deg,#f59e0b,#d97706);margin-top:10px;">
          ${exerciseIndex < exercises.length - 1 ? 'Ø§Ù„ØªÙ…Ø±ÙŠÙ† Ø§Ù„ØªØ§Ù„ÙŠ â¡ï¸' : 'Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ† ğŸ“š'}
        </button>
      </div>
    `;
  }
}

function nextGrammarExercise() {
  currentGrammarIndex++;
  const exercisesDiv = document.getElementById('grammar-exercises');
  exercisesDiv.innerHTML = showGrammarExercise(currentGrammarExercises, currentGrammarIndex);
}

function restartGrammarExercises() {
  currentGrammarIndex = 0;
  const exercisesDiv = document.getElementById('grammar-exercises');
  exercisesDiv.innerHTML = showGrammarExercise(currentGrammarExercises, currentGrammarIndex);
}

function hideGrammarLesson() {
  document.getElementById('grammar-lesson-content').style.display = 'none';
}

function speakLesson(lessonType) {
  const lesson = grammarLessons[lessonType];
  if (lesson && 'speechSynthesis' in window) {
    const text = `${lesson.title}. ${lesson.content.explanation.replace(/<[^>]*>/g, '')}`;
    const utterance = new SpeechSynthesisUtterance(text);
    utterance.lang = 'ar-SA';
    utterance.rate = 0.8;
    speechSynthesis.speak(utterance);
  }
}

// Update showGrammarLesson to set current exercises
function showGrammarLesson(lessonType) {
  const lesson = grammarLessons[lessonType];
  if (!lesson) return;
  
  // Set current exercises for the lesson
  currentGrammarExercises = lesson.content.exercises;
  currentGrammarIndex = 0;
  
  const content = document.getElementById('grammar-lesson-content');
  content.style.display = 'block';
  
  content.innerHTML = `
    <div style="text-align:center;margin-bottom:30px;">
      <div style="font-size:3rem;margin-bottom:15px;">${lesson.icon}</div>
      <h3 style="color:${lesson.color};margin-bottom:10px;">${lesson.title}</h3>
    </div>
    
    <!-- Explanation Section -->
    <div style="margin-bottom:30px;">
      ${lesson.content.explanation}
    </div>
    
    <!-- Rules Section -->
    <div style="margin-bottom:30px;">
      <h4 style="color:#374151;margin-bottom:20px;">ğŸ“– Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ ÙˆØ§Ù„Ø£Ù…Ø«Ù„Ø©:</h4>
      ${lesson.content.rules.map(rule => `
        <div style="background:#f8fafc;padding:20px;border-radius:12px;margin-bottom:15px;border-right:4px solid ${rule.color};">
          <h5 style="color:${rule.color};margin-bottom:10px;">${rule.title}</h5>
          <p style="margin-bottom:15px;font-weight:500;">${rule.rule}</p>
          <div style="background:white;padding:15px;border-radius:8px;">
            <strong style="color:#374151;">Ø£Ù…Ø«Ù„Ø©:</strong>
            <ul style="margin:10px 0 0 0;padding-right:20px;line-height:1.8;">
              ${rule.examples.map(example => `<li>${example}</li>`).join('')}
            </ul>
          </div>
        </div>
      `).join('')}
    </div>
    
    <!-- Interactive Exercises -->
    <div style="margin-bottom:30px;">
      <h4 style="color:#374151;margin-bottom:20px;">ğŸ¯ ØªÙ…Ø§Ø±ÙŠÙ† ØªÙØ§Ø¹Ù„ÙŠØ©:</h4>
      <div id="grammar-exercises">
        ${showGrammarExercise(lesson.content.exercises, 0)}
      </div>
    </div>
    
    <div style="text-align:center;margin-top:30px;">
      <button onclick="hideGrammarLesson()" class="btn btn-ghost">ğŸ”™ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯Ø±ÙˆØ³</button>
      <button onclick="speakLesson('${lessonType}')" class="btn btn-primary" style="background:linear-gradient(90deg,${lesson.color},${lesson.color}dd);">ğŸ”Š Ø§Ø³ØªÙ…Ø¹ Ù„Ù„Ø¯Ø±Ø³</button>
    </div>
  `;
  
  // Scroll to lesson content
  content.scrollIntoView({ behavior: 'smooth' });
}

// Generate detailed feedback for writing assessment
function generateDetailedFeedback(text, analysis) {
  const wordCount = text.trim().split(/\s+/).filter(word => word.length > 0).length;
  const sentences = text.split(/[.!?]+/).filter(s => s.trim().length > 0);
  
  let feedback = {
    strengths: [],
    improvements: [],
    specificSuggestions: []
  };
  
  // Analyze each criterion and provide specific feedback
  
  // 1. Length Analysis
  if (analysis.length >= 12) {
    feedback.strengths.push('ğŸ“ Ø·ÙˆÙ„ Ø§Ù„ÙÙ‚Ø±Ø© Ù…Ù…ØªØ§Ø² - ÙƒØªØ¨Øª Ù…Ø­ØªÙˆÙ‰ ÙƒØ§ÙÙŠ ÙˆÙ…ÙØµÙ„');
  } else if (analysis.length >= 8) {
    feedback.strengths.push('ğŸ“ Ø·ÙˆÙ„ Ø§Ù„ÙÙ‚Ø±Ø© Ø¬ÙŠØ¯');
    feedback.improvements.push('ğŸ“ ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ù„Ø¥Ø«Ø±Ø§Ø¡ Ø§Ù„Ù…Ø­ØªÙˆÙ‰');
    feedback.specificSuggestions.push(`Ø£Ø¶ÙŠÙÙŠ ${Math.max(0, 80 - wordCount)} ÙƒÙ„Ù…Ø© Ø£Ø®Ø±Ù‰ Ù„ØªØ­Ø³ÙŠÙ† Ø·ÙˆÙ„ Ø§Ù„ÙÙ‚Ø±Ø©`);
  } else {
    feedback.improvements.push('ğŸ“ Ø§Ù„ÙÙ‚Ø±Ø© Ù‚ØµÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹ - ØªØ­ØªØ§Ø¬ Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ù…Ø­ØªÙˆÙ‰');
    feedback.specificSuggestions.push(`Ø£Ø¶ÙŠÙÙŠ ${Math.max(0, 80 - wordCount)} ÙƒÙ„Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ Ù„ØªØ­Ø³ÙŠÙ† Ø·ÙˆÙ„ Ø§Ù„ÙÙ‚Ø±Ø©`);
  }
  
  // 2. Sentence Count Analysis
  if (analysis.sentences >= 12) {
    feedback.strengths.push('ğŸ“ Ø¹Ø¯Ø¯ Ø§Ù„Ø¬Ù…Ù„ Ù…Ù…ØªØ§Ø² - ØªÙ†ÙˆØ¹ Ø¬ÙŠØ¯ ÙÙŠ Ø§Ù„ØªØ¹Ø¨ÙŠØ±');
  } else if (analysis.sentences >= 8) {
    feedback.strengths.push('ğŸ“ Ø¹Ø¯Ø¯ Ø§Ù„Ø¬Ù…Ù„ Ø¬ÙŠØ¯');
  } else {
    feedback.improvements.push('ğŸ“ Ø¹Ø¯Ø¯ Ø§Ù„Ø¬Ù…Ù„ Ù‚Ù„ÙŠÙ„ - Ø­Ø§ÙˆÙ„ÙŠ ØªÙ‚Ø³ÙŠÙ… Ø§Ù„Ø£ÙÙƒØ§Ø± Ù„Ø¬Ù…Ù„ Ø£ÙƒØ«Ø±');
    feedback.specificSuggestions.push(`Ø£Ø¶ÙŠÙÙŠ ${Math.max(0, 6 - sentences.length)} Ø¬Ù…Ù„Ø© Ø£Ø®Ø±Ù‰ Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„ØªÙ†ÙˆØ¹`);
  }
  
  // 3. Connectors Analysis
  const connectors = ['first', 'second', 'also', 'however', 'finally', 'moreover', 'furthermore', 'in addition', 'besides', 'therefore'];
  const foundConnectors = [];
  const lowerText = text.toLowerCase();
  
  connectors.forEach(connector => {
    if (lowerText.includes(connector)) {
      foundConnectors.push(connector);
    }
  });
  
  if (analysis.connectors >= 16) {
    feedback.strengths.push('ğŸ”— Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ù…ØªØ§Ø² Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø±Ø¨Ø· - Ø±Ø¨Ø· Ù…Ù†Ø·Ù‚ÙŠ Ø¨ÙŠÙ† Ø§Ù„Ø£ÙÙƒØ§Ø±');
  } else if (analysis.connectors >= 8) {
    feedback.strengths.push('ğŸ”— Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¬ÙŠØ¯ Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø±Ø¨Ø·');
    feedback.improvements.push('ğŸ”— ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø±Ø¨Ø· Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„ØªÙ…Ø§Ø³Ùƒ');
  } else {
    feedback.improvements.push('ğŸ”— ØªØ­ØªØ§Ø¬ÙŠÙ† Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø±Ø¨Ø·');
    const missingConnectors = connectors.filter(c => !foundConnectors.includes(c)).slice(0, 3);
    feedback.specificSuggestions.push(`Ø§Ø³ØªØ®Ø¯Ù…ÙŠ ÙƒÙ„Ù…Ø§Øª Ø±Ø¨Ø· Ù…Ø«Ù„: ${missingConnectors.join(', ')}`);
  }
  
  // 4. Punctuation and Grammar Analysis
  if (analysis.punctuation >= 20) {
    feedback.strengths.push('âœï¸ ØªØ±Ù‚ÙŠÙ… ÙˆÙ‚ÙˆØ§Ø¹Ø¯ Ù…Ù…ØªØ§Ø²Ø© - Ø§Ø³ØªØ®Ø¯Ø§Ù… ØµØ­ÙŠØ­ Ù„Ù„Ø£Ø­Ø±Ù Ø§Ù„ÙƒØ¨ÙŠØ±Ø© ÙˆØ§Ù„ØªØ±Ù‚ÙŠÙ…');
  } else if (analysis.punctuation >= 15) {
    feedback.strengths.push('âœï¸ ØªØ±Ù‚ÙŠÙ… ÙˆÙ‚ÙˆØ§Ø¹Ø¯ Ø¬ÙŠØ¯Ø©');
    feedback.improvements.push('âœï¸ Ø§Ù†ØªØ¨Ù‡ÙŠ Ø£ÙƒØ«Ø± Ù„Ù„ØªØ±Ù‚ÙŠÙ… ÙˆØ§Ù„Ø£Ø­Ø±Ù Ø§Ù„ÙƒØ¨ÙŠØ±Ø©');
  } else {
    feedback.improvements.push('âœï¸ ØªØ­ØªØ§Ø¬ÙŠÙ† Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„ØªØ±Ù‚ÙŠÙ… ÙˆØ§Ù„Ù‚ÙˆØ§Ø¹Ø¯');
    
    // Specific punctuation issues
    if (!/^[A-Z]/.test(text.trim())) {
      feedback.specificSuggestions.push('Ø§Ø¨Ø¯Ø¦ÙŠ Ø§Ù„ÙÙ‚Ø±Ø© Ø¨Ø­Ø±Ù ÙƒØ¨ÙŠØ±');
    }
    if (!/[.!?]$/.test(text.trim())) {
      feedback.specificSuggestions.push('Ø§Ø®ØªØªÙ…ÙŠ Ø§Ù„ÙÙ‚Ø±Ø© Ø¨Ø¹Ù„Ø§Ù…Ø© ØªØ±Ù‚ÙŠÙ… Ù…Ù†Ø§Ø³Ø¨Ø©');
    }
    
    const connectorsWithoutCommas = text.match(/\b(first|second|also|however|finally)\s+[^,]/gi);
    if (connectorsWithoutCommas) {
      feedback.specificSuggestions.push('Ø¶Ø¹ÙŠ ÙØ§ØµÙ„Ø© Ø¨Ø¹Ø¯ ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø±Ø¨Ø· (Ù…Ø«Ù„: First, Second,)');
    }
  }
  
  // 5. Structure Analysis
  if (analysis.structure >= 12) {
    feedback.strengths.push('ğŸ—ï¸ Ø¨Ù†ÙŠØ© Ù…Ù…ØªØ§Ø²Ø© Ù„Ù„ÙÙ‚Ø±Ø© - Ù…Ù‚Ø¯Ù…Ø© ÙˆØ®Ø§ØªÙ…Ø© ÙˆØ§Ø¶Ø­Ø©');
  } else if (analysis.structure >= 8) {
    feedback.strengths.push('ğŸ—ï¸ Ø¨Ù†ÙŠØ© Ø¬ÙŠØ¯Ø© Ù„Ù„ÙÙ‚Ø±Ø©');
    feedback.improvements.push('ğŸ—ï¸ Ø­Ø³Ù†ÙŠ Ø§Ù„Ø¬Ù…Ù„Ø© Ø§Ù„Ø®ØªØ§Ù…ÙŠØ© Ù„ØªÙƒÙˆÙ† Ø£Ù‚ÙˆÙ‰');
  } else {
    feedback.improvements.push('ğŸ—ï¸ ØªØ­ØªØ§Ø¬ÙŠÙ† Ù„ØªØ­Ø³ÙŠÙ† Ø¨Ù†ÙŠØ© Ø§Ù„ÙÙ‚Ø±Ø©');
    
    const firstSentence = sentences[0]?.trim().toLowerCase() || '';
    if (!firstSentence.includes('friend') && !firstSentence.includes('person') && !firstSentence.includes('best')) {
      feedback.specificSuggestions.push('Ø§Ø¨Ø¯Ø¦ÙŠ Ø¨Ø¬Ù…Ù„Ø© ØªØ¹Ø±ÙŠÙÙŠØ© ÙˆØ§Ø¶Ø­Ø© Ø¹Ù† ØµØ¯ÙŠÙ‚ØªÙƒ');
    }
    
    const lastSentence = sentences[sentences.length - 1]?.trim().toLowerCase() || '';
    if (!lastSentence.includes('conclusion') && !lastSentence.includes('finally') && !lastSentence.includes('lucky')) {
      feedback.specificSuggestions.push('Ø§Ø®ØªØªÙ…ÙŠ Ø¨Ø¬Ù…Ù„Ø© ØªÙ„Ø®Øµ Ø£Ù‡Ù…ÙŠØ© ØµØ¯ÙŠÙ‚ØªÙƒ ÙÙŠ Ø­ÙŠØ§ØªÙƒ');
    }
  }
  
  // 6. Examples and Details Analysis
  if (analysis.examples >= 8) {
    feedback.strengths.push('ğŸ’¡ Ø£Ù…Ø«Ù„Ø© ÙˆØªÙØ§ØµÙŠÙ„ Ø±Ø§Ø¦Ø¹Ø© - ÙˆØµÙ ØºÙ†ÙŠ ÙˆÙ…ÙØµÙ„');
  } else if (analysis.examples >= 5) {
    feedback.strengths.push('ğŸ’¡ Ø£Ù…Ø«Ù„Ø© ÙˆØªÙØ§ØµÙŠÙ„ Ø¬ÙŠØ¯Ø©');
    feedback.improvements.push('ğŸ’¡ Ø£Ø¶ÙŠÙÙŠ Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„ØµÙØ§Øª ÙˆØ§Ù„Ø£Ù…Ø«Ù„Ø© Ø§Ù„Ø´Ø®ØµÙŠØ©');
  } else {
    feedback.improvements.push('ğŸ’¡ ØªØ­ØªØ§Ø¬ÙŠÙ† Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø£Ù…Ø«Ù„Ø© ÙˆØ§Ù„ØªÙØ§ØµÙŠÙ„');
    feedback.specificSuggestions.push('Ø§Ø³ØªØ®Ø¯Ù…ÙŠ ØµÙØ§Øª ÙˆØµÙÙŠØ© Ù…Ø«Ù„: kind, helpful, funny, smart');
    feedback.specificSuggestions.push('Ø£Ø¶ÙŠÙÙŠ Ø£Ù…Ø«Ù„Ø© Ø´Ø®ØµÙŠØ© Ù…Ø«Ù„: "For example, she always helps me with..."');
  }
  
  // Generate HTML for detailed feedback
  return `
    <div style="background:#f8fafc;padding:25px;border-radius:12px;margin:25px 0;text-align:right;">
      <h4 style="color:#374151;margin-bottom:20px;text-align:center;">ğŸ“‹ ØªØ­Ù„ÙŠÙ„ Ù…ÙØµÙ„ Ù„Ø£Ø¯Ø§Ø¦Ùƒ</h4>
      
      <!-- Strengths Section -->
      ${feedback.strengths.length > 0 ? `
        <div style="background:#f0fdf4;padding:20px;border-radius:8px;margin-bottom:15px;border-right:4px solid #22c55e;">
          <h5 style="color:#16a34a;margin-bottom:15px;display:flex;align-items:center;gap:8px;">
            <span>ğŸŒŸ</span> Ù†Ù‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ© ÙÙŠ ÙƒØªØ§Ø¨ØªÙƒ:
          </h5>
          <ul style="margin:0;padding-right:20px;line-height:1.8;color:#374151;">
            ${feedback.strengths.map(strength => `<li>${strength}</li>`).join('')}
          </ul>
        </div>
      ` : ''}
      
      <!-- Improvements Section -->
      ${feedback.improvements.length > 0 ? `
        <div style="background:#fffbeb;padding:20px;border-radius:8px;margin-bottom:15px;border-right:4px solid #f59e0b;">
          <h5 style="color:#92400e;margin-bottom:15px;display:flex;align-items:center;gap:8px;">
            <span>ğŸ¯</span> Ù…Ø¬Ø§Ù„Ø§Øª Ø§Ù„ØªØ­Ø³ÙŠÙ†:
          </h5>
          <ul style="margin:0;padding-right:20px;line-height:1.8;color:#374151;">
            ${feedback.improvements.map(improvement => `<li>${improvement}</li>`).join('')}
          </ul>
        </div>
      ` : ''}
      
      <!-- Specific Suggestions Section -->
      ${feedback.specificSuggestions.length > 0 ? `
        <div style="background:#f0f9ff;padding:20px;border-radius:8px;border-right:4px solid #3b82f6;">
          <h5 style="color:#1e40af;margin-bottom:15px;display:flex;align-items:center;gap:8px;">
            <span>ğŸ’¡</span> Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ù…Ø­Ø¯Ø¯Ø© Ù„Ù„ØªØ­Ø³ÙŠÙ†:
          </h5>
          <ul style="margin:0;padding-right:20px;line-height:1.8;color:#374151;">
            ${feedback.specificSuggestions.map(suggestion => `<li>${suggestion}</li>`).join('')}
          </ul>
        </div>
      ` : ''}
      
      <!-- Score Breakdown -->
      <div style="background:white;padding:20px;border-radius:8px;border:2px solid #e2e8f0;">
        <h5 style="color:#374151;margin-bottom:15px;text-align:center;">ğŸ“Š ØªÙØµÙŠÙ„ Ø§Ù„Ù†Ù‚Ø§Ø·:</h5>
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:10px;text-align:center;">
          <div style="padding:10px;background:#f8fafc;border-radius:6px;">
            <div style="font-size:1.2rem;margin-bottom:5px;">ğŸ“</div>
            <p style="margin:0;font-size:0.8rem;color:#6b7280;">Ø·ÙˆÙ„ Ø§Ù„ÙÙ‚Ø±Ø©</p>
            <p style="margin:5px 0 0 0;font-weight:700;color:${analysis.length >= 12 ? '#16a34a' : analysis.length >= 8 ? '#f59e0b' : '#dc2626'};">
              ${analysis.length}/15
            </p>
          </div>
          <div style="padding:10px;background:#f8fafc;border-radius:6px;">
            <div style="font-size:1.2rem;margin-bottom:5px;">ğŸ“</div>
            <p style="margin:0;font-size:0.8rem;color:#6b7280;">Ø¹Ø¯Ø¯ Ø§Ù„Ø¬Ù…Ù„</p>
            <p style="margin:5px 0 0 0;font-weight:700;color:${analysis.sentences >= 12 ? '#16a34a' : analysis.sentences >= 8 ? '#f59e0b' : '#dc2626'};">
              ${analysis.sentences}/15
            </p>
          </div>
          <div style="padding:10px;background:#f8fafc;border-radius:6px;">
            <div style="font-size:1.2rem;margin-bottom:5px;">ğŸ”—</div>
            <p style="margin:0;font-size:0.8rem;color:#6b7280;">ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø±Ø¨Ø·</p>
            <p style="margin:5px 0 0 0;font-weight:700;color:${analysis.connectors >= 16 ? '#16a34a' : analysis.connectors >= 8 ? '#f59e0b' : '#dc2626'};">
              ${analysis.connectors}/20
            </p>
          </div>
          <div style="padding:10px;background:#f8fafc;border-radius:6px;">
            <div style="font-size:1.2rem;margin-bottom:5px;">âœï¸</div>
            <p style="margin:0;font-size:0.8rem;color:#6b7280;">Ø§Ù„ØªØ±Ù‚ÙŠÙ… ÙˆØ§Ù„Ù‚ÙˆØ§Ø¹Ø¯</p>
            <p style="margin:5px 0 0 0;font-weight:700;color:${analysis.punctuation >= 20 ? '#16a34a' : analysis.punctuation >= 15 ? '#f59e0b' : '#dc2626'};">
              ${analysis.punctuation}/25
            </p>
          </div>
          <div style="padding:10px;background:#f8fafc;border-radius:6px;">
            <div style="font-size:1.2rem;margin-bottom:5px;">ğŸ—ï¸</div>
            <p style="margin:0;font-size:0.8rem;color:#6b7280;">Ø¨Ù†ÙŠØ© Ø§Ù„ÙÙ‚Ø±Ø©</p>
            <p style="margin:5px 0 0 0;font-weight:700;color:${analysis.structure >= 12 ? '#16a34a' : analysis.structure >= 8 ? '#f59e0b' : '#dc2626'};">
              ${analysis.structure}/15
            </p>
          </div>
          <div style="padding:10px;background:#f8fafc;border-radius:6px;">
            <div style="font-size:1.2rem;margin-bottom:5px;">ğŸ’¡</div>
            <p style="margin:0;font-size:0.8rem;color:#6b7280;">Ø§Ù„Ø£Ù…Ø«Ù„Ø© ÙˆØ§Ù„ØªÙØ§ØµÙŠÙ„</p>
            <p style="margin:5px 0 0 0;font-weight:700;color:${analysis.examples >= 8 ? '#16a34a' : analysis.examples >= 5 ? '#f59e0b' : '#dc2626'};">
              ${analysis.examples}/10
            </p>
          </div>
        </div>
      </div>
    </div>
  `;
}



// Utility function for inline messages
function showInlineMessage(message, type) {
  const messageDiv = document.createElement('div');
  messageDiv.style.cssText = `
    position:fixed;top:20px;right:20px;z-index:1000;
    padding:15px 20px;border-radius:8px;color:white;font-weight:600;
    background:${type === 'success' ? 'linear-gradient(90deg,#10b981,#059669)' : 'linear-gradient(90deg,#ef4444,#dc2626)'};
    box-shadow:0 4px 12px rgba(0,0,0,0.15);
    transform:translateX(100%);transition:transform 0.3s ease;
  `;
  messageDiv.textContent = message;
  
  document.body.appendChild(messageDiv);
  
  setTimeout(() => {
    messageDiv.style.transform = 'translateX(0)';
  }, 100);
  
  setTimeout(() => {
    messageDiv.style.transform = 'translateX(100%)';
    setTimeout(() => {
      if (document.body.contains(messageDiv)) {
        document.body.removeChild(messageDiv);
      }
    }, 300);
  }, 3000);
}
</script>
  </div>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9af12d9843c2b538',t:'MTc2NTkxOTUzOC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>